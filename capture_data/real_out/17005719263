

<!doctype html>
<!--[if lt IE 7]><html class="no-js ie6 oldie" lang="en"><![endif]-->
<!--[if IE 7]><html class="no-js ie7 oldie" lang="en"><![endif]-->
<!--[if IE 8]><html class="no-js ie8 oldie" lang="en"><![endif]-->
<!--[if IE 9]><html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
    <meta charset="utf-8" content="" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, user-scalable=yes" />
    <!-- favicon -->
    <link rel="shortcut icon" href="/Assets/images/favicon.png" type="image/x-icon" />


    <title>AA SALE | 40% OFF Breakdown Cover | Insurance, Route Planner</title>
<meta name="description" content="Get 40% off breakdown cover packages online in the AA Black Friday SALE. Plus get Â£25 off Car Insurance. Routeplanner and more.">
<meta name="robots" content="INDEX, FOLLOW">
<link rel="canonical" href="https://www.theaa.com/"/>
<script type="text/javascript">

    var utag_data = {"event_name":null,"page_referrer":null,"site_display_format":null,"user_tealium_id":null,"user_id_responsetap":null,"site_type":"Sitecore","site_section":"home","page_type":"Home","page_url":"/","user_type":"guest","user_is_logged_in":"0","user_id":null,"user_party_id":null,"user_membership_id":null,"user_visits":"1"};
</script><meta name="facebook-domain-verification" content="tk8b3zq2l4w5wpfnau2ff51brp8lv3" />

    <script type="text/javascript" src="/ruxitagentjs_ICA27NVfgjoqrux_10277231024135831.js" data-dtconfig="rid=RID_2418|rpid=1052106316|domain=theaa.com|reportUrl=/rb_wid12831|app=254fbf4f7c669c98|cuc=k3ug2obn|mel=100000|featureHash=ICA27NVfgjoqrux|dpvc=1|ssv=4|lastModification=1700474705494|vcv=2|tp=500,50,0,1|rdnt=1|uxrgce=1|bp=3|agentUri=/ruxitagentjs_ICA27NVfgjoqrux_10277231024135831.js"></script><script type="application/ld+json">
        {
  "@context": "http://schema.org",
  "@type": "Organization",
  "description": "Lorem ipsum dolor sit amet",
  "foundingDate": "1905-06-19T00:00:00Z",
  "logo": "https://www.theaa.com/~/media/all-sites/logos/the-aa.jpg?rev=ed65120d9bdc4b8aa0497347f9d12a0e",
  "name": "The Automobile Association",
  "url": "https://www.theaa.com/",
  "contactPoint": [
    {
      "@type": "ContactPoint",
      "telephone": "+44 344 209 0754",
      "contactType": "Customer Support"
    },
    {
      "@type": "ContactPoint",
      "telephone": "+44 3330 046 046",
      "contactType": "Emergency"
    },
    {
      "@type": "ContactPoint",
      "telephone": "+44 3330 046 046",
      "contactType": "Roadside Assistance"
    },
    {
      "@type": "ContactPoint",
      "telephone": "+44 344 209 0754",
      "contactType": "Technical Support"
    }
  ],
  "sameAs": [
    "https://twitter.com/theaa_uk",
    "https://www.youtube.com/user/theAAPatrol"
  ]
}
    </script>
<style>
.campaign-hero {background-size:auto !important}

@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 812px) 
  and (orientation: landscape) { 
.campaign-hero {background-size:auto !important}
} /*CD-28615*/
</style>

<style>
.campaign-hero-content .left-image {
max-width: 221px !important;
}
</style>



<style>
/*centered countdown timer*/
@media screen and (max-width: 737px){
.flash-sale-timer {
margin: 8px auto 20px !important;
}
}
</style>



    <script>/* html-head jquery update script etc will go here */</script>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.6.0.min.js" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-migrate-1.4.1.min.js" integrity="sha384-uQPAXWjjvZGmVjKnobPRQOCEJ0rkCNRXW1GBUsJkjw1w0K7TxLH6Z3zMX7wtx+Lf" crossorigin="anonymous"></script>

<!--CDN Fallback Scripts for JQuery 3.6.0 and jQuery Migrate 1.4.1-->
<script>
   window.jQuery || document.write('<script src="/Assets/scripts/libs/cdn-jquery/jquery-3.6.0.js" type="text/javascript"> <\/script><script src="/Assets/scripts/libs/cdn-jquery/jquery-migrate-1.4.1.js" type="text/javascript"> <\/script> ');
</script>
<script>
var jQ=jQuery
</script>







        <!-- stylesheet refs -->
        <link href="/Assets/styles/keyframes.css" rel="stylesheet" />
<link href="/Assets/styles-bundle?v=Hy08bW2b98vwcFxbDwH0DCuA-S_pzHqXcrSc4cp-kuE1" rel="stylesheet"/>
<link href="/Assets/styles-roads-bundle-evo?v=OMSAexQJUt-tMd67U2K7hV8q-yOR3iOvcb-nddJ3Eqc1" rel="stylesheet"/>


    
</head>



<body vocab="https://schema.org" typeof="WebPage" class="transition">
    <div id="site-wrapper">
        

        <script type="text/javascript">

    (function (a, b, c, d) {
        a = '//tags.tiqcdn.com/utag/theaa/main/prod/utag.js';
        b = document; c = 'script'; d = b.createElement(c); d.src = a; d.type = 'text/java' + c; d.async = true;
        a = b.getElementsByTagName(c)[0]; a.parentNode.insertBefore(d, a);
    })();
</script>
        
        <div id="main" class="cf animated blur-in-half" role="main">
            





        <style>
            #main {
    position: relative;
}
header#site-header-yellow .main-nav ul li.mobile-display-view {
    display: none;
}
header#site-header-yellow .main-nav ul li.desktop-display-view {
    display: inline;
}
.svg-desktop {
    display: inline;
}
.svg-mobile {
    display: none;
}
.menu-base-transition {
    transition: 0.1s linear 0.5s;
}

#mainContent {
    opacity: 0.5;
    height: calc(100% - 225px);
    width: 100%;
    visibility: hidden;
    background-color: #000;
    position: absolute;
    /* top: 133px; */
    left: 0px;
    z-index: 5;
}
.padlock {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 5px 6px 6px;
    gap: 10px;
    width: 32px;
    height: 32px;
    background: #1d1d1d;
    border-radius: 109px;
    flex: none;
    order: 0;
    flex-grow: 0;
}

header#site-header-yellow .reltive {
    position: relative;
}
header#site-header-yellow {
    font-family: NewTransport-Regular, Arial, Helvetica, Verdana, sans-serif;
    background: rgb(255, 211, 0);
    padding-top: 16px;
    padding-bottom: 0px;
    height: 134px;
}
header#site-header-yellow .skip-to-content-link {
    background: #fff;
    left: -9999px;
    padding: 10px 8px;
    position: absolute;
}
header#site-header-yellow .skip-to-content-link:focus {
    top: -16px;
    left: 0;
    margin: 0 auto;
    text-align: center;
    width: auto;
    white-space: nowrap;
    border: 0px;
    text-decoration: none;
    border-radius: 0px;
    box-shadow: none;
    line-height: 20px !important;
    letter-spacing: 0.25px;
    font-size: 16px;
}
header#site-header-yellow a {
    font-weight: normal;

    border-radius: 4px;
    font-family: NewTransport-Regular, Arial, Helvetica, Verdana, sans-serif;
    display: inline-block;
    padding: 4px 6px;
    letter-spacing: 0;
    white-space: nowrap;
    box-shadow: inset 0px 0px 0px 2px transparent;
}
/*header#site-header-yellow .main-nav ul li .aa-mega-menu ul li a{padding-left:0; padding-right:0;}*/

header#site-header-yellow .main-nav ul.aa-main-nav li nav.my-account ul a.logout {
    font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
    letter-spacing: 0.25px;
    line-height: 20px;
}

header#site-header-yellow ul.aa-main-nav li.primary a:hover {
    text-decoration: none !important;
}
header#site-header-yellow a.underline {
    text-decoration: underline;
}
/*header#site-header-yellow a.underline:hover {
        text-decoration-thickness: 2px;
    }*/
header#site-header-yellow p.business-customer-desktop {
    border-radius: 4px;
    padding: 0 4px;
    margin: 0px !important;
    box-shadow: inset 0px 0px 0px 2px transparent;
}
header#site-header-yellow p.business-customer-desktop a {
    padding-right: 0px !important;
    padding-bottom: 0px !important;
    padding-top: 0px !important;
    border-radius: 4px;
}
header#site-header-yellow a:focus,
header#site-header-yellow p.business-customer-desktop:focus {
    text-decoration: none !important;
}
header#site-header-yellow a:focus-visible,
header#site-header-yellow p.business-customer-desktop:focus-visible {
    box-shadow: inset 0px 0px 0px 2px #58595b;
    border-radius: 4px;
    text-decoration: none !important;
}

.business-customer-desktop {
    cursor: default;
}
.business-customer-desktop:hover {
    text-decoration: none;
}
.business-customer-desktop span.underline {
    text-decoration: underline;
    cursor: pointer;
}
header#site-header-yellow .top-header-links {
    margin-bottom: 12px;
}
header#site-header-yellow .top-header-links a {
    font-size: 14px;
    line-height: 1.71;
    letter-spacing: normal;
    color: #1d1d1d;
}
header#site-header-yellow .main-nav button {
    background: transparent;
    font-weight: normal;
    border: 0;
    box-shadow: inset 0px 0px 0px 2px transparent;
    border-radius: 4px;
    font-family: NewTransport-Regular, Arial, Helvetica, Verdana, sans-serif;
    display: inline-block;
    padding: 4px 8px;
    letter-spacing: 0;
    white-space: nowrap;
}
header#site-header-yellow .main-nav button > hr {
    position: absolute;
    left: 10px;
    bottom: 0px;
    width: calc(100% - 20px);
    height: 4px;
    background: #2b2929;
    border-top-left-radius: 2px;
    border-top-right-radius: 2px;
    opacity: 0;
    visibility: hidden;
    transition: 0.1s linear 0.5s;
    margin: 0;
    border: 0;
    z-index: 999;
}
header#site-header-yellow .main-nav a,
header#site-header-yellow .main-nav button {
    font-size: 18px;
    line-height: 1.33;
    letter-spacing: 0.15px;
    color: #2b2d32;
}
header#site-header-yellow .main-nav button.anchor:focus-visible {
    box-shadow: inset 0px 0px 0px 2px #58595b;
    border-radius: 4px;
}
header#site-header-yellow .top-header-links ul,
header#site-header-yellow .main-nav ul {
    margin: 0;
    padding: 0;
}
header#site-header-yellow .main-nav ul {
    display: flex;
    flex-wrap: nowrap;
}
header#site-header-yellow .top-header-links ul.top-links a {
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    line-height: 24px;
}
header#site-header-yellow .top-header-links ul.top-links li:last-child a {
    margin-right: -6px;
}
header#site-header-yellow .top-header-links ul li,
header#site-header-yellow .main-nav ul li {
    display: inline;
    position: relative;
}
header#site-header-yellow .top-header-links ul li:before,
header#site-header-yellow .main-nav ul li:before {
    display: none;
}

header#site-header-yellow .top-header-links ul li {
    padding-right: 8px;
    padding-left: 8px;
    position: relative;
}
header#site-header-yellow .top-header-links ul li:after {
    content: "|";
    position: absolute;
    top: -3px;
    right: 0;
    color: #2b2929;
    font-family: ui-sans-serif;
    font-size: 19px;
}
header#site-header-yellow .top-header-links ul li:first-child {
    padding-left: 0;
}
header#site-header-yellow .top-header-links ul li:last-child {
    padding-right: 0;
}
header#site-header-yellow .top-header-links ul li:last-child:after {
    display: none;
}

header#site-header-yellow .main-nav ul.aa-main-nav {
    margin-top: 17px;
    height: 57px;
}
header#site-header-yellow .main-nav ul li {
    padding-left: 3px;
    padding-right: 3px;
    position: relative;
}
header#site-header-yellow .main-nav ul li .aa-mega-menu ul li {
    padding-left: 0;
    padding-right: 0;
}

header#site-header-yellow .main-nav ul > li.primary:last-child {
    padding-left: 36px;
    padding-right: 0;
}
header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > a,
header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > button {
    padding-left: 40px;
    font-size: 18px;
    margin-right: -8px;
}
header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > a.user-icon,
header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > button.user-icon {
    padding-left: 40px;
}

header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child span {
    position: absolute;
    top: 0px;
    /*
     top: 2px;
     left: 46px;
    */
    left: 36px;
}
header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child button span[data-icon-initial] {
    top: 0;
    left: 38px;
}

header#site-header-yellow .main-nav ul > li.primary:last-child:before {
    display: inline-block;
    background: transparent;
    content: "|";
    position: absolute;
    top: 3px;
    left: 18px;
    color: #58595b;
    font-size: 26px;
    font-family: UI-SANS-SERIF;
}

header#site-header-yellow .main-nav ul {
}
header#site-header-yellow .logo {
    position: absolute;
    top: 48px;
    left: 16px;
    max-width: 104px;
    padding-right: 36px;
    margin-top: -12px;
}
.mobile-tablet-menu {
    display: none;
}
.mobile-tablet-menu-open {
    display: none;
}
.nav-logo {
    padding-bottom: 16px;
    padding-left: 16px;
    display: none;
}
.business-customer-mobile {
    display: none;
}

.business-customer-desktop a,
.business-customer-mobile a {
    padding-left: 2px !important;
}

#mainContent {
    /*opacity: 0;*/
}

.menu-hover-overlay {
    background-color: #000;
    opacity: 0.5 !important;
    visibility: visible;
    position: fixed;
    top: 134px;
    left: 0px;
    width: 100%;
    height: 100%;
    z-index: 1;
    transition-delay: 0.5s !important;
    transition-duration: 0.1s !important;
}

header#site-header-yellow .main-nav ul.aa-main-nav li nav.aa-mega-menu {
    z-index: 9;
    position: absolute;
    top: 56px;
    left: 10px;
    visibility: hidden;
    opacity: 0;
    transition: 0.1s linear 0.5s;
}

header#site-header-yellow .main-nav ul.aa-main-nav li:nth-child(5) > nav.aa-mega-menu {
    left: auto;
    right: -307px;
}
header#site-header-yellow .main-nav ul.aa-main-nav li:nth-child(6) > nav.aa-mega-menu {
    left: auto;
    right: -222px;
}
header#site-header-yellow .main-nav ul.aa-main-nav li:nth-child(7) > nav.aa-mega-menu {
    left: auto;
    right: -153px;
}
header#site-header-yellow .main-nav ul.aa-main-nav li:nth-child(8) > nav.aa-mega-menu {
    left: auto;
    right: 0;
    border-top: medium none;
}
header#site-header-yellow #mainNavigation > ul > li.primary.childrens > nav > div > ul:nth-child(1) > li.backLink {
    display: none;
}
header#site-header-yellow .main-nav ul.aa-main-nav li nav.menu-active,
header#site-header-yellow .main-nav ul.aa-main-nav li:hover nav.aa-mega-menu {
    visibility: visible;
    opacity: 1;
    transition-delay: 0.5s;
    transition-property: opacity, visibility;
}

header#site-header-yellow .main-nav ul.aa-main-nav li nav.aa-mega-menu .column {
    display: flex;
}

/*header#site-header-yellow .main-nav ul.aa-main-nav li.primary:hover {
        border-bottom: 8px solid #2b2929
    }*/
header#site-header-yellow .main-nav ul.aa-main-nav li.primary > a > hr {
    position: absolute;
    left: 10px;
    bottom: -7px;
    width: calc(100% - 20px);
    height: 4px;
    background: #2b2929;
    border-top-left-radius: 2px;
    border-top-right-radius: 2px;
    opacity: 0;
    visibility: hidden;
    transition: 0.1s linear 0.5s;
    margin: 0;
    border: 0;
}

header#site-header-yellow .main-nav ul.aa-main-nav li.primary:hover > a > hr {
    margin: 0;
    border: 0;
    opacity: 1;
    visibility: visible;
    transition-delay: 0.5s;
    transition-duration: 0.1s;
}

header#site-header-yellow .main-nav ul.aa-main-nav li.primary nav ul li.secondary a:hover {
    text-decoration: underline !important;
}
header#site-header-yellow .main-nav ul.aa-main-nav li.primary:last-child > a > hr,
header#site-header-yellow .main-nav ul.aa-main-nav li.primary:last-child > button > hr {
    left: auto;
    right: 0;
    width: 70%;
    opacity: 0;
    visibility: hidden;
}
header#site-header-yellow .main-nav ul.aa-main-nav li.primary:last-child:hover > a > hr,
header#site-header-yellow .main-nav ul.aa-main-nav li.primary:last-child:hover > button > hr {
    left: auto;
    right: 0;
    width: 70%;
}

header#site-header-yellow .main-nav ul li > nav ul {
    flex-direction: column;
    /*min-width: 303px
		min-width: 302px*/
}
header#site-header-yellow .main-nav ul li:nth-child(2) > nav ul {
    flex-direction: column;

    /*min-width: 257.5px*/
}

/*header#site-header-yellow .main-nav ul li > nav ul li:last-child {
            padding-left: 3px !important
        }*/

header#site-header-yellow .main-nav ul li > nav ul li:last-child:before {
    display: none;
}

header#site-header-yellow .main-nav ul li > nav ul li:last-child a {
    padding-left: 6px !important;
}

header#site-header-yellow .main-nav ul li > nav ul {
    background-color: #fff;
    /*padding: 32px 36px 40px;*/
    padding: 40px 42px 40px 40px;
}

header#site-header-yellow .main-nav ul li:last-child > nav.aa-mega-menu.logged-in ul {
    padding-top: 24px;
}

header#site-header-yellow .main-nav ul li > nav ul:first-child {
    border-bottom-left-radius: 8px;
    box-shadow: 0px 1px 4px rgb(55 71 67 / 20%);
}
header#site-header-yellow .main-nav ul li > nav ul:nth-child(2) {
    box-shadow: 3px 1px 4px rgb(55 71 67 / 20%);
}
header#site-header-yellow .main-nav ul li > nav ul:last-child {
    border-bottom-right-radius: 8px;
    box-shadow: 3px 1px 4px rgb(55 71 67 / 20%);
    padding: 40px 88px 40px 40px;
}
header#site-header-yellow .main-nav ul li > nav {
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
    box-shadow: 1px 2px 4px rgb(55 71 67 / 20%);
    border-top: 1px solid #a7a9ac;
}

header#site-header-yellow .main-nav ul li.primary:last-child nav.aa-mega-menu ul {
    background-color: #2b2929 !important;
}

header#site-header-yellow .main-nav ul li > nav ul li.secondary {
    margin-bottom: 16px;
}
header#site-header-yellow .main-nav ul li > nav ul li.secondary:last-child {
    margin-bottom: 0;
}

header#site-header-yellow .main-nav ul li > nav ul li.secondary a {
    font-size: 16px;
    padding-bottom: 0 !important;
    padding-top: 0 !important;
    letter-spacing: 0.25px;
    line-height: 1.25;
    padding-left: 8px !important;
    padding-right: 8px !important;
}

header#site-header-yellow .main-nav ul li.primary:last-child nav.aa-mega-menu ul a {
    color: #fff !important;
}
header#site-header-yellow .main-nav ul li > nav ul li.primary-heading {
    display: none;
}
header#site-header-yellow .main-nav ul li nav.aa-mega-menu.my-account.active:after {
    display: none;
}

header#site-header-yellow .main-nav ul li nav.aa-mega-menu.logged-in .login-title {
    background-color: #2b2929;
    color: white;
    padding-left: 48px;
    padding-top: 40px;
    font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
    font-size: 16px;
    line-height: 20px;
    letter-spacing: 0.25px;
}

header#site-header-yellow .main-nav ul.aa-main-nav li.primary [data-icon-initial]:before {
    content: attr(data-icon-initial);
    display: inline-block;
    font-family: NewTransport-Regular, Arial, Helvetica, Verdana, sans-serif;
    font-size: 18px;
    width: 32px;
    height: 32px;
    line-height: 1.8;
    letter-spacing: 0.29px;
    text-align: center;
    border-radius: 50%;
    background-color: #1d1d1d;
    vertical-align: middle;
    margin-right: 8px;
    color: #fc0;
    transition: 0.1s linear 0.5s;
}

header#site-header-yellow.bg-white .main-nav ul.aa-main-nav li.primary [data-icon-initial]:before,
header#site-header-yellow.bg-change .main-nav ul.aa-main-nav li.primary [data-icon-initial]:before {
    content: attr(data-icon-initial);
    display: inline-block;
    font-family: NewTransport-Regular, Arial, Helvetica, Verdana, sans-serif;
    font-size: 18px;
    width: 32px;
    height: 32px;
    line-height: 1.8;
    letter-spacing: 0.29px;
    text-align: center;
    border-radius: 50%;
    background-color: #06757f;
    vertical-align: middle;
    margin-right: 8px;
    color: #fff;
    transition-delay: 0.5s;
    transition-duration: 0.1s;
}

header#site-header-yellow.bg-white .main-nav ul.aa-main-nav li.primary [data-icon-initial]:before {
    transition: none !important;
}
.notransition *:after,
.notransition * {
    -webkit-transition: none !important;
    -moz-transition: none !important;
    -o-transition: none !important;
    transition: none !important;
}
.mobile-tablet-menu{
    display: none;
}
/*media queries*/
@media screen and (width: 1024px) {
    header#site-header-yellow .main-nav a {
        font-size: 16px;
        line-height: 24px;
        letter-spacing: normal;
        color: #1d1d1d;
        border: 0px;
    }
}
@media screen and (min-width: 1024px) and (max-width: 1160px) {
    header#site-header-yellow .main-nav a,
    header#site-header-yellow .main-nav button {
        font-size: 16px;
        line-height: 1.33;
        letter-spacing: 0.15px;
        color: #2b2d32;
    }
    header#site-header-yellow .main-nav button {
        padding: 4px 4px;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > a,
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > button {
        font-size: 16px;
    }
}
@media screen and (max-width: 880px) {
    .cf .scroller .wrapper {
        padding: 0;
        max-width: 100%;
    }
}
@media screen and (max-width: 1024px) {
    #main {
        height: 100%;
    }
    .cf .scroller .wrapper {
        padding-right: 8px;
    }
    header#site-header-yellow a {
        padding-left: 8px;
    }
    header#site-header-yellow {
        overflow: hidden;
    }
    header#site-header-yellow a.underline {
        text-decoration: none;
    }
    header#site-header-yellow {
        height: 64px;
        padding: 0;
    }
    header#site-header-yellow.mobilemenu-active {
        /* height: 100vh; */
        /* background: transparent; */
    }
    header#site-header-yellow.mobilemenu-active .wrapper {
        max-width: 100%;
    }
    header#site-header-yellow .logo,
    .main-nav .menu-logo {
        top: 16px;
        max-width: 44px;
        padding-right: 0;
        margin-top: 0;
    }
    header#site-header-yellow .logo,
    .main-nav .menu-logo a {
        padding: 0 !important;
    }
    header#site-header-yellow .logo {
        left: 16px;
    }
    header#site-header-yellow .logo a {
        padding: 0;
    }
    .mobile-tablet-menu {
        font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
        display: block;
        font-size: 16px;
        line-height: 20px;
        letter-spacing: 0.25px;
        position: relative;
        padding-right: 24px;
        float: right;
        cursor: pointer;
        margin-right: 16px;
        margin-top: 16px;
    }
    .mobile-tablet-menu-open {
        font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
        display: block;
        font-size: 16px;
        line-height: 20px;
        letter-spacing: 0.25px;
        position: relative;
        padding-right: 32px;
        float: right;
        cursor: pointer;
        margin-right: 16px;
        margin-top: 0;
    }
    .mobile-tablet-menu-open span {
        margin-right: -8px;
        font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
        font-size: 16px;
    }
    .mobile-tablet-menu:after {
        content: "";
        position: absolute;
        right: 0;
        top: 0.25em;
        width: 1em;
        height: 0.15em;
        background: black;
        box-shadow: 0 6px 0 0 black, 0 12px 0 0 black;
    }
    .mobile-tablet-menu-open:after {
        content: "";
        position: absolute;
        right: 0;
        top: 8px;
        width: 24px;
        height: 24px;
        box-shadow: none;
        background: url("/Assets/images/icons/close-icon-dark-x2.png") no-repeat right 0;
        background-size: 16px;
    }
    header#site-header-yellow .main-nav ul li.mobile-display-view {
        display: block;
    }
    header#site-header-yellow .main-nav ul li.desktop-display-view {
        display: none;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav {
        margin: 0 16px;
        flex-direction: column;
    }

    header#site-header-yellow .main-nav ul.top-links {
        margin: 0;
        flex-direction: column;
    }
    .svg-desktop {
        display: none;
    }
    .svg-mobile {
        display: inline;
    }

    .mobile-tablet-menu {
        display: block;
    }
    .mobile-tablet-menu-open {
        display: block;
    }
    .mobile-no-display {
        display: none;
    }
    header#site-header-yellow .main-nav {
        padding-top: 16px;
        background: #fff;
        position: absolute;
        top: 0;
        right: -100vw;
        z-index: 2;
    }
    header#site-header-yellow .main-nav.open {
        left: 0;
    }
    header#site-header-yellow .main-nav {
        width: 100%;
    }
    header#site-header-yellow .main-nav .right {
        float: none;
    }
    header#site-header-yellow .main-nav ul li {
        display: block;
        width: 100%;
        border-top: 1px solid #dcddde;
        border-radius: 0px;
    }
    header#site-header-yellow .main-nav ul.top-links li:first-child {
        border-top: 0;
    }
    header#site-header-yellow .main-nav ul li a {
        display: block;
        padding: 16px 40px 16px 16px;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav li a,
    header#site-header-yellow .main-nav ul.aa-main-nav li button {
        padding: 16px 40px 16px 0;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav li.childrens > a,
    header#site-header-yellow .main-nav ul.aa-main-nav li.childrens > button {
        background: url("/Assets/images/icons/arrow-right-dark.png") no-repeat right center;
        background-size: 10px;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav li.childrens > button {
        width: 100%;
        text-align: left;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav li nav.my-account ul a.logout {
        color: #06757f;
    }

    header#site-header-yellow .mobile-grey {
        background: #f5f5f5;
    }
    header#site-header-yellow .main-nav ul li {
        padding-left: 0;
        padding-right: 0;
    }
    /*header#site-header-yellow .main-nav ul li:last-child{padding-left:3px}*/
    header#site-header-yellow .main-nav ul li:last-child:before {
        display: none !important;
    }

    header#site-header-yellow .top-header-links {
        display: none;
    }

    header#site-header-yellow div#mainNavigation .mobile-grey a:focus,
    header#site-header-yellow div#mainNavigation .mobile-grey a:hover {
        text-decoration: none !important;
    }

    header#site-header-yellow > .wrapper {
        max-width: 100%;
        padding: 0;
    }
    .nav-logo {
        display: block;
    }
    /* CD-49411 and CD-51270 changes Start */

    .business-customer-mobile {
        display: block;
        background: #fff;
        text-align: center;
        font-size: 14px;
        line-height: 24px;
        padding: 24px 0;
        /* margin-bottom: 100px; */
    }
    header#site-header-yellow .business-customer-mobile a {
        font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
        color: #06757f;
        font-size: 14px;
        line-height: 24px;
    }
    header#site-header-yellow .business-customer-mobile span.underline {
        color: #06757f;
        font-weight: bold;
    }
    /* CD-49411 and CD-51270 changes End */

    header#site-header-yellow ul.aa-main-nav li a,
    header#site-header-yellow ul.aa-main-nav li button,
    header#site-header-yellow .mobile-grey ul li a {
        font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
        display: block;
        font-size: 16px;
        line-height: 20px;
        letter-spacing: 0.25px;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav li:last-child span {
        left: 0 !important;
        top: 12px !important;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > a,
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > button {
        padding-left: 8px;
        margin-right: 0;
    }
    header#site-header-yellow .main-nav ul > li.primary:last-child {
        padding-right: 0;
        padding-left: 32px;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > a.user-icon,
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > button.user-icon {
        padding-left: 0;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > a.user-icon span,
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > button.user-icon span {
        top: 14px !important;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav > li:last-child {
        order: -1;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav li nav.aa-mega-menu {
        right: -100vw;
        top: -2px;
        display: none;
        width: 100vw;
        left: auto;
        margin: 0 -16px;
        visibility: hidden;
        opacity: 0;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav li.primary.activated > nav.aa-mega-menu {
        display: block;
        visibility: visible;
        opacity: 1;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav li nav.aa-mega-menu.mobile-menu {
        top: 0;
    }
    header#site-header-yellow #mainNavigation > ul > li.primary.childrens > nav > div > ul:nth-child(1) > li.backLink {
        display: inline;
        border-top: 0;
        padding-left: 0px;
        padding-right: 0px;
    }
    header#site-header-yellow
        #mainNavigation
        > ul
        > li.primary.childrens
        > nav
        > div
        > ul:nth-child(1)
        > li.backLink
        a
        span,
    header#site-header-yellow
        #mainNavigation
        > ul
        > li.primary.childrens
        > nav
        > div
        > ul:nth-child(1)
        > li.backLink
        button
        span {
        top: 6px !important;
        left: -6px !important;
        position: relative;
    }
    header#site-header-yellow
        #mainNavigation
        > ul
        > li.primary.childrens
        > nav.aa-mega-menu.my-account
        li.primary-heading {
        padding-left: 40px /* padding-left:31px*/ !important;
    }
    header#site-header-yellow
        #mainNavigation
        > ul
        > li.primary.childrens
        > nav.aa-mega-menu.my-account
        li.primary-heading
        span {
        top: 20px !important;
    }

    header#site-header-yellow
        #mainNavigation
        > ul
        > li.primary.childrens
        > nav.aa-mega-menu.my-account
        li.primary-heading
        span[data-icon-initial] {
        top: 16px !important;
    }

    /*header#site-header-yellow #mainNavigation > ul > li.primary.childrens > nav.aa-mega-menu ul:not(:first-of-type) > li:first-child{border-top:0 !important}*/
    header#site-header-yellow .main-nav .right {
        display: flex;
        flex-direction: column;
        /* background-color: #fff; */
    }

    header#site-header-yellow .main-nav ul.aa-main-nav {
        flex-direction: column;
        flex: 1;
    }

    header#site-header-yellow .mobile-grey {
        display: flex;
        flex: 1;
        flex-direction: column;
        flex-basis: auto;
    }

    header#site-header-yellow .main-nav ul.top-links {
        flex-direction: column;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav li nav.aa-mega-menu .column {
        display: block;
        flex-direction: column;
        width: 100%;
        flex-wrap: wrap;
        height: 100%;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav li nav.aa-mega-menu .column .col {
        width: 100%;
        padding-left: 16px;
    }

    body.mmenu-opened {
        height: 100%;
        overflow: hidden;
    }

    /* .mmenu-opened #nav-overlay {
            height: 100%;
            top: 0;
            z-index: 1;
            visibility: visible;
            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
            filter: alpha(opacity=100);
            -moz-opacity: 1;
            -ms-opacity: 1;
            filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
            filter: alpha(opacity=100);
            opacity: 1;
            background:#fff;
        }*/

    header#site-header-yellow.mobilemenu-active .scroller {
        overflow: auto;
        background-color: #fff;
        position: absolute;
        /* top: 0; */
        height: 100vh;
        width: 100%;
        right: 0;
        z-index: 999;
    }

    header#site-header-yellow .main-nav ul li > nav ul li.backLink {
        display: inline-block;
    }

    header#site-header-yellow a:focus,
    header#site-header-yellow p.business-customer-desktop:focus {
        border-color: transparent;
    }

    header#site-header-yellow .main-nav ul li > nav ul {
        background-color: #fff;
        padding: 0;
    }

    header#site-header-yellow .main-nav ul li > nav ul:first-child {
        border-bottom-left-radius: 0;
        box-shadow: none;
    }

    header#site-header-yellow .main-nav ul li > nav ul:last-child {
        border-bottom-right-radius: 0;
        background-color: #fff;
        box-shadow: none;
    }
    header#site-header-yellow .main-nav ul li > nav,
    header#site-header-yellow .main-nav ul li > nav ul:nth-child(2) {
        box-shadow: none;
    }

    header#site-header-yellow .main-nav ul li > nav ul:last-child a,
    header#site-header-yellow .main-nav ul li > nav ul li a {
        color: #000 !important;
    }
    nav.aa-mega-menu.mobile-nav {
        right: -100vw;
    }
    .hide-menu {
        display: none !important;
        transition: opacity 1s ease-out;
        opacity: 0;
    }
    .secondlevelOpen {
        background-color: #fff;
        /* border: 2px solid #f00; */
        transition: 0.5s ease;

        transition-delay: 0;
        transition-duration: 1s;
    }
    header#site-header-yellow .main-nav ul li > nav ul li:last-child a {
        padding-left: 0 !important;
    }
    header#site-header-yellow .main-nav ul li > nav ul.sub-menu {
        padding: 0 16px;
        width: 100%;
    }
    header#site-header-yellow .main-nav ul li > nav ul li.secondary {
        margin-bottom: 0;
    }
    header#site-header-yellow .main-nav ul li > nav ul li.primary-heading {
        display: block;
        border-top: 0;
    }
    header#site-header-yellow .main-nav ul li > nav ul li.primary-heading h4 {
        margin: 0;
        padding-top: 20px;
        padding-bottom: 20px;
        font-size: 24px;
        font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
    }
    header#site-header-yellow .main-nav ul li > nav.my-account ul li.primary-heading h4 {
        padding-left: 28px;
    }
    header#site-header-yellow .main-nav ul li > nav.my-account ul li.primary-heading h4 > span {
        display: inline-block;
        height: 20px;
        position: relative;
        top: 18px !important;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav li nav.aa-mega-menu {
        transition: 0.5s ease;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav li:hover nav.aa-mega-menu {
        opacity: 0;
        display: none;
        transition-delay: 0;
        transition-duration: 1s;
    }
    header#site-header-yellow .main-nav ul li.primary:last-child nav.aa-mega-menu ul {
        background-color: #fff !important;
    }
    header#site-header-yellow .main-nav ul li.primary:last-child nav.aa-mega-menu ul a {
        color: inherit !important;
    }
    header#site-header-yellow .main-nav ul li.primary:last-child nav.aa-mega-menu ul a.logout {
        color: #06757f !important;
    }
    .hero-image {
        margin: 0 auto 0;
    }

    header#site-header-yellow
        #mainNavigation
        > ul
        > li.primary.childrens
        > nav
        > div
        > ul:nth-child(1)
        > li.primary-heading {
        font-family: NewTransport-Bold, Arial, Helvetica, Verdana, sans-serif;
        line-height: 28px;
        font-size: 24px;
        letter-spacing: -0.5px;
        border-top: 0px;
        padding: 18px 0px;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav {
        height: auto !important;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav li:nth-child(8) > nav.aa-mega-menu {
        /* left: auto; */
        right: -100vw;
        /* border-top: medium none; */
    }
    header#site-header-yellow .main-nav ul li > nav ul li.backLink a,
    header#site-header-yellow .main-nav ul li > nav ul li.backLink button,
    header#site-header-yellow .main-nav ul li > nav ul li.backLink button:hover,
    header#site-header-yellow .main-nav ul li > nav ul li.backLink a:hover {
        color: #07818c !important;
        text-decoration: none;
        padding-top: 0px;
    }
    header#site-header-yellow .main-nav ul li > nav ul li.backLink button {
        display: block;
        width: 100%;
        text-align: left;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav li.primary:hover > button > hr,
    header#site-header-yellow .main-nav ul li.primary nav.aa-mega-menu ul li.primary-heading hr,
    header#site-header-yellow .main-nav ul.aa-main-nav li.primary:last-child:hover > button > hr {
        display: none;
    }
    header#site-header-yellow .main-nav ul li.primary:last-child nav.aa-mega-menu ul li.backLink button,
    header#site-header-yellow .main-nav ul li.primary:last-child nav.aa-mega-menu ul li.backLink button:hover {
        color: #07818c !important;
        text-decoration: none;
    }

    header#site-header-yellow .main-nav ul.aa-main-nav li.primary [data-icon-initial]:before {
        content: attr(data-icon-initial);
        display: inline-block;
        font-family: NewTransport-Regular, Arial, Helvetica, Verdana, sans-serif;
        font-size: 18px;
        width: 32px;
        height: 32px;
        line-height: 1.8;
        letter-spacing: 0.29px;
        text-align: center;
        border-radius: 50%;
        background-color: #06757f;
        vertical-align: middle;
        margin-right: 8px;
        color: #fff;
    }

    header#site-header-yellow .main-nav ul li nav.aa-mega-menu.logged-in .login-title {
        display: none;
    }
    header#site-header-yellow .main-nav ul li > nav.aa-mega-menu.logged-in ul {
        padding-top: 0px;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav li.primary nav ul li.secondary a:hover {
        text-decoration: none;
    }
    header#site-header-yellow .main-nav ul li > nav ul li.secondary a {
        padding-top: 16px !important;
        padding-bottom: 16px !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
    }
    header#site-header-yellow .main-nav ul li:last-child > nav.aa-mega-menu.logged-in ul {
        padding-top: 0;
    }
    header#site-header-yellow a:focus-visible,
    header#site-header-yellow p.business-customer-desktop:focus-visible,
    .mobile-tablet-menu:focus-visible,
    .mobile-tablet-menu-open:focus-visible,
    .backLink button:focus-visible {
        box-shadow: inset 0px 0px 0px 2px #58595b !important;
        border-radius: 4px;
        text-decoration: none !important;
    }
    header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > a, header#site-header-yellow .main-nav ul.aa-main-nav > li.primary:last-child > button {
        font-size: 16px;
    }
    .aa-main-nav button hr{
        display: none;
    }
    .fixed-position {
        position: fixed;
        width: 100%;
     }
}
@media screen and (max-width:737px) {
header#site-header-yellow{height:64px}

}

        </style>
        <script>
            console.log('window.aa.MenuSetupCompleted=');
if (typeof window.aa === 'undefined' || typeof window.aa.MenuSetupCompleted === 'undefined'){
	console.log('not set');
	setTimeout(function(){
		window_resize_menu_setup();
	},500)
}else{
	console.log(window.aa.MenuSetupCompleted);
}

$(document).ready(document_ready_menu_setup);

function document_ready_menu_setup() {
    $(window).resize(window_resize_menu_setup);
}

function window_resize_menu_setup() {
	console.log("in resize");

	var mainHeight = $('.aa-main-nav').outerHeight();
	var greyBoxHeight = $('.mobile-grey').outerHeight();
	var scrollHeightmenu = mainHeight + greyBoxHeight;
	var $currentActiveMenuItem = null;
	var $currentHoverMenuItem = null;
	var removeAnimation = false;
	const mobileBreakpoint = 1024;

	$('#mainContent').css({
		"transition": "0.1s linear 0.5s",
		"transition-duration": "0.5s"
	});

	var defaultBgColor = $('header#site-header-yellow').css("background-color");
	if (defaultBgColor == null || defaultBgColor == '') {
		defaultBgColor = '#fff';
	}

	if (defaultBgColor == 'rgb(255, 255, 255)') {
		$('header#site-header-yellow').addClass('bg-white');
	}

	var $areYouBusinessCustomer = $(' div.top-header-links > div.left.reltive > .business-customer-desktop');
	var $mobileBusinessCustomerLink = $('<div class="business-customer-mobile"></div>');
	$businessLinkMobileCount = $('.business-customer-mobile').length;
	
	if ($areYouBusinessCustomer.length && $businessLinkMobileCount == 0) {
		$mobileBusinessCustomerLink.html($areYouBusinessCustomer.html());
		$('.mobile-grey').append($mobileBusinessCustomerLink);
	}
	
	if (window.aa.helpers.cache.cachedElements.$window.width() <= mobileBreakpoint) {
		// console.log("smaller than breakpoint");
		$(".mobile-grey a, .nav-logo a ").attr("tabindex", "-1");
		$("#mainNavigation button, .mobile-tablet-menu-open ").attr("disabled", "disabled");
		$('#mainNavigation').addClass('mobile-main-nav').removeClass('desktop-main-nav');

		$('.mobile-grey').appendTo('.desktop-white');
		$('nav.aa-mega-menu').addClass('mobile-nav');
		if (!$('.scroller').length) {
			$('#site-header-yellow >.wrapper').wrap("<div class='scroller'></div>");
		}
		$('.mobile-tablet-menu').animate({ width: 'show' }, 30);

		$primaryHeadingCount = 0;

		$("#mainNavigation > ul > li.primary").each(function () {
			$primaryHeadingForMobile = $('<li class="primary-heading"></li>');
			$firstColumnOfMegaMenu = $(this).find("nav > div > ul:nth-child(1)");
			$anchor = $($(this).children()[0]);
			anchorHtmlText = $anchor.html();

			$primaryHeadingForMobile.html(anchorHtmlText);

			var primaryNavCount = $(".primary.childrens").length;

			$primaryHeadingCount = $('.primary-heading').length;
			if ($primaryHeadingCount < primaryNavCount) {
				$firstColumnOfMegaMenu.prepend($primaryHeadingForMobile);
			}
			$backLinkMobileCount = $('.backLink').length;
			if ($backLinkMobileCount < primaryNavCount) {
				$firstColumnOfMegaMenu.prepend('<li class="backLink"><button href="###""><span><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path d="m7.79 11.29 7-7a1.004 1.004 0 0 1 1.42 1.42L9.91 12l6.3 6.29a1 1 0 0 1 0 1.42 1 1 0 0 1-1.42 0l-7-7a1 1 0 0 1 0-1.42z" fill="#06757F"/></g></svg></span>Back</button></li>');
			}
		});

		$('.main-nav').keydown(function (e) {
			if (e.which === 27 || e.keyCode === 27) {
				mobileCloseClick(e);
				$(".left.logo").focus();
			}
		});

	}
	else if (window.aa.helpers.cache.cachedElements.$window.width() > mobileBreakpoint) {
		$('.left.logo').animate({ width: 'show' }, 30);

		$('.mobile-grey').appendTo('.top-header-links');
		$('nav.aa-mega-menu').removeClass('mobile-nav');
		$("#mainNavigation button, .mobile-tablet-menu-open ").removeAttr("disabled");
		$('#mainNavigation').addClass('desktop-main-nav').removeClass('mobile-main-nav');
		$(".campaign-hero ").parents(':eq(2)').css('padding', '0')

		if ($('.scroller').length) {
			$('#site-header-yellow >.wrapper').unwrap("<div class='scroller'></div>");
		}
		$('.mobile-tablet-menu').animate({ width: 'hide' }, 0);

		$('button > hr').css({
			"opacity": "0",
			"visibility": "hidden"
		});

		$('.aa-mega-menu').css({
			"opacity": "0",
			"visibility": "hidden"
		});
		$('.right.mobile-grey').show();


		$('#mainNavigation > ul.aa-main-nav > li.primary > button').keydown(function (e) {
			if (e.which === 13 || e.keyCode === 13) {   /// for ENTER press
				const boxes = document.querySelectorAll('.anchor');
				boxes.forEach((box, index) => {
					box.setAttribute('aria-expanded', 'true');
				});

				//remove active mega menu from HOVER if open 
				if ($currentHoverMenuItem) {
					var $primaryNavigationListItem = $currentHoverMenuItem.parent();
					$currentHoverMenuItem
						.removeClass('menu-active')
						.css({
							"opacity": "0",
							"visibility": "hidden"
						});

					var $menuUnderLine = $primaryNavigationListItem.find('button > hr');
					$menuUnderLine.css({
						"opacity": "0",
						"visibility": "hidden"
					});
					$currentHoverMenuItem = null;
				}
				applyMenuHoverInEffects($(this).parent());
				$('#mainContent').removeAttr("style");
				$('#mainContent').css({
					"opacity": "0.5",
					"height": "calc(100% - 225px)",
					"width": "100%",
					"visibility": "visible",
					"background-color": "#000",
					"position": "absolute",
					// "top": "134px",
					"left": "0px",
					"z-index": "1"
				});
				$('#mainContent').addClass('menu-base-transition');
				$currentActiveMenuItem = $(this).parent().find('.aa-mega-menu');
				$currentActiveMenuItem.toggleClass("menu-active");
				// $('.column .sub-menu.col').animate({ width: 'show' }, 300);

			}
			else if (e.which === 9 || e.keyCode === 9) { // for TAB press
				if ($currentActiveMenuItem) {
					e.preventDefault();
					var $firstAnchorOfMegaMenu = $($currentActiveMenuItem.find('div > ul:first-child > li:first-child > a')[0]);
					$firstAnchorOfMegaMenu.focus();
				}
			}
		});
		//get all last anchor items from all mega menus and attach key down event for Tab transer
		$("#mainNavigation > ul > li > nav > div > ul:last-child li:last-child a").keydown(function (e) {
			if (e.which === 9 || e.keyCode === 9) {
				console.log("tabbed...");
				$currentActiveMenuItem.removeClass('menu-active');
				var $nextPrimayNavItem = $currentActiveMenuItem.parent();
				if ($nextPrimayNavItem) {
					applyMenuHoverOutEffects($nextPrimayNavItem);
					$('header#site-header-yellow').css('background', defaultBgColor)
						.removeClass('bg-change');

					$nextPrimayNavItem.find('button')[0].focus();
					$currentActiveMenuItem = null;
				}
				else {
					//this will happen for very last anchor of last mega menu. there is no next menu item to focus to
					//so focus should be move to mainContent
					$('#mainContent').focus();
				}
			}
		});
		//for escape key- close the drop down menu if its open
		$('#mainNavigation > ul.aa-main-nav').keydown(function (e) {
			if (e.which === 27 || e.keyCode === 27) {
				if ($currentActiveMenuItem) {
					var $primaryNavListItem = $currentActiveMenuItem.parent()
					applyMenuHoverOutEffects($primaryNavListItem);
					$('header#site-header-yellow').css('background', defaultBgColor)
						.removeClass('bg-change');
					$primaryNavListItem.find('button')[0].focus();
					$currentActiveMenuItem = null;
				}

				const boxes = document.querySelectorAll('.anchor');
				boxes.forEach((box, index) => {
					box.setAttribute('aria-expanded', 'false');
				});
			}
		});


		//when user mouse hovers from outside menu area then menu needs to animate with set transitions defined in css
		//but as sson as it enter menu are we need to remove animation transitions which are enabled. so differnt animation menu can be opened quickly
		$('#mainNavigation > ul.aa-main-nav').hover(function () {
			removeAnimation = true;

		}, function () {
			$('body').removeClass('notransition');

			removeAnimation = false;

			//this condition is added because after multiple ESC and TAB press somehow UL mouseout event was triggering and
			//it was causing background to set default yellow color
			if ($currentActiveMenuItem == null) {
				$('header#site-header-yellow').css('background', defaultBgColor)
					.removeClass('bg-change');
			}
		});
	}

	if ($('#mainNavigation').hasClass('desktop-main-nav')) {
		$('.desktop-main-nav > ul.aa-main-nav > li.primary').hover(function () {
			// console.log("applying hover effects");
			$currentHoverMenuItem = $(this).find('.aa-mega-menu');
			//remove menu-active class from active mega menu from keyboard if open 
			if ($currentActiveMenuItem) {
				var $primaryNavigationListItem = $currentActiveMenuItem.parent();
				$currentActiveMenuItem
					.removeClass('menu-active')
					.removeAttr("style");

				var $menuUnderLine = $primaryNavigationListItem.find('button > hr');
				$menuUnderLine.css({
					"opacity": "0",
					"visibility": "hidden"
				});
				//If hover element and active keyboard element is not same then set active elment to null . giving preference to hover
				if ($currentActiveMenuItem[0] != $currentHoverMenuItem[0])
					$currentActiveMenuItem = null;
			}

			applyMenuHoverInEffects(this);
			if (removeAnimation) {
				setTimeout(function () {
					$('body').addClass('notransition');
				}, 500);

				removeAnimation = false;

			}
			$('#mainContent').removeAttr("style");
			$('#mainContent').css({ "visibility": "visible" });
			$('#mainContent').addClass('menu-base-transition');

		}, function () {
			$currentHoverMenuItem = null;
			applyMenuHoverOutEffects(this);

		});
	}

	applyMenuHoverInEffects = function ($primaryNavElement) {
		// console.log("In applyMenuHoverInEffects");
		$this = $primaryNavElement;
		var $megaMenu = $($this).find('.aa-mega-menu');
		$megaMenu.css({
			"opacity": "1",
			"visibility": "visible"
		});

		var $menuUnderLine = $($this).find('button > hr');
		$menuUnderLine.css({
			"opacity": "1",
			"visibility": "visible"
		});

		//change header background with css transition class
		$('header#site-header-yellow')
			.css('background', '#fff')
			.addClass('bg-change');

		$('header#site-header-yellow').addClass('menu-base-transition');
	}

	applyMenuHoverOutEffects = function ($primaryNavElement) {

		$this = $primaryNavElement;
		var $megaMenu = $($this).find('.aa-mega-menu');
		if (window.aa.helpers.cache.cachedElements.$window.width() > mobileBreakpoint) {

			$megaMenu.css({
				"opacity": "0",
				"visibility": "hidden"
			});

			var $menuUnderLine = $($this).find('button > hr');
			$menuUnderLine.css({
				"opacity": "0",
				"visibility": "hidden"
			});

			$('#mainContent').css({
				"visibility": "hidden",
			});
		}
	}
	

	$('header#site-header-yellow .main-nav ul.aa-main-nav > li').each(function () {
		if ($(this).find(".aa-mega-menu").length) {
			$(this).addClass('childrens')
		}
	});
	
	function mobileCloseClick(e) {
		// console.log("Mobille close called");
		e.preventDefault();

		$('body').removeClass("fixed-position");

		$('body').removeClass('mmenu-opened');
		$('header#site-header-yellow .main-nav').animate({ right: '-100vw' }, 0);
		$('header#site-header-yellow.mobilemenu-active').animate({ right: '-100vw' }, 0);
		$('header#site-header-yellow.mobilemenu-active .scroller').animate({ right: '-100vw' }, 0);
		setTimeout(function () { $('#site-header-yellow').removeClass('mobilemenu-active') }, 0);
		$('.left.logo').animate({ width: 'show' }, 0);
		$('.mobile-tablet-menu').animate({ width: 'show' }, 0);
		$('.right.mobile-grey').show();

		$('#mainContent').removeAttr("style");

		const mobilemenuButton = document.querySelectorAll('.mobile-tablet-menu');
		mobilemenuButton[0].setAttribute('aria-expanded', 'false');
		const mobilemenuButtonOpen = document.querySelectorAll('.mobile-tablet-menu-open');
		mobilemenuButtonOpen[0].setAttribute('aria-expanded', 'false');

		$('.main-nav').css('min-height', 'auto');
		if ($('.aa-mega-menu').hasClass('secondlevelOpen')) {
			$('.aa-mega-menu').stop().animate({ 'right': '-100vw' }, 0);
			primaryItem.parent('li').siblings('li').removeClass('hide-menu').removeClass('activated');
			$('.aa-mega-menu').removeClass('secondlevelOpen');
		}
		$(".scroller").css("height", "100vh");
		$(".left.logo a").focus();

		$(".mobile-grey a, .nav-logo a ").attr("tabindex", "-1");
		$("#mainNavigation button, .mobile-tablet-menu-open ").attr("disabled", "disabled");


		setTimeout(function () {
			primaryItem.parent('li').find('.anchor').removeClass('hide-menu');
			primaryItem.parent('li').siblings('li').removeClass('hide-menu').removeClass('activated');
		}, 0);
	}


	$('.mobile-tablet-menu').click(function (e) {
		e.preventDefault();

		$('body').addClass("fixed-position");
		$(".mobile-grey a, .nav-logo a ").removeAttr("tabindex");
		$("#mainNavigation button, .mobile-tablet-menu-open ").removeAttr("disabled");
		$('header#site-header-yellow .main-nav').animate({ right: '0' }, 300);
		$('.scroller').animate({ right: '0' }, 300);
		$('.left.logo').animate({ width: 'hide' }, 300);
		$('.mobile-tablet-menu').animate({ width: 'hide' }, 0);

		if ($('.scroller').length) {
			$('#site-header-yellow').addClass('mobilemenu-active');
		}
		var primaryHeight = $('.main-nav').height() + 120;
		$('.main-nav').css('min-height', 'auto');
		const mobilemenuButton = document.querySelectorAll('.mobile-tablet-menu');
		mobilemenuButton[0].setAttribute('aria-expanded', 'true');
		const mobilemenuButtonOpen = document.querySelectorAll('.mobile-tablet-menu-open');
		mobilemenuButtonOpen[0].setAttribute('aria-expanded', 'true');
		$(".scroller").css("height", (Math.max(document.documentElement.clientHeight, window.innerHeight || 0) - $("#site-header-yellow").offset().top));
		$(".left.menu-logo a").focus();
	});

	$('.mobile-tablet-menu-open').click(function (e) {
		// changes for CD-50114 start
		mobileCloseClick(e);
		// changes for CD-50114 end

	});
	var primaryItem = $('li.primary.childrens > button');
	var backlink = $('li.backLink > button');

	if (window.aa.helpers.cache.cachedElements.$window.width() <= mobileBreakpoint) {
		primaryItem.on('click', function (e) {
			console.log('primaryItem.on(click, function (e) ---');
			e.preventDefault();
			var megaHeight = $(this).next('.aa-mega-menu').height() + 120;
			
			$(this).parent('li').find('nav.aa-mega-menu.mobile-nav').stop().animate({ right: '0' }, 300);
			$(this).parent('li').removeClass('hide-menu');
			$(this).addClass('hide-menu');
			$(this).parent('li').siblings('li').addClass('hide-menu').removeClass('activated');
			$(this).parent('li').addClass('activated');
			$(this).next('.aa-mega-menu').addClass('secondlevelOpen');
			$(this).next('.aa-mega-menu').css('height', megaHeight);
			$('.main-nav').css('min-height', 'auto');

			$('.right.mobile-grey').hide();
			$('.column .sub-menu.col').animate({ width: 'show' }, 300);

			// $(".backLink button").focus();
			$(".left.menu-logo a").focus();


		});
		backlink.on('click', function (e) {
			e.stopPropagation();
			$(".secondlevelOpen").stop().animate({ width: 'hide' }, 300);
			$(this).parent('li').parent().parent().parent('.aa-mega-menu').stop().animate({ right: '-100vw' }, 300);
			$(this).parent('li').find('nav.aa-mega-menu.mobile-nav').stop().animate({ right: '-100vw' }, 300);

			setTimeout(function () {
				$('.right.mobile-grey').show();

			}, 300);

			$('.column .sub-menu.col').animate({ width: 'hide' }, 300);
			setTimeout(function () {
				primaryItem.parent('li').find('.anchor').removeClass('hide-menu');
				primaryItem.parent('li').siblings('li').removeClass('hide-menu').removeClass('activated');
			}, 300);
			$(this).parent('li').parent().parent().parent('.aa-mega-menu').removeClass('secondlevelOpen');
			$(this).next('.aa-mega-menu').css('height', 'auto');
			var primaryHeight = $('.main-nav').height() + 120;
			$('.main-nav').css('min-height', primaryHeight);
		});
	};
	window.aa.MenuSetupCompleted = true;
}
        </script>
    <header id="site-header-yellow" class="cf">
        <div class="wrapper cf">
                <div class="top-header-links cf">
                        <div class="left reltive">
<a class="skip-to-content-link" href="#mainContent"  accesskey="S">
  Skip to main content [Accesskey 'S']
</a><a class="skip-to-content-link" href="/"  accesskey="1">
  Go to home page [Accesskey '1']
</a><span class="business-customer-desktop">Are you a <a href="/business" class="mobile-no-display "><span  class="underline" href="/business">business customer?</span></a></span>                        </div>

                        <div class="right mobile-grey">
                            <ul class="top-links">
                                    <li>
                                        <a href="/breakdown-cover/broken-down/safety-advice" >Broken down?</a>
                                    </li>
                                    <li>
                                        <a href="/route-planner/route" >Route Planner</a>
                                    </li>
                                    <li>
                                        <a href="/help-support">Help and support</a>
                                    </li>
                            </ul>
                         
                        </div>
                </div>

                <div class="left logo">
                    <a href="/" title="The AA | Home">
                        <span class="svg-desktop"><svg xmlns="http://www.w3.org/2000/svg" width="70" height="48" viewBox="0 0 70 48" fill="none">
<path d="M68.2519 0H57.3789C56.8758 0 56.4121 0.279554 56.1668 0.730713L38.0168 34.1737V0.949372C38.0168 0.425327 37.6025 0 37.0922 0H26.2192C25.716 0 25.2524 0.279554 25.0071 0.730713L0.118151 46.5884C-0.225083 47.2213 0.220581 48 0.925918 48H9.43849C9.94615 48 10.4134 47.7149 10.6569 47.2573L15.0165 39.0414H27.7099V47.0506C27.7099 47.5747 28.1241 48 28.6344 48H40.5991C41.1068 48 41.574 47.7149 41.8175 47.2573L46.1771 39.0414H58.8705V47.0506C58.8705 47.5747 59.2847 48 59.795 48H68.2519C68.7623 48 69.1765 47.5747 69.1765 47.0506V0.949372C69.1765 0.425327 68.7623 0 68.2519 0ZM27.7099 29.2792H20.1964L27.275 15.9382C27.39 15.7223 27.709 15.8053 27.709 16.0517L27.7099 29.2792ZM58.8696 29.2792H51.3562L58.4347 15.9382C58.5497 15.7223 58.8687 15.8053 58.8687 16.0517L58.8696 29.2792Z" fill="#00081C"/>
</svg></span>
                        <span class="svg-mobile"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="32" viewBox="0 0 48 32" fill="none">
<path d="M47.3564 0H39.8121C39.4617 0 39.1399 0.183381 38.9683 0.486666L26.3753 22.7745V0.63478C26.3753 0.282124 26.0893 0 25.7317 0H18.1874C17.837 0 17.5152 0.183381 17.3436 0.486666L0.0810616 31.0478C-0.154922 31.471 0.152572 31.9859 0.638841 31.9859H6.55273C6.90313 31.9859 7.23208 31.7955 7.39655 31.4922L10.4214 26.019H19.2243V31.3582C19.2243 31.7108 19.5104 31.9929 19.8679 31.9929H28.1702C28.5206 31.9929 28.8496 31.8025 29.0141 31.4992L32.0389 26.026H40.8418V31.3652C40.8418 31.7179 41.1279 32 41.4854 32H47.3564C47.714 32 48 31.7179 48 31.3652V0.63478C48 0.282124 47.714 0 47.3564 0ZM19.2243 19.516H14.0112L18.924 10.622C19.0026 10.4809 19.2243 10.5374 19.2243 10.6996V19.516ZM40.8418 19.516H35.6287L40.5415 10.622C40.6202 10.4809 40.8418 10.5374 40.8418 10.6996V19.516Z" fill="#00081C"/>
</svg></span>
                    </a>
                </div>
            <button class="mobile-tablet-menu" aria-label="Navigation Menu" aria-expanded="false" style="background:none; border: none;"><span class="menu">Menu</span> </button>

            <div class="main-nav cf">
                <div class="cf nav-logo">
                        <div class="left menu-logo">
                            <a href="/" title="The AA | Home">
                                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="32" viewBox="0 0 48 32" fill="none">
<path d="M47.3564 0H39.8121C39.4617 0 39.1399 0.183381 38.9683 0.486666L26.3753 22.7745V0.63478C26.3753 0.282124 26.0893 0 25.7317 0H18.1874C17.837 0 17.5152 0.183381 17.3436 0.486666L0.0810616 31.0478C-0.154922 31.471 0.152572 31.9859 0.638841 31.9859H6.55273C6.90313 31.9859 7.23208 31.7955 7.39655 31.4922L10.4214 26.019H19.2243V31.3582C19.2243 31.7108 19.5104 31.9929 19.8679 31.9929H28.1702C28.5206 31.9929 28.8496 31.8025 29.0141 31.4992L32.0389 26.026H40.8418V31.3652C40.8418 31.7179 41.1279 32 41.4854 32H47.3564C47.714 32 48 31.7179 48 31.3652V0.63478C48 0.282124 47.714 0 47.3564 0ZM19.2243 19.516H14.0112L18.924 10.622C19.0026 10.4809 19.2243 10.5374 19.2243 10.6996V19.516ZM40.8418 19.516H35.6287L40.5415 10.622C40.6202 10.4809 40.8418 10.5374 40.8418 10.6996V19.516Z" fill="#00081C"/>
</svg>
                            </a>
                        </div>
                    <button class="mobile-tablet-menu-open" aria-expanded="false" style="background:none; border: none;padding-right:32px;"><span class="close">Close</span></button>
                </div>

                <div id="mainNavigation" class="right desktop-white">
                        <ul class="aa-main-nav"  role="menubar" >
                                <li class="primary childrens" role="menuitem" aria-haspopup="true">
<button class="anchor" aria-label="Breakdown"   aria-expanded="false"  aria-haspopup="aa-mega-menu">Breakdown<hr></button>                                    <nav id="aa-mega-menu" class="aa-mega-menu ">
                                        <div class="column cf">
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/breakdown-cover/">UK breakdown cover</a></li>
																		<li class="secondary"><a href="/breakdown-cover/broken-down/safety-advice">Report a breakdown</a></li>
																		<li class="secondary"><a href="/breakdown-cover/personal-cover">Personal breakdown cover</a></li>
																		<li class="secondary"><a href="/breakdown-cover/multicar-breakdown-cover">Multicar breakdown cover</a></li>
																		<li class="secondary"><a href="/breakdown-cover/family-breakdown-cover">Family breakdown cover</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/european-breakdown-cover">European breakdown cover</a></li>
																		<li class="secondary"><a href="/breakdown-cover/motorbikes">Motorbike breakdown cover</a></li>
																		<li class="secondary"><a href="/breakdown-cover/electric-cars">Electric car breakdown cover</a></li>
																		<li class="secondary"><a href="/business/breakdown">Business breakdown cover</a></li>
																		<li class="secondary"><a href="/breakdown-cover/caravans-and-motorhomes">Caravan and motorhome breakdown cover</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/breakdown-cover/instant-cover">Instant breakdown cover</a></li>
																		<li class="secondary"><a href="/breakdown-cover/accident-assist">Report an accident</a></li>
																		<li class="secondary"><a href="/breakdown-cover/fuel-assist">Wrong fuel assistance</a></li>
																		<li class="secondary"><a href="https://auth.theaa.com/login/?RelayState=https:%2F%2Fwww.theaa.com%2Fproducts">Manage your cover</a></li>
																		<li class="secondary"><a href="/breakdown-cover/advice">Breakdown guides</a></li>
                                                    </ul>
                                        </div>
                                    </nav>
                                </li>
                                <li class="primary childrens" role="menuitem" aria-haspopup="true">
<button class="anchor" aria-label="Insurance" aria-expanded="false"  aria-haspopup="aa-mega-menu">Insurance<hr></button>                                    <nav id="aa-mega-menu" class="aa-mega-menu ">
                                        <div class="column cf">
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/car-insurance/">Car insurance</a></li>
																		<li class="secondary"><a href="/car-insurance/electric-car-insurance">Electric car insurance</a></li>
																		<li class="secondary"><a href="/motorbike-insurance/">Motorbike insurance</a></li>
																		<li class="secondary"><a href="/car-insurance/short-term">Short term car insurance</a></li>
																		<li class="secondary"><a href="/car-insurance/advice">Car insurance guides</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/home-insurance/">Home insurance</a></li>
																		<li class="secondary"><a href="/home-insurance/buildings-insurance">Buildings insurance</a></li>
																		<li class="secondary"><a href="/home-insurance/contents-insurance">Contents insurance</a></li>
																		<li class="secondary"><a href="/home-insurance/advice">Home insurance guides</a></li>
																		<li class="secondary"><a href="/travel-insurance/">Travel insurance</a></li>
																		<li class="secondary"><a href="/insurance/">All insurance products</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/car-insurance/claims">Car insurance claim</a></li>
																		<li class="secondary"><a href="/home-insurance/claims">Home insurance claim</a></li>
																		<li class="secondary"><a href="https://auth.theaa.com/login/?RelayState=https:%2F%2Fwww.theaa.com%2Fproducts">Manage your policy</a></li>
                                                    </ul>
                                        </div>
                                    </nav>
                                </li>
                                <li class="primary childrens" role="menuitem" aria-haspopup="true">
<button class="anchor" aria-label="Vehicle maintenance" aria-expanded="false"  aria-haspopup="aa-mega-menu">Vehicle maintenance<hr></button>                                    <nav id="aa-mega-menu" class="aa-mega-menu ">
                                        <div class="column cf">
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/mot">MOTs</a></li>
																		<li class="secondary"><a href="/car-servicing">Car servicing</a></li>
																		<li class="secondary"><a href="/car-servicing/mobile-car-service">Mobile mechanics</a></li>
																		<li class="secondary"><a href="/car-care/book/start">Diagnostics</a></li>
																		<li class="secondary"><a href="/car-care/book/start">Vehicle health check</a></li>
																		<li class="secondary"><a href="/car-battery">Car battery replacement</a></li>
																		<li class="secondary"><a href="/breakdown-cover/key-assist">Car key replacement</a></li>
																		<li class="secondary"><a href="/car-care/book/start">A/C recharge</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/breakdown-cover/fuel-assist">Wrong fuel assistance</a></li>
																		<li class="secondary"><a href="/cars/warranty">Car warranty</a></li>
																		<li class="secondary"><a href="/car-servicing/advice">Car servicing guides</a></li>
																		<li class="secondary"><a href="/mot/advice">MOT guides</a></li>
                                                    </ul>
                                        </div>
                                    </nav>
                                </li>
                                <li class="primary childrens" role="menuitem" aria-haspopup="true">
<button class="anchor" aria-label="New and used cars"  aria-expanded="false"  aria-haspopup="aa-mega-menu">New and used cars<hr></button>                                    <nav id="aa-mega-menu" class="aa-mega-menu ">
                                        <div class="column cf">
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/used-cars/">Used cars for sale</a></li>
																		<li class="secondary"><a href="/car-leasing">New cars to lease</a></li>
																		<li class="secondary"><a href="/cars/">AA cars and vans</a></li>
																		<li class="secondary"><a href="/vehicle-check">Car history check</a></li>
																		<li class="secondary"><a href="/cars/warranty">Car warranty</a></li>
																		<li class="secondary"><a href="/cars/finance">Car finance</a></li>
																		<li class="secondary"><a href="/used-cars/valuation">Sell your car</a></li>
																		<li class="secondary"><a href="/vehicle-inspection">Vehicle inspection</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/car-reviews">Car reviews</a></li>
																		<li class="secondary"><a href="/cars/advice">Car buying guides</a></li>
                                                    </ul>
                                        </div>
                                    </nav>
                                </li>
                                <li class="primary childrens" role="menuitem" aria-haspopup="true">
<button class="anchor" aria-label=" Driving school" aria-expanded="false"  aria-haspopup="aa-mega-menu">Driving school<hr></button>                                    <nav id="aa-mega-menu" class="aa-mega-menu ">
                                        <div class="column cf">
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/driving-school/driving-lessons/">Driving lessons</a></li>
																		<li class="secondary"><a href="/driving-school/driving-instructor-training">Driving instructor training</a></li>
																		<li class="secondary"><a href="/driving-school/driving-instructor-franchise">Driving school franchise</a></li>
																		<li class="secondary"><a href="/driving-school/electric-vehicles">EV driving school franchise</a></li>
																		<li class="secondary"><a href="/driving-school/qualified-driver-lessons">Refresher driving lessons</a></li>
																		<li class="secondary"><a href="/car-insurance/learner-drivers">Learner driver insurance</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/driving-school/driving-lessons/aa-driving-theory-app">AA Driving Theory app</a></li>
																		<li class="secondary"><a href="/driving-school/lessons/login">Manage your lessons</a></li>
																		<li class="secondary"><a href="/driving-school">Driving school</a></li>
																		<li class="secondary"><a href="/driving-school/driving-lessons/advice">Learner driving advice</a></li>
                                                    </ul>
                                        </div>
                                    </nav>
                                </li>
                                <li class="primary childrens" role="menuitem" aria-haspopup="true">
<button class="anchor" aria-label="Finance"  aria-expanded="false"  aria-haspopup="aa-mega-menu">Finance<hr></button>                                    <nav id="aa-mega-menu" class="aa-mega-menu ">
                                        <div class="column cf">
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/loans">Loans</a></li>
																		<li class="secondary"><a href="/savings-accounts">Savings accounts</a></li>
																		<li class="secondary"><a href="/savings-accounts/isas">ISAs</a></li>
																		<li class="secondary"><a href="/loans/car-loans">Car loans</a></li>
																		<li class="secondary"><a href="/cars/warranty">Car warranty</a></li>
																		<li class="secondary"><a href="/finance/">All finance products</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/finance/help-support">Finance guides</a></li>
                                                    </ul>
                                        </div>
                                    </nav>
                                </li>
                                <li class="primary childrens" role="menuitem" aria-haspopup="true">
<button class="anchor" aria-label="Travel" aria-expanded="false"  aria-haspopup="aa-mega-menu">Travel<hr></button>                                    <nav id="aa-mega-menu" class="aa-mega-menu ">
                                        <div class="column cf">
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/route-planner/route">Route planner</a></li>
																		<li class="secondary"><a href="/route-planner/traffic-news">Traffic news</a></li>
																		<li class="secondary"><a href="/driving/mileage-calculator.jsp">Mileage calculator</a></li>
																		<li class="secondary"><a href="/driving-advice/driving-costs/fuel-prices">Fuel price report</a></li>
																		<li class="secondary"><a href="/european-breakdown-cover">European breakdown cover</a></li>
																		<li class="secondary"><a href="/travel-insurance/">Travel insurance</a></li>
																		<li class="secondary"><a href="/shop">Atlases, travel guides and driving kits</a></li>
                                                    </ul>
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="/driving-advice">Driving advice</a></li>
                                                    </ul>
                                        </div>
                                    </nav>
                                </li>
                                <li class="primary childrens" role="menuitem" aria-haspopup="true">
<button class="anchor user-icon" aria-label="Account"  aria-expanded="false"  aria-haspopup="aa-mega-menu">
<span>
<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
    <g fill="none" fill-rule="evenodd">
        <path d="M0 0h24v24H0z"/>
        <path d="M16 14a4 4 0 0 1 4 4v3a1 1 0 0 1-2 0v-3a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v3a1 1 0 0 1-2 0v-3a4 4 0 0 1 4-4h8zM12 2a5 5 0 1 1 0 10 5 5 0 0 1 0-10zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6z" fill="#1D1D1D"/>
    </g>
</svg>
</span>
Account<hr></button>                                    <nav id="aa-mega-menu" class="aa-mega-menu my-account">
                                        <div class="column cf">
                                                    <ul class="sub-menu col">
																		<li class="secondary"><a href="https://auth.theaa.com/login/?RelayState=https:%2F%2Fwww.theaa.com%2Fproducts">Log in to your account</a></li>
																		<li class="secondary"><a href="https://auth.theaa.com/signup/">Create an account</a></li>
																		<li class="secondary"><a href="/help-support#MTA">Update your details</a></li>
																		<li class="secondary"><a href="/smart-benefits">Smart benefits</a></li>
																		<li class="secondary"><a href="/apps">The AA app</a></li>
                                                    </ul>
                                        </div>
                                    </nav>
                                </li>
                        </ul>
                </div>
            </div>
        </div>
    </header>
    <div id="mainContent"></div>



<div style="">
    
    <div class="">
        <div class="cf viewport">
            
<div>
    <div class="campaign-hero " style="background-color:#00081C; background-image:url(/~/media/the-aa/hero-images/breakdown-cover/black-frid-aa-2023/d-hero-hp-blackfriday-v-2.png?rev=f90e59f1e80e48f099297919ef9dfd2e&amp;hash=57D80D488594AB7108E53AE0264B87CD); background-repeat:no-repeat; background-position-x:center;background-position-y:bottom;padding:36px 0px 56px 0px">
                <div class="wrapper campaign-hero-content white-color">
                    <div class="half-width" style="width: 54%">


                            <h1 class="alternate"> </h1>

<img style="width:100%; max-width:570px; min-height:234px; display:inline-block; margin-bottom:16px" src="~/media/the-aa/breakdown-cover/black-frid-aa-2023/m-d-hp-ukb-blackfriday-fieldwork-v-2.svg" alt="It's OK, it's Black Friday">
<p><strong style="font-family:NewTransport-Bold;">40% off breakdown cover with the UKâs number&nbsp;1</strong><br>
Add At Home, National Recovery or Onward Travel by 6&nbsp;December&nbsp;2023. Exclusively available online.</p>                        
                                                    <div class="btn-wrap">
                                <div class="cta centred dual-cta">
        <a href="/breakdown-cover/uk?base=PRD_UK_0002&amp;payment=CMM&amp;optMshp=vcon100&amp;policyType=m" class="button ra primary ">
            Buy breakdown cover
        </a>
        <a href="/breakdown-cover/" class="button ra tertiary ghost-white-bordered ">
            About our cover
        </a>
</div>
<p class="text-link centred">
     
</p>
                            </div>

                                            </div>
                    
                </div>




    </div>

</div>



        </div>
    </div>

    

    
    <div class="row">
        <div class="cf wrapper">
            <div class="two-column cf">
                <div class="col">
                    

<article style= "background-image:url(~/media/the-aa/related-product/breakdown-cover/black-frid-aa-2023/d-bg-tile-black-border.png?rev=123b8288ecca405c93fbb50e615ef911&amp;hash=6860E8771768A7EA783C295C675B06BF); background-position-x:left; background-position-y:bottom; background-size: ; background-repeat:;" class="module   related-product shadow-secondary left half-width   ">




    <div class="text-overlay">
        <div class="inner white-color centred">

            <span class="tag"></span>
            <div class="module-content cf">
                <div class="hgroup">
                    <h2 class="alt-title">Â£25 off car insurance</h2>
                    <p class="supportText">Just get a quote and buy online by 29 November. Ts&Cs apply.</p>
                </div>
                
                <a class="link " href="/car-insurance"></a>
                
            </div>
<a href="/car-insurance" class="button ra primary " >
Save on car insurance
</a>        </div>
    </div>
</article>












                </div>
                <div class="col">
                    

<article style= "background-image:url(~/media/the-aa/related-product/breakdown-cover/black-frid-aa-2023/bg-tile-black.png?rev=beac4e511e74441c9537014249a31df0&amp;hash=4C716B13E97D5A0829E00281780F642D); background-position-x:left; background-position-y:bottom; background-size: ; background-repeat:;" class="module   related-product shadow-secondary left half-width   ">



    <figure class="image cf mobile-view">
        <img src="/~/media/the-aa/related-product/breakdown-cover/black-frid-aa-2023/mbg-tile-black-border.png?h=542&amp;iar=0&amp;w=885&amp;rev=c44166ac25434572b54da1dc75a7898e&amp;hash=D6E164CC31E72CCDFD423F4BBF137CDD" alt="Mbgtileblackborder" width="885" height="542" title="Mbgtileblackborder" />
    </figure>

    <div class="text-overlay">
        <div class="inner white-color centred">

            <span class="tag"></span>
            <div class="module-content cf">
                <div class="hgroup">
                    <h2 class="alt-title">Â£50 voucher with your home insurance</h2>
                    <p class="supportText">Just get a quote and buy online by 6 December for your chance to win a Â£50 Love2shop voucher. Ts&Cs apply.</p>
                </div>
                
                <a class="link " href="/home-insurance"></a>
                
            </div>
<a href="/home-insurance" class="button ra primary " >
Save on home insurance
</a>        </div>
    </div>
</article>












                </div>
            </div>
        </div>
    </div>

    
    <div class="row">
        <div class="cf wrapper">
            <div class="two-column cf">
                <div class="col">
                    

<article style= "" class="module   related-product shadow-secondary left half-width   ">




    <div class="text-overlay">
        <div class="inner  centred">

            <span class="tag"></span>
            <div class="module-content cf">
                <div class="hgroup">
                    <h2 class="alt-title">Had an accident? </h2>
                    <p class="supportText">Contact us first and weâll handle everything â from vehicle recovery to making a claim. </p>
                </div>
                
                <a class="link " href="https://www.theaa.com/breakdown-cover/accident-assist?utm_source=webhomepage&amp;amp;utm_medium=weblink&amp;amp;utm_campaign=AAS_homepage_generic1"></a>
                
            </div>
<a href="https://www.theaa.com/breakdown-cover/accident-assist?utm_source=webhomepage&amp;utm_medium=weblink&amp;utm_campaign=AAS_homepage_generic1" class="button ra primary " >
More about Accident Assist
</a>        </div>
    </div>
</article>












                </div>
                <div class="col">
                    

<article style= "" class="module  beam related-product shadow-secondary left half-width   ">




    <div class="text-overlay">
        <div class="inner  centred">

            <span class="tag"></span>
            <div class="module-content cf">
                <div class="hgroup">
                    <h2 class="alt-title">AA Mobile Mechanics</h2>
                    <p class="supportText">Car servicing on your driveway â our fully trained AA mechanics can come to you (subject to availability).</p>
                </div>
                
                <a class="link " href="/car-servicing/mobile-car-service?sc=homepage_aacom"></a>
                
            </div>
<a href="/car-servicing/mobile-car-service?sc=homepage_aacom" class="button primary-dark ra " >
Book your mechanic
</a>        </div>
    </div>
</article>












                </div>
            </div>
        </div>
    </div>

    
    <div class="row">
        <div class="cf wrapper">
            

<article style= "" class="module  beam related-product shadow-secondary single cf   ">




    <div class="text-overlay">
        <div class="inner  centred">

            <span class="tag"></span>
            <div class="module-content cf">
                <div class="hgroup">
                    <h2 class="alt-title">Route planner</h2>
                    <p class="supportText">Our recommended routes can help you get to your destination safely and easily. You can also avoid traffic and find nearby parking, wherever the road takes you.</p>
                </div>
                
                <a class="link " href="/route-planner/route"></a>
                
            </div>
<a href="/route-planner/route" class="button primary-dark ra " >
Plan a route
</a>        </div>
    </div>
</article>












        </div>
    </div>

    
    <div class="row">
        <div class="cf wrapper">
            

<article style= "" class="module  white-bg-color related-product shadow-secondary single cf   ">




    <div class="text-overlay">
        <div class="inner  centred">

            <span class="tag"></span>
            <div class="module-content cf">
                <div class="hgroup">
                    <h2 class="alt-title">Driving school</h2>
                    <p class="supportText">Let us guide you to driving success and so much more as an AA pupil.</p>
                </div>
                
                <a class="link " href="/driving-school/driving-lessons"></a>
                
            </div>
<a href="/driving-school/driving-lessons" class="button ra primary " >
Learn to drive
</a>        </div>
    </div>
</article>












        </div>
    </div>

    
    <div class="row">
        <div class="cf wrapper">
            

<article style= "" class="module  beam related-product shadow-secondary single cf   ">




    <div class="text-overlay">
        <div class="inner  centred">

            <span class="tag"></span>
            <div class="module-content cf">
                <div class="hgroup">
                    <h2 class="alt-title">Home insurance</h2>
                    <p class="supportText">Whether you need buildings or contents cover, or both, take a look at how we can help you protect your home.</p>
                </div>
                
                <a class="link " href="/home-insurance"></a>
                
            </div>
<a href="/home-insurance" class="button primary-dark ra " >
Get home insurance
</a>        </div>
    </div>
</article>












        </div>
    </div>

    
    <div class="row">
        <div class="cf wrapper">
            

    <article class="module-container inner-shadow-top radial-bg-color ">
            <div class="module cross-sell full-width cf transparent-bg" data-mobile="" style="">
                <div class="cf wrapper">
                        <figure class="image left">
                            <img src="~/media/the-aa/buy-a-car/homepage/keys.png?rev=e92a6a6956f840049f3d96805feed27d&amp;hash=D9A231F12E1073D4B0DEAC73E777101B" alt="Keys" />
                        </figure>
                    <div class="right">
                        <hgroup class="six-column-width">
                            <h3>Looking for a new car?</h3>
                            <h5>Every car we list comes with a history check and breakdown cover, at the very least</h5>
                        </hgroup>
                            <div class="cta">
                                <a href="https://www.theaa.com/cars/" class="button primary ra " >
Buy a used car
</a>
                            </div>

                            <p class="small-text disclaimer six-column-width"></p>
                    </div>
                </div>
            </div>
    </article>

        </div>
    </div>

    
    <div class="row">
        <div class="cf wrapper">
                <div class="accordion cf" data-animating="true" tabindex="-1">
                                    <div class="accordion-item active">
                                        <h5 class="accordion-header shadow-secondary" tabindex="0">
Good to know <span class="arrow transition slow"></span>
                                        </h5>
                                        <div class="accordion-content shadow-secondary open">
                                            <div class="inner cf">
                                                <h5>*40% off breakdown cover packages is only available when you take out a new Membership with At Home, National Recovery or Onward Travel on theAA.com, versus the prices available via theAA.com between 2 November and 19 November 2023.</h5>
<p>The sale starts on 20 November 2023 and ends at 11.59 pm on 6 December 2023. This introductory offer: (1) is only available online at theAA.com; (2) is for new AA breakdown customers only who are UK residents, and not existing AA breakdown members or at renewal; (3) only applies to the first year of your membership; (4) does not apply when only Roadside Assistance is purchased, or to Parts &amp; Garage Cover; (5) is not available in conjunction with any other offer, discount or promotion or in a breakdown situation; and (6) is not valid and prices are subject to change if you hold your Breakdown membership in relation to a vehicle used to carry items or people for money, or if you are in material breach of any other terms of your Roadside Assistance policy. You can choose how your policy renews when you set up your cover. You&rsquo;ll receive notice beforehand of the price of membership after the first 12 months, so you&rsquo;ll have plenty of time to change or cancel your cover. There&rsquo;s no cash alternative. The AA reserves the right to withdraw or alter this promotion without prior notice at any time.</p>




                                                <div class="accordion-placeholder">
                                                    
                                                </div>
                                            </div>
                                        </div>
                                    </div>
    </div>

        </div>
    </div>

    
    <div class="row">
        <div class="cf ">
            <aside class="social-media-icons">
    <h3>Connect with us</h3>
    <ul>
        <li>
            <a href="http://twitter.com/TheAA_uk">
                <img src="/~/media/the-aa/social/twitter-2.png?h=50&amp;iar=0&amp;w=50&amp;rev=195e3b2ad45b46f19dd4cebcf4527973&amp;hash=5318E5F4F9EC8FFF9D6254C79EE3F7F8" alt="Twitter 2" width="50" height="50" title="Twitter 2" />
            </a>
        </li>
        <li>
            <a href="http://www.facebook.com/TheAAUK">
                <img src="/~/media/the-aa/social/facebook-2.png?h=50&amp;iar=0&amp;w=50&amp;rev=3bc13889dc2341419dd0c463ced7720f&amp;hash=98A5F66E2D34596FF5B94DF41D5CCA27" alt="Facebook 2" width="50" height="50" title="Facebook 2" />
            </a>
        </li>
        <li>
            <a href="https://www.instagram.com/theaa_uk/">
                <img src="/~/media/the-aa/social/instagram-2.png?h=50&amp;iar=0&amp;w=50&amp;rev=e762798809a0438aafb0a9a5c806d648&amp;hash=CA10612967B554BE745A6D7B98955392" alt="Instagram 2" width="50" height="50" title="Instagram 2" />
            </a>
        </li>
    </ul>
</aside>
        </div>
    </div>

    
    
    <div class="row">
        <div class="cf wrapper">
            
    <!--broken down floating component html-->
    <section id="report-breakdown" class="cf">
        <div class="wrapper cf">
            <div class="report-btn-wrap">
                <div class="left">
                    <p></p>
                </div>
                <div class="right">
                                <a href="/breakdown-cover/broken-down/safety-advice" class="broken-down-button report-breakdown">
                                    <span class="broken-text">Broken down?</span>
                                </a>


                </div>
            </div>
        </div>
    </section>
    <!--added close btn section-->
    <section id="report-breakdown-close-section" style="display:none" class="desk-top-tab-view cf">
        <div class="wrapper cf">
            <div class="report-btn-wrap">
                <div class="left">
                    <p></p>
                </div>
                <div class="right">
                    <button type="button" class="close-btn" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Close</span></button>
                </div>
            </div>
        </div>
    </section>

        </div>
    </div>

</div>
            <div id="nav-overlay"></div>
        </div>
        <footer id="site-footer" class="cf animated blur-in-half">
                <section id="persistent-footer" class="cf">
        <div class="wrapper cf">
                <ul>
                        <li><a href="/about-us">About us</a></li>
                        <li><a href="/about-us/gender-pay-gap">Gender pay gap</a></li>
                        <li><a href="/help-support/contact-us">Contact us</a></li>
                        <li><a title="Apps" href="/apps">Apps</a></li>
                        <li><a href="https://www.theaacareers.co.uk/">Careers</a></li>
                        <li><a href="/~/media/the-aa/pdf/modern-slavery-act-statement-2023.pdf?rev=56f6ae15be214bd5ba5824e154e04d7d&amp;hash=1C92ADEF3EFD6B81F7ADC69AA4B541C9">Modern slavery</a></li>
                        <li><a href="/terms-and-conditions">Terms of use</a></li>
                        <li><a href="/privacy-notice">Privacy notice</a></li>
                        <li><a href="/help-support/privacy">Privacy hub</a></li>
                        <li><a href="/cookie-policy">Cookies</a></li>
                        <li></li>
                </ul>
        </div>
    </section>
    <section id="footer-bottom" class="cf" typeof="WPFooter">
        <div class="wrapper cf">
            <div class="left">
                <p></p>
            </div>
            <div class="right">
                <p>
                    &copy;
                    <span property="copyrightHolder" typeof="Organization">
                        <span property="name">Automobile Association Developments Ltd.</span>
                    </span>
                    <span property="copyrightYear">2023</span>
                </p>
            </div>
        </div>
    </section>
    <section id="seo-footer" class="cf">
        <div class="wrapper cf">
            <article class="four-column cf">
                    <ul class="col">
                                <li property="significantLink" content="https://www.theaa.com/breakdown-cover/"><a href="https://www.theaa.com/breakdown-cover/">Breakdown Cover</a></li>
                                <li property="significantLink" content="https://www.theaa.com/cars/"><a title="AA Cars" href="https://www.theaa.com/cars/">AA Cars</a></li>
                    </ul>
                    <ul class="col">
                                <li property="significantLink" content="/route-planner/route"><a title="Route Planner" href="/route-planner/route">Route Planner</a></li>
                                <li property="significantLink" content="https://www.theaa.com/driving-advice"><a href="/driving-advice">DRIVING</a></li>
                    </ul>
                    <ul class="col">
                                <li property="significantLink" content="/insurance/"><a title="Insurance" href="/insurance/">Insurance</a></li>
                                <li property="significantLink" content="https://www.theaa.com/car-care/book/start"><a href="https://www.theaa.com/car-care/book/start">CAR SERVICE &amp; MOT</a></li>
                    </ul>
                    <ul class="col">
                                <li property="significantLink" content="https://www.theaa.com/finance/"><a href="https://www.theaa.com/finance/">FINANCIAL SERVICES</a></li>
                                <li property="significantLink" content="https://www.theaa.com/breakdown-cover/keyworker"><a title="Key workers" href="/breakdown-cover/keyworker">Key workers</a></li>
                    </ul>
            </article>
        </div>
    </section>

        </footer>
    </div>

    <!-- page javascripts -->


    <style>
    .hero-image .text-overlay {
    top: 10rem !important;
    }
    /* HiDPI screen Macbook Pro and smaller */
    @media screen and (max-width: 1450px)
    {
    .hero-image .text-overlay {
    top: 4.2rem !important;
    }
    }
    /* Old Macbook Pro and smaller */
    @media screen and (max-width: 1366px)
    {
    .hero-image .text-overlay {
    top: 4.2rem !important;
    }
    }
    /* IPad pro and smaller */
    @media screen and (max-width: 1160px)
    {
    .hero-image .text-overlay {
    top: 1.6rem !important;
    }
    .hero-image .text-overlay .button {
    margin-top: 1.6rem !important;
    }
    }
    /* IPad pro and smaller */
    @media screen and (max-width: 880px)
    {
    .hero-image .text-overlay {
    top: 1.6rem !important;
    }
    .hero-image .text-overlay .button {
    margin-top: 0rem !important;
    }
    .hero-image .text-overlay h3 {
    padding: 0rem 0 2.4rem !important;
    }
    }
</style>

<!-- BUNDLE -->
<script src="/Assets/scripts/libs/codehouse-js/boot.min.js                   "></script>
<script src="/Assets/scripts/libs/bootstrap.min.js                           "></script>
<script src="/Assets/scripts/libs/codehouse-js/client.min.js                 "></script>
<script src="/Assets/scripts/libs/codehouse-js/cookie.min.js                 "></script>
<script src="/Assets/scripts/libs/codehouse-js/codehouse-placeholders.min.js "></script>
<script src="/Assets/scripts/libs/codehouse-js/form-validation.min.js        "></script>
<script src="/Assets/scripts/libs/codehouse-js/responsive.min.js             "></script>
<script src="/Assets/scripts/libs/codehouse-js/serialise.min.js              "></script>
<script src="/Assets/scripts/libs/codehouse-js/stylish-forms.min.js          "></script>
<script src="/Assets/scripts/libs/codehouse-js/touch.min.js                  "></script>
<script src="/Assets/scripts/libs/codehouse-js/toolkit.min.js                "></script>
<script src="/Assets/scripts/libs/mustache.min.js                            "></script>
<script src="/Assets/scripts/global/helpers.js                               "></script>
<script src="/Assets/scripts/app-banner.js                                   "></script>
<script src="/Assets/scripts/forms.js                                        "></script>
<!-- ROADS-BUNDLE -->
<script src="/Assets/scripts/libs/jquery-ui.min.js             "></script>
<script src="/Assets/scripts/libs/jquery.ui.touch-punch.min.js "></script>
<script src="/Assets/scripts/roads/sales-journey-application.js?v=4.6"></script>
<script src="/Assets/scripts/roads/custom-validation-rules.js  "></script>
<script src="/Assets/scripts/roads/helpers.js                  "></script>

<script>
/* 
 * ---------------------------------------- *
 * Name:    Header JavaScripts              *
 * Type: 	JavaScript                      *
 * Version: Not Versioned                   *
 * Author:	Thomas Dale | Codehouse         *
 * ---------------------------------------- *
 */

(function ($) {

    var $header = $('#site-header, #sales-journey-header'),
        $primaryNavigation = $header.find('#primary-navigation'),
        $aaRoutePlannerContainer = window.aa.helpers.cache.cachedElements.$body.find('.aa-route-planner-container'),
        $aaRoutePlannerTakeover = window.aa.helpers.cache.cachedElements.$body.find('#aa-route-planner-takeover'),
        $megaMenuContainer = $primaryNavigation.find('.mega-menu'),
        $secondLevelNavigation,
        headerHeight = $header.outerHeight(),
        resizeTimer,
        navDelayTimer;

    // check cookie & dropdown if non-existent
    function cookieLaw() {

        var $cookieLawBar = $('#cookie-bar'),
            $cookieAccept = $cookieLawBar.find('.accept');

        function hideCookieBar() {
            $cookieLawBar.find('.text').removeClass('fade-in').stop().fadeOut(550);
            $cookieLawBar.stop().slideUp(550);
        }

        function writeCookie() {
            window.aa.helpers.cache.registerCookie.write('aaCookie', 'aaCookiebar', $cookieLawBar.data('expiry'));
            hideCookieBar();
        }

        if (!window.aa.helpers.cache.registerCookie.check('aaCookie')) {
            $cookieLawBar.stop().slideDown(550);
        }

        // write cookie on acceptance and hide bar
        $cookieAccept.on({
            click: writeCookie,
            keypress: function (e) {
                if (e.keyCode === 13 || e.which === 13) {
                    writeCookie();
                }
            }
        });
    }

    // apply class to allow header to be fixed
    function stickyHeader() {

        // disable sticky header on mobile only
        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            return;
        }

        if (window.aa.helpers.cache.cachedElements.$window.scrollTop() >= headerHeight) {
            $header.addClass('sticky');
            $aaRoutePlannerTakeover.addClass('hidden');
            window.aa.helpers.cache.cachedElements.$main.css({ paddingTop: headerHeight });

        } else {
            $header.removeClass('sticky');
            $aaRoutePlannerTakeover.removeClass('hidden');

            if (client.Mobile) {
                setTimeout(function () {
                    window.aa.helpers.cache.cachedElements.$main.css({ paddingTop: 0 });
                });

            } else {
                window.aa.helpers.cache.cachedElements.$main.css({ paddingTop: 0 });
            }
        }

        $('.my-account').removeClass('active');

    }

    // header takeover forms
    function headerTakeovers() {

        var $takeovers = $(this),
            $closeTakeover = $takeovers.find('.close-takeover'),
            $routePlannerTakeover = $takeovers.filter('#route-planner-takeover'),
            $closeAaTakeover = $aaRoutePlannerTakeover.find('.aa-takeover-btn'),
            $searchTakeover = $takeovers.filter('#search-takeover'),
            $bothTakeovers = $searchTakeover.add($routePlannerTakeover),
            $headerLinks = $('#helpful-links').add('#top-level-nav'),
            transitionTimer,
            routePlannerHeight,
            activePlace = -1;

        // route planner toggle
        function toggleRoutePlanner() {

            var $firstInput = $routePlannerTakeover.find('input').filter(':first');

            if (client.oldIE || client.IE9) {
                $headerLinks.stop().fadeOut(250);
                $routePlannerTakeover.stop().fadeIn(500);
                $firstInput.focus();
                return;
            }

            $headerLinks.addClass('animated blur-out');
            $routePlannerTakeover.stop().toggleClass('animated zoom-in');
            $firstInput.focus();
            hideNavigation();
        }

        // aa route planner animating 
        function routePlannerAnimating() {

            window.aa.helpers.cache.cachedElements.$body.removeClass('transition-off').addClass('transition-on');

            clearTimeout(transitionTimer);

            transitionTimer = setTimeout(function () {
                window.aa.helpers.cache.cachedElements.$body.removeClass('transition-on').addClass('transition-off');
            }, 550);
        }

        // aa route planner toggle
        function toggleAaRoutePlanner() {

            var $firstInput = $aaRoutePlannerTakeover.find('input').filter(':first');

            if ($aaRoutePlannerTakeover.hasClass('active')) {
                routePlannerHeight = $aaRoutePlannerTakeover.css({ maxHeight: '' }).outerHeight();

                $aaRoutePlannerTakeover.add($aaRoutePlannerContainer).css({ overflow: 'hidden' });
                routePlannerAnimating();
                $aaRoutePlannerTakeover.css({ maxHeight: routePlannerHeight }).stop().animate({ maxHeight: 0 }, 550, function () {
                    $aaRoutePlannerTakeover.add($aaRoutePlannerTakeover.parent()).removeClass('active');
                });

            } else {

                window.aa.helpers.cache.cachedElements.$window.scrollTop(0);
                $aaRoutePlannerTakeover.add($aaRoutePlannerTakeover.parent()).addClass('active');

                if (!routePlannerHeight) {
                    routePlannerHeight = $aaRoutePlannerTakeover.outerHeight();
                }

                hideNavigation();
                routePlannerAnimating();
                $aaRoutePlannerTakeover.stop().animate({ maxHeight: routePlannerHeight }, 550, function () {
                    $firstInput.focus();
                    $aaRoutePlannerTakeover.add($aaRoutePlannerContainer).css({ overflow: 'visible' });
                });
            }
        }

        // navigate through suggested places list
        function navigateSuggestedPlaces(placeIndex) {

            var $places = window.aa.helpers.cache.cachedElements.$body.find('.location-suggestions .place');

            activePlace += placeIndex;

            if (activePlace >= $places.length) {
                activePlace = 0;

            } else if (activePlace < 0) {
                activePlace = $places.length;
            }

            window.aa.helpers.cache.cachedElements.$body.addClass('no-overflow');
            window.aa.helpers.cache.cachedElements.$body.find('#chosen-location').blur();
            $places.removeClass('place-active').eq(activePlace).addClass('place-active');
        }

        // hide location suggestions
        function hideLocationSuggestions() {
            window.aa.helpers.cache.cachedElements.$body.removeClass('no-overflow');
            window.aa.helpers.cache.cachedElements.$main.find('.chosen-location').removeClass('active-search');
            window.aa.helpers.cache.cachedElements.$main.find('.location-suggestions').hide().empty();
        }

        // traffic news events
        function initTrafficNews() {

            var $trafficInfoContainer = $(this),
                $locationInputContainer = $trafficInfoContainer.find('.chosen-location'),
                $locationInput = $locationInputContainer.find('#chosen-location'),
                $locationSuggestionsList = $trafficInfoContainer.find('.location-suggestions'),
                $trafficReport = $trafficInfoContainer.find('.traffic-report'),
                $trafficNews = $trafficInfoContainer.find('.traffic-news'),
                $setLocation = $trafficInfoContainer.find('.set-location'),
                $setLat = $trafficInfoContainer.find('.set-lat'),
                $setLong = $trafficInfoContainer.find('.set-long'),
                defaultLocation = $locationInputContainer.data('default-location'),
                defaultLat = $locationInputContainer.data('default-lat'),
                defaultLong = $locationInputContainer.data('default-long'),
                suggestionsViewTemplate = $locationSuggestionsList.html(),
                trafficReportViewTemplate = $trafficReport.html(),
                loadSuggestionsTimer;

            // set location preferences
            function populateFields(lat, long, location) {
                $setLat.val(lat);
                $setLong.val(long);

                if (window.aa.salesJourneyApp.helpers.isDefined(location)) {
                    $locationInput.val(location);
                    $locationInput.data('chosen-location', location);
                }
            }

            // get my location using geolocation api
            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(setPosition, showError);
                } else {
                    populateFields(defaultLat, defaultLong, defaultLocation);
                }
            }

            // set my location using geolocation api
            function setPosition(position) {

                var lat = position.coords.latitude,
                    long = position.coords.longitude;

                $.ajax({
                    method: 'GET',
                    url: 'https://maps.googleapis.com/maps/api/geocode/json',
                    data: { latlng: lat + ',' + long }
                }).done(function (response) {

                    if (window.aa.salesJourneyApp.helpers.isDefined(response.results)) {
                        populateFields(lat, long, response.results[0].address_components[2].long_name);

                    } else {
                        populateFields(defaultLat, defaultLong, defaultLocation);
                    }
                }).fail(window.aa.salesJourneyApp.helpers.serviceErrorModal);
            }

            // geolocation error handling
            function showError(error) {
                switch (error.code) {
                    case error.PERMISSION_DENIED:
                        $('[data-location-off]').show();
                        updateRoutePlannerHeight();
                        break;
                    case error.POSITION_UNAVAILABLE:
                    case error.TIMEOUT:
                    case error.UNKNOWN_ERROR:
                        populateFields(defaultLat, defaultLong, defaultLocation);
                        break;
                }
            }

            // load location suggestions
            function loadSuggestedLocations($input, location) {

                var $inputLoader = $trafficInfoContainer.find('.input-loader');

                $inputLoader.stop().fadeIn(250);
                $input.blur();

                $.ajax({
                    method: 'GET',
                    url: '/cms/ajax/api/RoutePlannerTrafficNews/GetSuggestedAddresses',
                    data: { searchText: location }
                }).done(function (response) {

                    $inputLoader.stop().fadeOut(250);
                    hideLocationSuggestions();
                    activePlace = -1;

                    if (window.aa.salesJourneyApp.helpers.isDefined(response.Result)) {

                        for (var i = 0; i < response.Result.length; i += 1) {

                            $locationSuggestionsList.append(Mustache.render(suggestionsViewTemplate, response.Result[i])).show();
                            $locationInputContainer.addClass('active-search');
                        }

                        $input.removeClass('typing').focus();
                    } else {
                        populateFields(defaultLat, defaultLong, defaultLocation);
                    }
                }).fail(window.aa.salesJourneyApp.helpers.serviceErrorModal);
            }

            // get location coordinates
            function getLocationCoordinates(callback) {

                $setLocation.prop('disabled', true).addClass('disabled');

                $.ajax({
                    method: 'GET',
                    url: '/cms/ajax/api/RoutePlannerTrafficNews/GetPlace',
                    data: { address: $locationInput.data('chosen-location') }
                }).done(function (response) {

                    $setLocation.prop('disabled', false).removeClass('disabled');

                    if (window.aa.salesJourneyApp.helpers.isDefined(response.Result)) {
                        populateFields(response.Result.Latitude, response.Result.Longitude);

                    } else {
                        populateFields(defaultLat, defaultLong, defaultLocation);
                    }

                    if (typeof callback === 'function') {
                        callback();
                    }

                }).fail(window.aa.salesJourneyApp.helpers.serviceErrorModal);

            }

            // set am/pm time
            function hourAmPm(date) {

                var setDate = new Date(date),
                    hours = setDate.getHours(),
                    ampm = (hours >= 12) ? 'PM' : 'AM',
                    minutes = (setDate.getMinutes() < 10) ? '0' + setDate.getMinutes() : setDate.getMinutes();

                return hours + ':' + minutes + ampm;
            }

            // format incident occurrence time
            function formatIncidentDate(incidentDate) {

                var monthNames = ['Jan', 'Febr', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'],
                    date = new Date(incidentDate),
                    day = date.getDate(),
                    year = date.getFullYear(),
                    month = monthNames[date.getMonth()];

                return (day + ' ' + month + ' ' + year + ', ' + hourAmPm(incidentDate));
            }

            // get news traffic data
            function getTrafficNews() {

                var $sectionLoader = $trafficInfoContainer.find('.section-loader');

                $setLocation.prop('disabled', true).addClass('disabled');
                $sectionLoader.stop().fadeIn(250);

                if (!$aaRoutePlannerTakeover.is('.active')) {
                    window.aa.salesJourneyApp.cache.$main.find('#aa-route-planner').prop('disabled', true);
                }

                $.ajax({
                    method: 'GET',
                    url: '/cms/ajax/api/RoutePlannerTrafficNews/GetIncidentsInRadius',
                    data: { coordinates: $setLat.val() + '|' + $setLong.val() }
                }).done(function (response) {

                    var $incidentTime,
                        $incidentDescription,
                        view = Mustache.render(trafficReportViewTemplate, response);

                    $setLocation.prop('disabled', false).removeClass('disabled');
                    $sectionLoader.hide();

                    if (window.aa.salesJourneyApp.helpers.isDefined(response)) {

                        $trafficReport.hide().empty();
                        $trafficNews.hide();
                        $trafficReport.append(view).show();

                        // cache dynamic generated selectors
                        $incidentTime = $trafficReport.find('.incident-time');
                        $incidentDescription = $trafficReport.find('.incident-description');

                        if (window.aa.salesJourneyApp.helpers.isDefined(response.Description) && window.aa.salesJourneyApp.helpers.isDefined(response.IncidentSeverity)) {

                            $incidentDescription.empty().html(response.Description.split(': ')[1]);
                            $incidentTime.html(formatIncidentDate(response.StartDate) + ' (' + $incidentTime.data('label') + ')');

                        } else {
                            $trafficReport.find('.incident-title').remove();

                            if (response.StartDate !== $trafficInfoContainer.data('time-undefined') || window.aa.salesJourneyApp.helpers.isDefined(response.UpdatedDateTime)) {
                                $incidentTime.html($trafficReport.find('.report-details').data('last-update').replace('{time}', formatIncidentDate(response.UpdatedDateTime)));
                            }

                            $trafficReport.find('.road-icon').remove();
                            $trafficReport.find('.report-details').addClass('report-not-available');
                            $incidentDescription.html($incidentDescription.data('no-incidents'));
                        }

                        $trafficReport.find('.current-location p').html($locationInput.data('chosen-location').split(',', 1));
                        updateRoutePlannerHeight();

                    } else {
                        window.aa.salesJourneyApp.helpers.serviceErrorModal();
                    }

                    window.aa.salesJourneyApp.cache.$main.find('#aa-route-planner').prop('disabled', false);

                }).fail(window.aa.salesJourneyApp.helpers.serviceErrorModal);
            }

            // on load set traffic news for London by default
            populateFields(defaultLat, defaultLong, defaultLocation);
            getTrafficNews();

            // show location suggestions on keyup
            $locationInput.off('keyup').on('keyup', function (e) {

                var $target = $(this),
                    targetValue = $target.val();

                if (e.which === 40 && $locationSuggestionsList.find('.place').length) {
                    navigateSuggestedPlaces(0);
                    return;
                }

                clearTimeout(loadSuggestionsTimer);

                if ($target.hasClass('typing') && targetValue.length >= 3 && e.which !== 27) {
                    loadSuggestionsTimer = setTimeout(function () {
                        loadSuggestedLocations($target, targetValue);
                    }, 350);

                } else {
                    hideLocationSuggestions();
                    $target.data('chosen-location', '');
                }
            });

            // set chosen location
            $locationSuggestionsList.off('click').on('click', '.place', function () {

                var location = $(this).data('location-to-send');

                $locationInput.data('chosen-location', location);
                $locationInput.val(location.split(',', 1));
                hideLocationSuggestions();
            });

            // edit location and reset traffic info
            $trafficReport.off('click').on('click', '.edit-location', function (e) {
                e.preventDefault();
                $trafficReport.hide().empty();
                $trafficNews.show();
                $locationInput.focus();
                updateRoutePlannerHeight();
            });

            // switch route inputed values
            $aaRoutePlannerContainer.find('.field-separator').off('click').on('click', function () {

                var $from = $aaRoutePlannerContainer.find('#fromPlace-1'),
                    $to = $aaRoutePlannerContainer.find('#toPlace-1'),
                    fromValue = $from.val(),
                    toValue = $to.val();

                $from.val(toValue);
                $to.val(fromValue);
            });

            // hide and clear location suggestions list when not in focus
            window.aa.helpers.cache.cachedElements.$document.on('mouseup touchend', function (e) {
                if (!$locationSuggestionsList.is(e.target) && $locationSuggestionsList.has(e.target).length === 0) {
                    hideLocationSuggestions();
                }
            });

            // set current location
            $trafficInfoContainer.find('.my-location').off('click').on('click', function (e) {
                e.preventDefault();
                getLocation();
            });

            // send location coordinates to server
            $setLocation.off('click').on('click', function (e) {

                e.preventDefault();

                // trigger validation on the form
                formValidation.api[$trafficInfoContainer.data('id')].validateForm();

                if ($trafficInfoContainer.hasClass('errors')) {
                    updateRoutePlannerHeight();
                    $trafficInfoContainer.find('.error').eq(0).find('input:first').focus();
                    return;
                }

                // set default location if chosen location is empty
                if ($locationInput.data('chosen-location') === '') {
                    populateFields(defaultLat, defaultLong, defaultLocation);
                    getTrafficNews();
                    return;
                }

                getLocationCoordinates(getTrafficNews);
            });
        }

        // search takeover toggle
        function toggleSearchTakeover() {

            var $searchInput = $searchTakeover.find('input').first();

            hideNavigation();

            if (client.oldIE || client.IE9) {
                $headerLinks.stop().fadeOut(250);
                $searchTakeover.stop().fadeIn(500);
                $searchInput.focus();
                return;
            }

            $searchInput.focus();
            $searchTakeover.stop().toggleClass('animated zoom-in');

            // slide down on mobile
            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                // hide navicon close text when search icon is clicked
                if ($primaryNavigation.is(':visible')) {
                    $('#navicon-close').addClass('hidden');
                    $('#navicon').removeClass('hidden');
                }

                window.aa.helpers.cache.cachedElements.$html.removeClass('no-overflow');

                hideNavigation();

                return;
            }

            // fade and zoom in
            $headerLinks.addClass('animated blur-out');
        }

        // close takeovers
        function closeTakeovers() {
            if (client.oldIE || client.IE9) {
                $bothTakeovers.stop().fadeOut(250);
                $headerLinks.stop().fadeIn(500);
                return;
            }

            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                if ($searchTakeover.hasClass('zoom-in')) {
                    $bothTakeovers.removeClass('zoom-in').addClass('zoom-out');
                }

                if ($bothTakeovers.hasClass('zoom-out')) {
                    setTimeout(function () {
                        $bothTakeovers.removeClass('animated zoom-out');
                    }, 250);
                }

                return;
            }

            // fade and zoom out
            $bothTakeovers.removeClass('zoom-in').addClass('zoom-out');

            if ($bothTakeovers.hasClass('zoom-out')) {
                setTimeout(function () {
                    $headerLinks.removeClass('blur-out').addClass('blur-in');
                    $bothTakeovers.removeClass('animated zoom-out');
                }, 250);
            }
        }

        $('#search-icon').on({
            click: toggleSearchTakeover
        });

        // route planner takeover
        $('#route-planner').on({
            click: toggleRoutePlanner
        });

        // aa route planner takeover
        $('#aa-route-planner').off('click').on({
            click: toggleAaRoutePlanner
        });

        // init traffic news
        $('.traffic-info').each(initTrafficNews);

        // prevent symbols from being entered into search input
        $('#search-takeover').find('input[type="text"]').on('keypress', function () {
            return /^[a-zA-Z0-9- ]*$/.test($(this).val());
        });

        // close takeovers
        $closeTakeover.on({
            click: closeTakeovers,
            keypress: function (e) {
                if (e.which === 13 || e.keyCode === 13) {
                    closeTakeovers();
                }
            }
        });

        // close aa route planner
        $closeAaTakeover.on({
            click: toggleAaRoutePlanner,
            keypress: function (e) {
                if (e.which === 13 || e.keyCode === 13) {
                    toggleAaRoutePlanner();
                }
            }
        });

        // close active takeover if esc key is pressed
        window.aa.helpers.cache.cachedElements.$document.on('keyup keypress', function (e) {

            if (e.which === 27) {

                if ($bothTakeovers.hasClass('zoom-in')) {
                    closeTakeovers();
                }

                if ($aaRoutePlannerTakeover.hasClass('active')) {
                    toggleAaRoutePlanner();
                }

                hideLocationSuggestions();
            }

            if (window.aa.helpers.cache.cachedElements.$body.find('.location-suggestions').children().length) {

                e.preventDefault();

                switch (e.which) {
                    case 13:
                    case 32:
                        window.aa.helpers.cache.cachedElements.$body.find('.location-suggestions').find('.place-active').trigger('click');
                        break;
                    case 40:
                    case 9:
                        navigateSuggestedPlaces(1);
                        break;
                    case 38:
                        navigateSuggestedPlaces(-1);
                        break;
                }
            }
        });

        // remove route planner on window resize
        window.aa.helpers.cache.cachedElements.$window.on('resize', function () {
            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                $routePlannerTakeover.addClass('hidden');

                if ($aaRoutePlannerTakeover.hasClass('active')) {
                    toggleAaRoutePlanner();
                }
            }
        });
    }

    // mobile navigation exists
    function detectMobileNavigation() {

        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            $primaryNavigation.removeClass('desktop-nav').addClass('mobile-nav');

        } else {
            $primaryNavigation.removeClass('mobile-nav').addClass('desktop-nav');
            $primaryNavigation.find('.primary-item').removeClass('menu-item-clicked');

        }
    }

    // update route planner height on resize
    function updateRoutePlannerHeight() {

        if ($aaRoutePlannerTakeover.hasClass('active')) {

            var routePlannerHeight = $aaRoutePlannerTakeover.css({ maxHeight: '100%' }).outerHeight();

            $aaRoutePlannerTakeover.css({ maxHeight: routePlannerHeight });
        }
    }

    // hide navigation events
    function hideNavigation() {
        $primaryNavigation.find('.active').removeClass('active');
        window.aa.helpers.cache.cachedElements.$body.add($primaryNavigation).removeClass('nav-open account-details-active');
        $('#navicon-close').addClass('hidden');
        $('#navicon').removeClass('hidden');
        $megaMenuContainer.parent('li').removeClass('active');

        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            $primaryNavigation.stop().slideUp(250);
        }

    }

    // mega menu dropdown
    function megaMenu() {

        var $primaryNavigationItem = $(this),
            $secondaryNavItem = $primaryNavigationItem.find('.secondary-item'),
            $secondaryItemsOverlay = $primaryNavigation.find('.second-level-nav-overlay'),
            $primaryNavigationItems = window.aa.helpers.cache.cachedElements.$body.find('.primary-item'),
            $megaMenu = $primaryNavigationItem.find('.mega-menu'),
            $navPanels = $primaryNavigationItem.find('.nav-panels'),
            $subComponents = $navPanels.find('.sub-component'),
            $myAccount = $header.find('#component-my-account');

        $megaMenu.css({ maxWidth: window.aa.helpers.cache.cachedElements.$window.width() });

        if ($myAccount.length) {
            $myAccount.closest('.primary-item').addClass('account-link');
        }

        function revealMegaMenu() {

            var $secondaryItem = $megaMenu.find('.secondary-item'),
                $secondaryNavPanels = $megaMenu.find('.nav-panels');

            if ($primaryNavigationItem.hasClass('has-children') && !$primaryNavigationItem.hasClass('active')) {

                if ($primaryNavigationItem.find('.my-aa-account').length) {
                    $navPanels.addClass('open');
                }

                if ($primaryNavigationItem.hasClass('account-link')) {
                    window.aa.helpers.cache.cachedElements.$body.addClass('account-details-active');
                }

                window.aa.helpers.cache.cachedElements.$body.addClass('nav-open');
                $primaryNavigationItems.removeClass('active');
                $primaryNavigationItem.addClass('active');

                if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $secondaryItem.removeClass('active');
                    $secondaryItem.filter(':first').addClass('active');
                    $secondaryNavPanels.removeClass('open');
                    $secondaryNavPanels.filter(':first-of-type').addClass('open');
                    if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.TABLET_BREAKPOINT) {
                        $secondaryItemsOverlay.show();
                    }
                }
            } else {
                window.aa.helpers.cache.cachedElements.$body.removeClass('nav-open account-details-active');
                $primaryNavigationItems.removeClass('active');
            }
        }

        function hideMegamenu() {
            clearTimeout(navDelayTimer);
            window.aa.helpers.cache.cachedElements.$body.removeClass('nav-open account-details-active');
            $primaryNavigationItems.add($secondaryNavItem).removeClass('active');
            $navPanels.removeClass('open');
        }

        function resetMegamenu() {
            hideMegamenu();
            $megaMenu.css({ height: 'auto' });
        }

        if ($megaMenu.length) {
            $primaryNavigationItem.addClass('has-children');
        }

        $('.editorial-panel').each(function () {
            $(this).closest('.nav-panels').addClass('editorial');
        });

        detectMobileNavigation();

        $primaryNavigationItem.on({
            click: function (e) {

                var $target = $(this),
                    isActive = $target.filter('.active');

                if ($primaryNavigationItem.hasClass('active')) {
                    if (!isActive.is(e.target) && isActive.has(e.target).length === 0) {
                        resetMegamenu();
                    }

                    return true;
                } else {

                    if (!$target.hasClass('has-children') || $target.hasClass('menu-item-clicked')) {
                        return true;
                    }
                    revealMegaMenu();
                    $megaMenu.css({ height: $target.find('.second-level-navigation').height() });
                }

                $(this).siblings('.primary-item').find('.nav-panels').removeClass('open');

                return false;
            }
        });

        $secondaryNavItem.on('mouseover click', function (e) {

            e.stopPropagation();

            var $element = $(this),
                targetId = $element.data('secondary'),
                $subComponent = $('#' + targetId).find('.sub-component');

            if ($('#' + targetId).hasClass('open') && window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                $subComponent.css({ minHeight: window.aa.helpers.getTallestHeightHelper($subComponent) });
            }

            if ($element.hasClass('active')) {
                if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.TABLET_BREAKPOINT) {
                    $secondaryItemsOverlay.show();
                }
                return true;

            } else {
                // momentary delay before revealing mega menu
                $secondaryNavItem.removeClass('active');
                $navPanels.removeClass('open');
                $element.addClass('active');
                $('#' + targetId).addClass('open');
            }
            return false;
        });

        // re-enable second level navigation events
        $secondaryItemsOverlay.off('mouseover').on('mouseover', function () {
            if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.TABLET_BREAKPOINT) {
                clearTimeout(navDelayTimer);

                navDelayTimer = setTimeout(function () {
                    $secondaryItemsOverlay.hide();
                }, 250);
            }
        });

        // disable second level navigation
        $navPanels.on('mouseover', function () {
            if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.TABLET_BREAKPOINT) {
                $secondaryItemsOverlay.show();
            }
        });

        // use nav item toggle icon to open/close mega menu
        $megaMenu.siblings('.toggle').on('click', function (e) {
            e.stopPropagation();

            if ($(this).parent('li').hasClass('active')) {
                hideMegamenu();
                $primaryNavigationItems.find('.nav-panels').removeClass('open');
            } else {
                revealMegaMenu();
            }
        });

        window.aa.helpers.cache.cachedElements.$document.on({
            click: function (e) {

                var $targetArea = $megaMenu.add($header);

                if (!$targetArea.is(e.target) && $targetArea.has(e.target).length === 0) {
                    hideMegamenu();
                    $primaryNavigationItems.find('.nav-panels').removeClass('open');
                }

            }
        });
    }

    // mobile mega menu dropdown
    function megaMenuMobile() {

        var $navicon = $('#navicon, #navicon-close'),
            $primaryItem = $primaryNavigation.find('.primary-item'),
            $secondaryItem = $primaryItem.find('.secondary-item'),
            $secondaryLevelNavigation = $primaryItem.find('.second-level-navigation'),
            $tertiaryLevelNavigation = $primaryItem.find('.nav-panels'),
            $backToPrimary = $primaryItem.find('.back-to-primary-link'),
            $backToSecondary = $primaryItem.find('.back-to-secondary-link'),
            $goToSecondary = $primaryItem.find('.mobile-toggle');

        function navToggle() {
            if ($primaryNavigation.hasClass('nav-open')) {
                navOpen();
            } else {
                navClose();
            }
        }

        function navOpen() {
            if ($tertiaryLevelNavigation.hasClass('active')) {
                $tertiaryLevelNavigation.stop().slideDown(250);
            } else if ($secondaryLevelNavigation.hasClass('active')) {
                $secondaryLevelNavigation.stop().slideDown(250);
            }
            $primaryNavigation.stop().slideDown(250);
        }

        function navClose() {
            if ($tertiaryLevelNavigation.hasClass('active')) {
                $tertiaryLevelNavigation.stop().slideUp(250, function () {
                    $primaryNavigation.stop().slideUp(250, function () {
                        $primaryItem.add($secondaryItem).add($secondaryLevelNavigation).add($tertiaryLevelNavigation).removeClass('active');
                        $(this).css({ left: '0' });
                    });
                });
            } else if ($secondaryLevelNavigation.hasClass('active')) {
                $secondaryLevelNavigation.stop().slideUp(250, function () {
                    $primaryNavigation.stop().slideUp(250, function () {
                        $primaryItem.add($secondaryItem).add($secondaryLevelNavigation).add($tertiaryLevelNavigation).removeClass('active');
                        $(this).css({ left: '0' });
                    });
                });
            } else {
                $primaryNavigation.stop().slideUp(250, function () {
                    $primaryItem.add($secondaryItem).add($secondaryLevelNavigation).add($tertiaryLevelNavigation).removeClass('active');
                    $(this).css({ left: '0' });
                });
            }

            window.aa.helpers.cache.cachedElements.$body.removeClass('account-details-active');
        }

        function slideMenuLevels($selector) {
            $secondaryLevelNavigation.add($tertiaryLevelNavigation).removeClass('active');

            if ($selector.hasClass('has-children') && $selector.hasClass('primary-item')) {
                $primaryNavigation.stop().animate({ left: '-100vw' }, 250);

                if ($selector.find('.my-aa-account').length) {
                    $selector.find('.nav-panels').addClass('open').show();
                    $primaryNavigation.stop().animate({ left: '-200vw' }, 250);

                } else {
                    $secondaryLevelNavigation.addClass('active').show();
                    $selector.addClass('menu-item-clicked').siblings().addClass('hide-items');
                    $primaryNavigation.animate({ left: '-100vw' }, 250);
                }
            } else if ($selector.hasClass('back-to-primary-link')) {

                $primaryNavigation.stop().animate({ left: '0' }, 250, function () {

                    window.aa.helpers.cache.cachedElements.$body.removeClass('account-details-active');

                    if ($selector.find('.my-aa-account').length) {
                        $selector.find('.nav-panels').removeClass('open').hide();

                    } else {
                        $secondaryLevelNavigation.removeClass('active').hide();
                    }

                });
            } else if ($selector.hasClass('secondary-item')) {
                $primaryNavigation.animate({ left: '-200vw' }, 250, function () {
                    $secondaryLevelNavigation.removeClass('active').hide();
                });
                $tertiaryLevelNavigation.addClass('active').show();
            } else if ($selector.hasClass('back-to-secondary-link')) {
                $primaryNavigation.stop().animate({ left: '-100vw' }, 250, function () {
                    $tertiaryLevelNavigation.removeClass('open').hide();
                });
                $secondaryLevelNavigation.addClass('active').show();
            }
        }

        $navicon.on('click', function (e) {
            e.stopImmediatePropagation();
            $navicon.toggleClass('hidden');
            window.aa.helpers.cache.cachedElements.$body.add($primaryNavigation).toggleClass('nav-open');
            $primaryItem.removeClass('menu-item-clicked').siblings().removeClass('hide-items');
            navToggle();
        });

        $goToSecondary.on('click', function () {
            $(this).parent().removeClass('menu-item-clicked').siblings().removeClass('hide-items');
        });

        $primaryItem.on('click', function () {
            slideMenuLevels($(this));
        });

        $backToPrimary.on('click', function (e) {
            e.stopPropagation();
            $primaryItem.removeClass('active menu-item-clicked').siblings().removeClass('hide-items');
            slideMenuLevels($(this));
        });

        $secondaryItem.on('click', function () {
            slideMenuLevels($(this));
        });

        $backToSecondary.on('click', function (e) {
            e.stopPropagation();
            $secondaryItem.removeClass('active');
            slideMenuLevels($(this));
        });

        window.aa.helpers.cache.cachedElements.$document.on({
            click: function (e) {

                if (!$header.is(e.target) && $header.has(e.target).length === 0 && window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    if ($primaryNavigation.is(':visible')) {
                        $navicon.toggleClass('hidden');
                        window.aa.helpers.cache.cachedElements.$body.add($primaryNavigation).removeClass('nav-open account-details-active');
                        navToggle();
                    }
                }
            }
        });

    }

    // my account login
    function myAccountLogin() {

        var $myAccount = $(this),
            $myAccountBtn = $myAccount.find('.button'),
            $myAccountMegaMenu = $myAccount.find('.account-nav'),
            $secondaryNavItem = $myAccountMegaMenu.find('h5'),
            $lastColumn = $myAccountMegaMenu.find('.col').last();

        function revealAccountMegaMenu() {
            $myAccount.addClass('active');

            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                $myAccountMegaMenu.stop().slideDown(500, function () {
                    $lastColumn.find('ul').stop().slideDown(250);
                });
            }

            if (client.IE9) {
                $myAccountMegaMenu.stop().fadeIn(200);
            }

        }

        function hideAccountMegaMenu() {
            $myAccount.add($myAccount.find('h5')).removeClass('active');

            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                $myAccountMegaMenu.add($myAccountMegaMenu.find('ul')).stop().slideUp(500, function () {
                    $lastColumn.find('ul').stop().slideUp(250);
                });
            }

            if (client.IE9) {
                $myAccountMegaMenu.stop().fadeOut(200);
            }

        }

        // close active navigation item
        function closeAccordionNav() {
            var $close = $(this);

            $close.on('click', function () {
                $close.parent().removeClass('active').siblings('ul').stop().slideUp(200);

                if (!$myAccount.hasClass('active')) {
                    $myAccountMegaMenu.stop().slideUp(250);
                }

            });
        }

        // hide mega menu when item is clicked
        $myAccountMegaMenu.find('li').click(hideAccountMegaMenu);

        // clicking (tapping) elsewhere on a page hides mega menu
        window.aa.helpers.cache.cachedElements.$document.on('mouseup touchend', function (e) {
            if (!$myAccount.is(e.target) && $myAccount.has(e.target).length === 0) {
                hideAccountMegaMenu();
            }
        });

        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {

            // apply class if mega menu is found
            if ($secondaryNavItem.siblings('ul').length) {
                $secondaryNavItem.addClass('has-children');
            }

            // activate and open my account mega menu
            $myAccountBtn.on('click', function () {
                $myAccount.toggleClass('active');

                if ($myAccount.hasClass('active')) {
                    revealAccountMegaMenu();
                } else {
                    hideAccountMegaMenu();
                }

            });

            // activate and open mega menu
            $secondaryNavItem.children('a').on('click', function (e) {

                var $anchorParent = $(this).parent(),
                    $anchorParentSiblings = $anchorParent.parent().siblings().children('h5');

                // prevent first click going to link
                if (!$anchorParent.hasClass('active')) {
                    e.preventDefault();
                }

                $anchorParent.toggleClass('active').siblings('ul').stop().slideDown(250, function () {
                    $anchorParentSiblings.removeClass('active').siblings().stop().slideUp(250);
                });

            });

            $myAccount.find('.close').each(closeAccordionNav);

            $lastColumn.prependTo($myAccountMegaMenu).find('h5').remove();

            return;
        }

        // reveal mega menu on hover
        $myAccount.hover(revealAccountMegaMenu, hideAccountMegaMenu);

        // use the tab key to focus on navigation items
        window.aa.helpers.cache.cachedElements.$document.on({
            keyup: function (e) {
                if (e.which === 9 || e.keyCode === 9) {
                    if ($myAccountBtn.is(e.target)) {
                        revealAccountMegaMenu();
                    } else {
                        hideAccountMegaMenu();
                    }
                }
            }
        });

    }

    // sign in panel overlay
    function signInPanel() {

        var $signInPanel = $('#sign-in-panel'),
            $signInPanelOverlay = $('#sign-in-overlay'),
            $main = $signInPanel.closest('#main'),
            $mainAndFooter = $main.add($main.siblings('#site-footer'));

        // panel toggle reveal/hide
        function toggleSignInPanel() {

            $signInPanel.add($signInPanelOverlay).toggleClass('active');

            // fade fallback for IE9
            if (client.IE9) {
                $signInPanel.add($signInPanelOverlay).stop().fadeToggle(250);
                return;
            }

            $header.find('.active').removeClass('active');
            window.aa.helpers.cache.cachedElements.$body.removeClass('nav-open account-details-active');
            $mainAndFooter.removeClass('blur-in-half').toggleClass('blur-out-half');
            $mainAndFooter.add($mainAndFooter.children().not($signInPanel, $signInPanelOverlay)).attr('aria-hidden', 'true');

        }

        // hide panel
        function hideSignInPanel() {

            $signInPanel.add($signInPanelOverlay).removeClass('active');

            // fade fallback for IE9
            if (client.IE9) {
                $signInPanel.stop().fadeOut(250);
                $signInPanelOverlay.stop().fadeOut(250);
                return;
            }

            $mainAndFooter.removeClass('blur-out-half').addClass('blur-in-half');
            $mainAndFooter.add($mainAndFooter.children().not($signInPanel, $signInPanelOverlay)).attr('aria-hidden', 'false');

        }

        $('#close-panel, .sign-in').on({
            click: function (e) {
                e.preventDefault();

                toggleSignInPanel();
            }

        });

        window.aa.helpers.cache.cachedElements.$document.on({
            mouseup: function (e) {
                // if the target of the click isn't the panel, nor a descendant of the panel, nor the scrollbar
                if (!$signInPanel.is(e.target) && ($signInPanel.has(e.target).length === 0) && (e.target !== window.aa.helpers.cache.cachedElements.$html.get(0))) {
                    hideSignInPanel();
                }
            },
            keyup: function (e) {
                if (e.which === 27 || e.keyCode === 27) {
                    hideSignInPanel();
                }
            }
        });
    }

// PP Jquery upgrade
//    window.aa.helpers.cache.cachedElements.$document.on({
//        ready: function () {
      window.aa.helpers.cache.cachedElements.$document.ready(
          function() {
//console.log('Jquery upgrade of document.on( ready');
            if ($('#cookie-bar').length) {
                cookieLaw();
            }

            $('.takeover, .aa-route-planner-container').each(headerTakeovers);

            $('#primary-navigation .container > ul').children('.primary-item').each(megaMenu);

            if ($('#navicon').length && $primaryNavigation.length && window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                megaMenuMobile();
            }

            if ($('.sign-in').length) {
                signInPanel();
            }

            $('.my-account').each(myAccountLogin);
        //}
    });

    window.aa.helpers.cache.cachedElements.$window.on({
        resize: function () {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function () {

                $secondLevelNavigation = $primaryNavigation.find('.primary-item.active .second-level-navigation');

                if ($primaryNavigation.length) {
                    detectMobileNavigation();
                }

                if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    megaMenuMobile();
                }

                updateRoutePlannerHeight();

                $megaMenuContainer.css({ maxWidth: window.aa.helpers.cache.cachedElements.$window.width(), height: $secondLevelNavigation.height() });
            }, 100); // call on resize end
        },
        scroll: function () {
            if ($header.length) {

                stickyHeader();
                if (($('#sales-journey-header').hasClass("sticky")) && ($("#contact-cta").hasClass('dsf-view-none'))) {
                    $('#CancelSalesLabel').css('margin-right', '13rem');
                    $("#BackToDashboard").css({ "margin-right": "13rem", "margin-left": "-30px" });
                }
                else {
                    $('#CancelSalesLabel').css('margin-right', '2.5rem');
                    $("#BackToDashboard").css({ 'margin-right': '2.5rem', 'margin-left': '0px' });
                }


            }

        }
    });
})(jQ);
</script><script src="/Assets/scripts/libs/jquery.mCustomScrollbar.concat.min.js      "></script>

<script>
/*
 * ---------------------------------------- *
 * Name: 	AA Hospitality JavaScripts      *
 * Type: 	JavaScript                      *
 * Version: Not Versioned                   *
 * Author:	Aleksander Kisimov | Codehouse  *
 * ---------------------------------------- *
 */
window.aa || (window.aa = {}); //  aa namespace

window.aa.hospitality = {
    
    // functionality for filters & applied filters section
    globalBoolean: (new function () {
        this.searchButtonPressed = false;
    }()),
    searchFilters: function searchFilters() {
        var $appliedFilters = $(this),
            $filterGroupId = $appliedFilters.find('div[data-filter]'),
            $filterGroup = $appliedFilters.siblings('.filter-group'),
            $appliedFiltersCounter = $appliedFilters.find('.counter'),
            $clearFiltersButton = $appliedFilters.find('.clear-filters'),
            $noFiltersAppliedMessage = $appliedFilters.find('.no-filters');

        // show group heading if there are matched checkboxes
        $filterGroupId.each(function () {
            $appliedFilters.find('h5[data-filter="' + $(this).data('filter') + '"]').show();
        });

        if ($filterGroupId.length) {
            $appliedFilters.add($clearFiltersButton).show();
            $noFiltersAppliedMessage.hide();
        }

        // update counter of filters
        $appliedFiltersCounter.text($appliedFilters.find('.field').length);

        // clear filters
        $clearFiltersButton.on('click', function (e) {
            e.preventDefault();
            $appliedFilters.find('input:checked').trigger('click');
        });

        // clear corresponding property type filter
        $appliedFilters.find('input[data-id]').on('click', function () {
            $filterGroup.find('#' + $(this).data('id')).trigger('click');
        });

        window.aa.hospitality.globalBoolean.searchButtonPressed = false;

        // clear establishmentType hidden input if "type" filter is cleared
        $filterGroup.find('input.establishment-type').on('change', function () {
            if (!$(this).is(':checked') && !window.aa.hospitality.globalBoolean.searchButtonPressed) {
                $filterGroup.closest('.listing').find('#find-place').val('');
                $filterGroup.closest('.listing').find('.establishment-type').val('');
            }
        });
    },
    cropThumbnails: function ($image) {
        //BAU-AMD-222-starts//
        if ($(".cat-count").length > 1) {
            $("#cat-header").show();
        }
        else {
            $("#cat-header").hide();
        }
        //BAU-AMD-222-Ends//
        var $imageContainer = $image.closest('div'),
            image = new Image();

        image.src = $image.prop('tagName') === 'image' ? $image.attr('xlink:href') : $image.attr('src');

        image.onload = function () {
            if (image.naturalHeight > image.naturalWidth) {
                $imageContainer.addClass('portrait-orientation');
            }
        }
    }
};

(function ($) {

    var resizeTimer;
    //BAU-AMD-222-starts//
    $("#cat-header").hide();
    //BAU-AMD-222-ends//
    // determine the size of font based on establishment name length
    function establishmentNameRestriction($thisEstablishment) {

        var $establishmentName = $thisEstablishment.find('.est-name'),
            $establishmentNameString = $establishmentName.children('p').text();

        $establishmentName.removeClass('midlength-title short-title');

        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && $establishmentNameString.length <= 46 && $establishmentNameString.length > 24) {
            $establishmentName.addClass('midlength-title');
        } else if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && $establishmentNameString.length <= 46 || window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && $establishmentNameString.length <= 24) {
            $establishmentName.addClass('short-title');
        }
    }

    // scroll between tweets
    function scrollTweets() {

        var $thisTwitterFeed = $(this),
            $tweet = $thisTwitterFeed.find('.tweet'),
            $tweetsContainer = $thisTwitterFeed.find('.tweets-container').children(),
            totalTweets = $tweetsContainer.length,
            tweetIndex = $tweet.index();

        // set the latest tweet to active
        $tweet.first().addClass('active');

        // display tweet based on active class
        function activeTweet() {
            $tweetsContainer.removeClass('active');
            $tweetsContainer.eq(tweetIndex).addClass('active');
        }

        // select next tweet
        $thisTwitterFeed.find('.tweet-next').on('click', function () {
            tweetIndex = tweetIndex + 1 > totalTweets - 1 ? 0 : tweetIndex + 1;
            activeTweet();
        });

        // select previous tweet
        $thisTwitterFeed.find('.tweet-prev').on('click', function () {
            tweetIndex = tweetIndex - 1 < 0 ? totalTweets - 1 : tweetIndex - 1;
            activeTweet();
        });
    }

    // truncate text & read more
    function truncationReadMore() {
        var $thisText = $(this),
            $readMore = $thisText.find('.read-more'),
            ellipses = '...',
            characterNr = window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT ? 420 : 690,
            $richText = $thisText.find('.rich-text').find('p'),
            shortText = window.aa.helpers.truncateText($richText.text(), characterNr),
            fullText = $thisText.find('.rich-text').find('p').text().trim();

		if($readMore!=undefined && $readMore.length > 0)
		{
			/*CD-4683 Fix */
			mbText = $thisText.find('.rich-text').hasClass('mem-ben');

			if (!shortText) {
				return;
			}
			if (mbText) {
				return;
			}

			$richText.text(shortText + ellipses);
			$readMore.removeClass('hidden');

			function readMore() {
				$readMore.addClass('hidden');
				$richText.text('');
				$richText.append(fullText);
				$richText.addClass('height');
			}

			$readMore.on('click', readMore);
		}
    }

    // review bar filled based on value
    function reviewBar() {
        var $thisReviewBar = $(this),
            $fullBar = $thisReviewBar.find('.full-bar'),
            reviewValue = $thisReviewBar.find('.review-value').text();

        $fullBar.css({ width: reviewValue * 10 + '%' });

        if (parseInt(reviewValue) < 5) {
            $fullBar.addClass('grey-rating');
        }

    }

    // hospitality show search result card
    function toggleSearchCard(listing) {

        var $thisListing = listing;

        function toggle(e) {
            var $thisCategory = $(this);
            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                e.stopImmediatePropagation();
                $thisCategory.siblings('.search-results').stop().slideToggle();
                $thisCategory.siblings('.search-results').toggleClass('active');
                $thisCategory.find('.arrow').toggleClass('flipped');
                $thisListing.find('.see-all.paginate').stop().toggle();
            }
        }

        $thisListing.on('click', '.category-title', toggle);
    }

    // fixed sidebar position when scrolling relative to parent height
    function fixedSidebar() {
        var $thisRowParent = $(this),
            $sidebarColumn = $(this).find('.col:last-child'),
            thresholdHeight = $thisRowParent.parent().prev().outerHeight();

        if ($thisRowParent.find('.sidebar-container').length === 0) {
            $sidebarColumn.wrap('<div class="sidebar-container"> </div>');
        }

        function stickyScrollbar() {
            
         
            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.TABLET_LANDSCAPE) {
                $sidebarColumn.removeClass('fixed');
            } else {
                var maxHeight = $thisRowParent.height() - $sidebarColumn.height() + thresholdHeight;
                //enable sticky sidebar when user scrolls past treshholdHeight
                if (window.aa.helpers.cache.cachedElements.$window.scrollTop() >= thresholdHeight) {
                    $sidebarColumn.addClass('fixed');
                } else {
                    $sidebarColumn.removeClass('fixed');
                }
                //disable sticky sidebar when maxHeight is reached
                if (window.aa.helpers.cache.cachedElements.$window.scrollTop() >= maxHeight) {
                    $sidebarColumn.addClass('bottom');
                } else {
                    $sidebarColumn.removeClass('bottom');
                }
            }
        }

        stickyScrollbar();

        window.aa.helpers.cache.cachedElements.$window.on('scroll', function () {
            //Start MEM-92
            if ($('#codeNotAvailableModal').length > 0) {
                return false;
            }
               //End MEM-92
            stickyScrollbar();
        });
    }

    function searchInputs() {
        var $thisContainer = $(this),
            $inputsParent = $thisContainer.closest('.inputs'),
            $input = $thisContainer.find('input[type="text"]'),
            $inputBorder = $thisContainer.find('.stylish-text span'),
            $findDestination = $inputsParent.find('#find-destination'),
            $findPlace = $inputsParent.find('#find-place'),
            $clearButton = $thisContainer.find('button.clear-input'),
            results = $thisContainer.find('input[type="hidden"]').val(),
            $establishmentTypeData = $thisContainer.find('.establishment-type'),
            $termData = $thisContainer.find('.data-term'),
            $listing = $thisContainer.closest('.listing'),
            $searchComponentSubmit = $inputsParent.siblings('.search-inputs input[type="submit"].search-component-submit'),
            $searchType = $listing.find('.is-search'),
            placeholderText = $input.attr('placeholder'),
            isSelected = false,
            isLocationAvailable = true,
            inputBlurred = false,
            isFirstSearch,
            serverRequest;

        // if mobile populate destination field on load, otherwise if query string is found
        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            if ($findDestination.val() === '') {
                populateLocation($findDestination);
            }
        } else if ($findDestination.val() === '' && window.location.search) {
            populateLocation($findDestination);
        }

        // find whether locations services are available on load and change suggested default result
        navigator.geolocation.getCurrentPosition(function () {
            // on success event handled elsewhere when the user selects a suggestion generated from autocomplete
            return;
        }, function () {
            // on failure event is needed on load to determine the destination suggestion coming from the markup
            $inputsParent.find('.find-destination-hidden').attr('data-label', $inputsParent.find('.location').data('label')).val($inputsParent.find('.location').data('label'));
            $inputsParent.find('.input.destination').addClass('location-unavailable');
            isLocationAvailable = false;
        });

        // find the correct data to populate data-to-send hidden input with
        function populateDataToSend(input, ui) {
            if (input.is('#find-place') && ui.item !== null) {
                if (typeof $('[data-input-id="' + ui.item.label + '"]').data('to-send') === 'undefined') {
                    $termData.val(ui.item.label);
                    $establishmentTypeData.val('');
                } else {
                    $establishmentTypeData.val($('[data-input-id="' + ui.item.label + '"]').data('to-send'));
                }
            } else {
                $termData.val(input.val());
                $establishmentTypeData.val('');
            }

        }

        // store response object according to type
        function buildArray(data, request, callback) {
            var termsData = [],
                label;

            for (var prop in data.Result) {
                // label is either the establishment name or location depending on response
                label = typeof data.Result[prop].EstablishmentName !== 'undefined' ? data.Result[prop].EstablishmentName : data.Result[prop].Description;
                termsData.push({ 'label': label, 'city': data.Result[prop].City, 'placeId': data.Result[prop].PlaceId, 'highlight': data.Result[prop].Highlight, 'url': data.Result[prop].Url });
            }

            // get results from array and filter
            results = $.ui.autocomplete.filter(termsData, request.term);
            if (typeof callback === 'function') {
                callback(results);
            }
        }

        // autocomplete
        $input.autocomplete({
            appendTo: $thisContainer,
            minLength: 0,
            create: function () {
                $(this).data('ui-autocomplete')._renderItem = function (ul, item) {

                    // custom markup
                    function buildListItem() {
                        var markup = [];

                        if ($input.val().length < 3) {
                            markup.push('<span class="icon">' + item.label + ' </span>');
                        } else {
                            markup.push('<span class="establishment-result">' + item.highlight + '</span>');

                            if (typeof item.city !== 'undefined') {
                                markup.push('<span class="location-result">' + item.city + ' </span>');
                            }
                        }
                        return markup.join('');
                    }
                    // wrap typed letters in list for styling
                    if (typeof item.url !== 'undefined') {
                        return $('<a href="' + item.url + '" data-value="' + item.label + '"></a>').data('item.autocomplete', item).html(buildListItem()).appendTo(ul);
                    } else {
                        return $('<li data-value="' + item.label + '"></li>').data('item.autocomplete', item).html(buildListItem()).appendTo(ul);
                    }

                };
            },
            source: function (request, response) {

                if (inputBlurred) {
                    return;
                }

                // reset the results value
                var results = [];

                // get results from a hidden input if input value is empty
                if (request.term.length < 3) {
                    isFirstSearch = true;

                    $thisContainer.find('input[type="hidden"].lookup').each(function () {
                        results.push($(this).val());
                    });

                    response(results);
                    return;
                }

                isFirstSearch = false;
                isSelected = false;

                // prevent calls from stacking due to constant search
                if (typeof serverRequest !== 'undefined') {
                    serverRequest.abort();
                }

                serverRequest = $.ajax({
                    method: $input.data('request-method'),
                    url: $input.data('autocomplete-url'),
                    dataType: 'json',
                    data: { searchText: request.term },
                    success: function (data) {
                        buildArray(data, request, response);
                        if ($input.val() !== '') {
                            $clearButton.show();
                        }
                    }
                });
            },
            select: function (e, ui) {
                isSelected = true;
                populateLocation($(this), ui);
                autoSearch($(this), ui);
            },
            change: function (e, ui) {
                if (!isSelected) {
                    populateLocation($(this), ui);
                }
                populateDataToSend($(this), ui);
            }
        });

        function autoSearch(input, ui) {
            populateDataToSend(input, ui);

            if (input.attr('id') === 'find-destination' && $findPlace.val() === '') {
                // clear call stack causing original input to be refocused
                setTimeout(function () {
                    $findPlace.focus();
                });
            } else if (input.attr('id') === 'find-place' && $findDestination.val() === '' || (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && $findDestination.hasClass('auto-populated'))) {
                // clear call stack causing original input to be refocused
                setTimeout(function () {
                    $findDestination.focus();
                });
                return;
            } else if ((window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) && ($findDestination.val() !== '' && $findPlace.val() !== '')) {
                setTimeout(function () {
                    $findDestination.add($findPlace).blur();
                });
            }

            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && ((input.attr('id') === 'find-destination' && $findPlace.val() !== '') || input.attr('id') === 'find-place' && $findDestination.val() !== '')) {
                $searchType.val('true');
                submit();
                $input.blur();
            }

            // remove auto-populated class if user started typing in find-desination input 
            if (aa.helpers.cache.cachedElements.$window.width() > aa.helpers.cache.constants.MOBILE_BREAKPOINT && input.attr('id') === 'find-destination') {
                $input.on('keypress', function () {
                    $(this).removeClass('auto-populated');
                });
            }

        }

        function populateLocation(input, ui) {
            // trigger geolocation in find destination input
            if (input.attr('id') === 'find-destination') {
                if (input.val() === '') {
                    findLocation();
                    return;
                }
                populateFields('', '', ui.item === null ? input.val() : ui.item.label, ui.item === null ? '' : ui.item.placeId);
            }
        }

        function populateFields(lat, long, location, placeId) {
            $inputsParent.find('.latitude').val(lat);
            $inputsParent.find('.longitude').val(long);
            $inputsParent.find('.location').val(location);
            $inputsParent.find('.place-id').val(placeId);
        }

        function findLocation() {
            function showPosition(position) {
                populateFields(position.coords.latitude, position.coords.longitude, '', '');
                $findDestination.val($inputsParent.find('.find-destination-hidden').data('label'));
            }

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                showError();
            }

            function showError(error) {
                switch (error.code) {
                    case error.PERMISSION_DENIED:
                    case error.POSITION_UNAVAILABLE:
                    case error.TIMEOUT:
                    case error.UNKNOWN_ERROR:
                        populateFields('', '', 'London', 'ChIJdd4hrwug2EcRmSrV3Vo6llI');
                        $findDestination.val($inputsParent.find('.location').data('label'));
                        if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                            $findDestination.addClass('auto-populated');
                        }
                        break;
                }
            }
        }
        // submit
        function submit() {
            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && ($input.is('#find-destination') && $findPlace.val() === '')) {
                $findPlace.focus();
                return;
            }

            $inputsParent.find('.lookup-radius').val('');
            $searchType.val('true');

            if ($findDestination.val() === '') {
                populateLocation($findDestination);
            }

            // clear filters
            window.aa.hospitality.globalBoolean.searchButtonPressed = true;
            $listing.find('.filters-applied').find('input:checked').trigger('click');

            //clear callstack
            setTimeout(function () {
                $listing.trigger('getResults');
            });
        }

        // event fires twice, unbind previous iteration
        $inputsParent.siblings('.search-inputs input[type="submit"].search-establishments').off('click').on('click', function (e) {
            e.preventDefault();
            submit();
        });

        // hospitality search input component redirect & initial search parameters appended to query string
        $searchComponentSubmit.off('click').on('click', function (e) {
            var searchParameters = [];

            e.preventDefault();

            $inputsParent.find('.data-to-redirect').each(function () {
                var $thisInput = $(this);

                if ($thisInput.val() !== '') {
                    searchParameters.push((searchParameters.length ? '&' : '?') + $thisInput.attr('name') + '=' + $thisInput.val());
                }
            });

            if ($findDestination.val() === '') {
                populateLocation($findDestination);
            }

            window.location = $(this).data('url') + searchParameters.join('');

        });

        // prevent symbols from being entered into search inputs
        $('#find-place').add($('#find-destination')).on({
            keypress: function (e) {
                // allow backspace in firefox
                if (e.which === 8) {
                    return true;
                }
                return /^[a-zA-Z0-9-',. ]*$/.test($(this).val());
            },
            paste: function (e) {
                // allow backspace in firefox
                if (e.which === 8) {
                    return true;
                }
                return /^[a-zA-Z0-9-',. ]*$/.test(e.originalEvent.clipboardData.getData('text'));
            }
        });

        $clearButton.on('mousedown', function (e) {
            e.preventDefault();
            isSelected = true;
            $input.val('');
            $input.closest('.input').find('input[type="hidden"]').not('.lookup').val('');
            $clearButton.hide();
            $input.trigger('blur');
        });

        $input.on({
            focus: function () {
                if ($input.hasClass('auto-populated')) {
                    isSelected = true;
                    $input.val('');
                    $input.closest('.input').find('input[type="hidden"]').not('.lookup').val('');
                    $input.removeClass('auto-populated');
                }

                if (window.aa.helpers.cache.cachedElements.$window.width() < window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && $input.is('#find-place') && $findDestination.val() === '') {
                    populateLocation($findDestination);
                }

                inputBlurred = false;

                $inputBorder.addClass('active');
                $input.attr('placeholder', '');

                if ($input.val() !== '') {
                    $clearButton.show();
                }

                // only prepopulate and show autocomplete if on tablet or desktop and if the lookup input value isn't equal to the prepopulated input value
                if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && $(this).val() === $thisContainer.find('input[type="hidden"].find-destination-hidden.lookup').val()) {
                    return;
                }

                $(this).autocomplete('search', $(this).val());

            },
            blur: function () {
                $inputBorder.removeClass('active');
                $input.attr('placeholder', placeholderText);
                $clearButton.hide();
                inputBlurred = true;
            },
            keypress: function (e) {
                if (e.which === 13) {
                    if ($input.closest('.establishment-search-page').hasClass('search-field-component')) {
                        $input.trigger('blur'); // blur input to update hidden inputs with search parameters before redirecting to the search results page
                        $searchComponentSubmit.trigger('click');
                    }
                    e.preventDefault();
                    if ($input.is('#find-destination') && !isLocationAvailable && $input.val() === '') {
                        return;
                    }
                    $input.blur();
                    submit();
                }
            },
            keydown: function (e) {
                if ($input.hasClass('auto-populated') && (e.which === 8 || e.which === 46)) {
                    $input.removeClass('auto-populated');
                }
            }
        });
    }

    // filters functionality for mobile
    function searchFiltersMobile() {
        var $thisSortBy = $(this),
            $relativeWrapper = $thisSortBy.closest('.wrapper.results'),
            // caching window width to compare later on and make sure hideFilters does not get executed on window.resize
            windowWidth = window.aa.helpers.cache.cachedElements.$window.width(),
            $searchFilters = $thisSortBy.siblings('.search-filters').find('.refine-results');

        function hideFilters() {
            $searchFilters.fadeOut('fast', function () {
                $relativeWrapper.removeClass('filters-visible');
            });
        }

        $thisSortBy.on('click', '.sort-button', function (e) {
            e.preventDefault();
            $thisSortBy.find('label[for="hospitality-sort-by"]').trigger('click');
        });

        $searchFilters.on('change', 'input', function () {
            $(this).toggleClass('filter-pending');
        });

        $thisSortBy.on('click', '.filter-button', function (e) {
            e.preventDefault();
            $relativeWrapper.addClass('filters-visible');
            $searchFilters.fadeIn('fast');
        });

        $searchFilters.on('click', '.close-filters', function () {
            var $pendingInput = $searchFilters.find('input.filter-pending');

            if ($pendingInput.is(':checked')) {
                $pendingInput.prop('checked', false).trigger('change');
            } else {
                $pendingInput.trigger('click');
            }
            hideFilters();
        });

        $searchFilters.on('click', '.apply-filters', function () {
            $searchFilters.find('.filter-pending').removeClass('filter-pending');
            hideFilters();
        });

        window.aa.helpers.cache.cachedElements.$window.on('resize', function () {
            // change of window.height triggers window.resize // cached windowWidth variable helps discern whether height or width has changed - only executing the code on width change
            if (window.aa.helpers.cache.cachedElements.$window.width() !== windowWidth && window.aa.helpers.cache.cachedElements.$window.width() < window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                hideFilters();
                windowWidth = window.aa.helpers.cache.cachedElements.$window.width();
            }
        });
    }

    // link see all results buttons to category buttons
    function selectCategory(listing) {
        var $listing = listing,
            categoryId;

        $listing.on('click', 'button[data-id]', function () {
            categoryId = $(this).data('id');
            window.aa.helpers.cache.cachedElements.$body.add(window.aa.helpers.cache.cachedElements.$html).animate({ scrollTop: '0' });
            $listing.find('#categories input[data-see-all-id="' + categoryId + '"]').trigger('click');
        });
    }

    // view bottom of footer on tablet when booking widget is fixed to bottom of page, otherwise remove padding
    function bookingWidgetSize() {
        if (aa.helpers.cache.cachedElements.$window.width() <= aa.helpers.cache.constants.TABLET_LANDSCAPE) {
            aa.helpers.cache.cachedElements.$body.css({ paddingBottom: $(this).innerHeight() });
        } else {
            aa.helpers.cache.cachedElements.$body.css({ paddingBottom: 0 });
        }
    }

// PP Jquery upgrade    window.aa.helpers.cache.cachedElements.$document.on({
//        ready: function () {
      window.aa.helpers.cache.cachedElements.$document.ready(
          function() {
//console.log('Jquery hospitality-js upgrade of document.on( ready');
            //BAU-AMD-222-starts//
            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                $("#refineResults").hide();
            }
             else {
                $("#refineResults").show();
            }
            //BAU-AMD-222-ends//
            $('.twitter-feed').each(scrollTweets);
            $('.detail-header').each(function () {
                var $detailHeader = $(this);

                establishmentNameRestriction($detailHeader);
                window.aa.hospitality.cropThumbnails($detailHeader.find('.header-thumbnail img'));
                window.aa.hospitality.cropThumbnails($detailHeader.find('svg image'));
            });
            $('.review-bar').each(reviewBar);
            $('.establishment-info').each(truncationReadMore);
            $('.input').each(searchInputs);
            $('.listing').each(function () {
                selectCategory($(this));
                toggleSearchCard($(this));
            });
            $('.sort-by-container').each(searchFiltersMobile);
            $('.booking-widgets').each(bookingWidgetSize);
            $('.related-results').find('.result').each(function () {
                window.aa.hospitality.cropThumbnails($(this).find('img'));
            });
        //}
    });
    window.aa.helpers.cache.cachedElements.$window.on({
        load: function () {
            $('.row-with-sidebar').each(fixedSidebar);
        },
        resize: function () {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function () {
                $('.detail-header').each(function () {
                    establishmentNameRestriction($(this));
                });
                $('.row-with-sidebar').each(fixedSidebar);
                $('.booking-widgets').each(bookingWidgetSize);
            }, 100);
        }
    });
    
    
})(jQ);
</script><script src="/Assets/scripts/hospitality-listing.js                          "></script>
<script>

/* 
 * ---------------------------------------- *
 * Name:    Image Gallery JavaScripts       *
 * Type: 	JavaScript                      *
 * Version: Not Versioned                   *
 * Author:	Codehouse                       *
 * ---------------------------------------- *
 */

(function ($) {

    var lightboxTimer;

    // gallery functionality based on number of images
    function imageGallery() {

        var $thisLightboxGallery = $(this),
            $rowParent = $thisLightboxGallery.closest('.row-with-sidebar'),
            $imagesContainer = $thisLightboxGallery.find('.image-gallery'),
            $lightboxCarousel = $thisLightboxGallery.find('.lightbox-carousel'),
            $lightboxOverlay = $thisLightboxGallery.find('.lightbox-overlay'),
            imageCounter = $imagesContainer.find('.gallery-image').length,
            imageIndex = $lightboxCarousel.find('.active').index(),
            $totalImages = $thisLightboxGallery.find('.counter').find('span'),
            $presentedImageContainer = $thisLightboxGallery.find('.presented-image'),
            galleryActiveClassCounter = imageIndex,
            $scrollArea = $thisLightboxGallery.find('.scroll-bar'),
            $showListOfImages = $thisLightboxGallery.find('.show-list'),
            $showMoreText = $showListOfImages.find('.list'),
            $gallerySlide = $lightboxCarousel.find('.gallery-slide'),
            $filmStrip = $thisLightboxGallery.find('.film-strip'),
            $lightboxControls = $thisLightboxGallery.find('.lightbox-next, .lightbox-prev'),
            $activeGallerySlide,
            filmStripHidden = false,
            dir = {
                next: function () {
                    galleryActiveClassCounter = galleryActiveClassCounter + 1 > imageCounter - 1 ? 0 : galleryActiveClassCounter + 1;
                },
                prev: function () {
                    galleryActiveClassCounter = galleryActiveClassCounter - 1 < 0 ? imageCounter - 1 : galleryActiveClassCounter - 1;
                }
            };

        // toggle film strip
        function toggleCarousel() {
            $lightboxCarousel.toggleClass('hidden');
            $showListOfImages.toggleClass('flipped');
            $showMoreText.toggleClass('hide-text');
            $thisLightboxGallery.find('.lightbox-prev').add('.lightbox-next').toggleClass('hidden-arrows');
            filmStripHidden = !filmStripHidden;
        }

        // set the counter to appropriate index and change active class
        function activeClassLogic() {

            var $gallerySlideChildren = $gallerySlide.children();

            // update active class
            $gallerySlideChildren.removeClass('active');
            $gallerySlideChildren.eq(galleryActiveClassCounter).addClass('active');
            $activeGallerySlide = $gallerySlideChildren.filter('.active');

            // update scrollbar
            $scrollArea.stop().animate({ scrollLeft: Math.floor($activeGallerySlide.innerWidth() * $activeGallerySlide.index()) }, 150);

            // update total images in lightbox
            $totalImages.text($activeGallerySlide.index() + 1 + ' /' + imageCounter);

            // update the main presented image in lightbox
            updateMainImage();
        }

        function updateMainImage() {
            var $presentedImage = $presentedImageContainer.find('img');
            var $presentedImageText = $presentedImageContainer.find('p');
            if ($presentedImage.length > 0) {
                $presentedImage.removeClass('active-image').stop().fadeOut(100);
                $presentedImageText.removeClass('active-image').stop().fadeOut(100);
            }
            $presentedImageContainer.append($activeGallerySlide.find('img').clone().addClass('active-image').stop().fadeIn(100, function () {
                $presentedImage.not('.active-image').remove();
            }));
            $presentedImageContainer.append($activeGallerySlide.find('div.img-text').clone().addClass('active-image').stop().fadeIn(100, function () {
                $presentedImageText.not('.active-image').remove();
            }));

        }

        // close lightbox
        function closeLightbox() {
            $lightboxOverlay.fadeOut('fast');
            window.aa.helpers.cache.cachedElements.$body.off('scroll touchmove mousewheel', preventScrolling);
            window.aa.helpers.cache.cachedElements.$footer.removeClass('hide-footer');
            $('#site-wrapper').removeClass('background');
            $presentedImageContainer.empty();
            $rowParent.removeClass('lightbox-visible');

            if (filmStripHidden === true) {
                toggleCarousel();
            } else {
                clearTimeout(lightboxTimer);
            }
        }

        // used to prevent scrolling on body while lightbox is active
        function preventScrolling(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        // show/hide film strip
        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.TABLET_LANDSCAPE) {
            $showListOfImages.on('click', function () {
                if (filmStripHidden === false) {
                    clearTimeout(lightboxTimer);
                }
                toggleCarousel();
            });
        } else {
            $filmStrip.hover(function () {
                if (filmStripHidden === false) {
                    clearTimeout(lightboxTimer);
                } else {
                    toggleCarousel();
                }
            }, toggleCarousel);
        }

        if ($rowParent.length && aa.helpers.cache.cachedElements.$main.find('.detail-header').length) {
            $imagesContainer.addClass('establishment-gallery');
        }

        // lightbox trigger
        $thisLightboxGallery.find('.lightbox-trigger, .full-width').on('click', function (e) {
            var $image = $(this),
                $thumbnailImage = $gallerySlide.find('.gallery-image');

            e.preventDefault();

            $rowParent.addClass('lightbox-visible');

            if ($image.parent().hasClass('main-image') || $image.hasClass('full-width')) {
                galleryActiveClassCounter = $image.index();
            } else {
                galleryActiveClassCounter = $image.index() + 1;
            }

            $lightboxOverlay.show();
            window.aa.helpers.cache.cachedElements.$footer.addClass('hide-footer');
            window.aa.helpers.cache.cachedElements.$body.on('scroll touchmove mousewheel', preventScrolling);

            $('#site-wrapper').addClass('background');

            if (imageCounter === 1) {
                $filmStrip.add($lightboxControls).addClass('hidden');
            }

            $filmStrip.width($lightboxCarousel.width() + 150);

            // hide filmstrip arrows if gallery images are in viewport
            if ($thumbnailImage.length * $thumbnailImage.outerWidth() <= $scrollArea.width()) {
                $filmStrip.find('.lightbox-controls').children().addClass('hidden');
            }

            $gallerySlide.find('.see-more-images').remove();
            activeClassLogic();

            // hide film strip when lightbox is triggered
            clearTimeout(lightboxTimer);
            lightboxTimer = setTimeout(function () {
                if (filmStripHidden === false) {
                    toggleCarousel();
                }
            }, 2000);
        });

        $lightboxControls.not('.film-strip-control').on('click', function (e) {
            // update counter based on direction
            e.preventDefault();
            dir[$(this).data('dir')]();
            activeClassLogic();
        });

        // use filmstrip controls to navigate through thumbnail images
        $lightboxControls.filter('.film-strip-control').off('click').on('click', function (e) {
            var currentPosition = $scrollArea.scrollLeft(),
                filmStripCalculation = ($gallerySlide.find('.gallery-image').first().outerWidth() * 4); // times 4 images to scroll to

            e.preventDefault();

            // scroll 
            $scrollArea.stop().animate({ scrollLeft: $(this).data('dir') === 'prev' ? currentPosition - filmStripCalculation : currentPosition + filmStripCalculation }, 200);
        });

        $thisLightboxGallery.find('.overlay').add('.lightbox-close').on('click', function (e) {
            e.preventDefault();
            closeLightbox();
        });

        $thisLightboxGallery.on('click', '.lightbox-image', function (e) {
            e.preventDefault();
            if (galleryActiveClassCounter !== $(this).index() && filmStripHidden === false) {
                galleryActiveClassCounter = $(this).index();
                activeClassLogic();
                clearTimeout(lightboxTimer);
            }
        });

        // key and touch controlls
        window.aa.helpers.cache.cachedElements.$window.on('keydown', function (e) {
            var keyEvent = e.which || e.keyCode;
            switch (keyEvent) {
                case 37:
                    dir['prev']();
                    activeClassLogic();
                    break;
                case 27:
                    closeLightbox();
                    break;
                case 39:
                    dir['next']();
                    activeClassLogic();
                    break;
            }
        });

        // allow touch events on $presentedImageContainer
        $presentedImageContainer.touch({
            left: function () {
                dir['next']();
                activeClassLogic();
            }, right: function () {
                dir['prev']();
                activeClassLogic();
            }
        });
    }

// PP Jquery upgrade
//    window.aa.helpers.cache.cachedElements.$document.on({
//        ready: function () {
      window.aa.helpers.cache.cachedElements.$document.ready(
          function() {
//console.log('Jquery image-gallery upgrade of document.on( ready');
            $('.lightbox-gallery').each(imageGallery);
//        }
    });
})(jQ);
</script>
<script src=" /Assets/scripts/AutoNumeric.js                                 "></script>
<script>

/* 
 * ---------------------------------------- *
 * Name: 	Primary JavaScripts             *
 * Type: 	JavaScript                      *
 * Version: Not Versioned                   *
 * Author:	Thomas Dale | Codehouse         *
 * Requisites: chg.Client                   *
 *             chg.Cookie                   *
 * ---------------------------------------- *
 */

(function ($) {

    var $header = $('#site-header, #sales-journey-header'),
        headerHeight = $header.outerHeight(),
        resizeTimer,
        timer;

    // constants
    var RESULTS_LENGTH = 15;

    // configure local & global paths
    boot.config.local = '/Assets/scripts/libs/codehouse-js/';
    boot.config.libs = '/Assets/scripts/libs/';
    boot.config.global = '/Assets/scripts/';

    // apply client script
    client.domApply();

    // requisites: searchPagination
    function stickyFooter() {
        if (!$('.no-results').length && window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            window.aa.helpers.cache.cachedElements.$main.css({ paddingBottom: window.aa.helpers.cache.cachedElements.$footer.height() });
        } else if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            window.aa.helpers.cache.cachedElements.$main.css({ paddingBottom: 0 });
        }
    }

    // product comparison tables
    function productComparison() {

        var $productTable = $(this).not('.filter-table'),
            $tableWrapper = $productTable.find('.wrapper'),
            $firstColumn = $productTable.find('.description'),
            $fixedColumn = $productTable.find('.fixed-column'),
            resizeColumn;

        function setWidthHeight() {
            $fixedColumn.height($productTable.find('.table').innerHeight());
            $fixedColumn.width($firstColumn.innerWidth());
        }

        function popularTagWidth() {

            var $tag = $productTable.find('.tag, .popular-bottom').not('.offer');

            $tag.css({ width: $tag.parent('.popular').innerWidth() + 4 });  // add 4 to accommodate for absolute positioned :before and :after (acting as borders)

        }

        function tableOverflowIndicator() {

            var $tableInnerShadow = $(this),
                $table = $tableWrapper.find('.table');

            $productTable.parent('.wrapper').addClass('comparison-table');
            $tableInnerShadow.css({ height: $table.innerHeight(), top: $table.css('margin-top'), right: $tableWrapper.css('margin-right') });

            // add scrolling class if scrollbar exists
            if ($tableWrapper.innerWidth() < $tableWrapper.get(0).scrollWidth) {
                $tableWrapper.addClass('scrolling');
            } else {
                $tableWrapper.removeClass('scrolling');
            }

            $tableWrapper.on('scroll', function () {

                var $thisTableWrapper = $(this),
                    scrollLeft = $thisTableWrapper.scrollLeft(),
                    maxScroll = $thisTableWrapper.get(0).scrollWidth - $thisTableWrapper.parent().width(),
                    $fixedColumnandDescription = $fixedColumn.add($fixedColumn.find('.description').children());

                if (scrollLeft > 0) {
                    $fixedColumnandDescription.addClass('active');
                } else {
                    $fixedColumnandDescription.removeClass('active');
                }

                // hide right hand shadow once last column is reached
                if (scrollLeft >= maxScroll) {
                    $tableInnerShadow.hide();
                } else {
                    $tableInnerShadow.show();
                }

            });

        }

        // get height of table cells and apply to new fixed column table cells
        function fixedColumnHeight() {

            var $fixedColumnContents = $fixedColumn.find('.description > div'),
                $servicesRecommendedProduct = $fixedColumn.find('.recommended-product-label, .tag'),
                heights = [];

            if ($servicesRecommendedProduct.length) {
                $servicesRecommendedProduct.closest('.description').addClass('popular');
            }

            // remove heights to be overwritten
            $fixedColumnContents.height(''); // remove heights from table cell

            $firstColumn.each(function () {
                heights.push($(this).outerHeight());
            });

            // set heights of each table cell
            $fixedColumnContents.each(function (i) {
                $(this).css('height', heights[i]);
            });

            $fixedColumn.css({ left: $tableWrapper.css('margin-left') });

            popularTagWidth();

        }

        function informationPanelSizing($informationPanel) {

            var $panelParent = $informationPanel.parent('div'),
                $informationPanelInner = $informationPanel.find('.information-inner'),
                $informationPanelTrigger = $informationPanel.siblings('.more-information'),
                headingWidth = 0;

            // calculate outerWidth of previous heading divs
            $panelParent.prevAll().each(function () {
                headingWidth += $(this).outerWidth();
            });

            $informationPanel.css({ left: -(headingWidth), width: $productTable.find('.information-table').innerWidth() });

            if (client.IE) {
                $informationPanel.css({ top: $panelParent.innerHeight() });
            }

            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.TABLET_LANDSCAPE) {

                $informationPanelInner.width(window.aa.helpers.cache.cachedElements.$window.width() - 30); // minus 30 to take padding into consideration

                // on scroll hide open panels and adjust text within to always be on left
                $productTable.find('.wrapper').on('scroll', function () {

                    var scrollLeft = $(this).scrollLeft(),
                        $tableInnerShadow = $productTable.find('.table-inner-shadow'),
                        $descriptionDiv = $fixedColumn.children('div');

                    if (scrollLeft > 0) {

                        if ($informationPanel.hasClass('open')) {
                            $informationPanelTrigger.trigger('click');
                        }

                        $informationPanelInner.css({ left: scrollLeft });
                        $tableInnerShadow.hide();

                        $fixedColumn.add($descriptionDiv).addClass('active');

                    } else {
                        $informationPanelInner.css({ left: 0 });
                        $tableInnerShadow.show();
                        $fixedColumn.add($descriptionDiv).removeClass('active');
                    }

                });
            }
        }

        // information panel within table
        function informationPanel($informationPanel) {
            var $panelParent = $informationPanel.parent('div'),
                $informationPanelTrigger = $informationPanel.siblings('.more-information');

            // hide/reveal panels based on classes
            $informationPanelTrigger.click(function (e) {

                var $panelParentSiblings = $panelParent.siblings('div');

                e.preventDefault();

                // hide other information panels if one is already open and reveal relevant panel
                if ($panelParentSiblings.length) {
                    $panelParentSiblings.children('.information').removeClass('open').stop().slideUp(300);
                }

                $informationPanel.toggleClass('open').stop().slideToggle(300, function () {

                    if ($informationPanel.hasClass('open')) {
                        $informationPanelTrigger.addClass('active');
                        $panelParentSiblings.children('.more-information').removeClass('active');
                    } else {
                        $informationPanelTrigger.removeClass('active');
                    }

                });

            });
        }

        $fixedColumn.each(function () {
            $firstColumn.clone().wrapInner('<div />').appendTo(this);
        });

        setWidthHeight();
        fixedColumnHeight();
        $productTable.find('.information').each(function () {
            informationPanelSizing($(this));
            informationPanel($(this));
        });
        $productTable.find('.table-inner-shadow').each(tableOverflowIndicator);

        // recalculate heights and widths
        window.aa.helpers.cache.cachedElements.$window.on('resize', function () {
            clearTimeout(resizeColumn);
            resizeColumn = setTimeout(function () {
                $productTable.find('.information').each(function () {
                    informationPanelSizing($(this));
                });
                setWidthHeight();
                fixedColumnHeight();
                $productTable.find('.table-inner-shadow').each(tableOverflowIndicator);

            }); // call on resize end
        });

    }

    // search results page 
    function searchResults() {

        var $searchArea = $(this),
            $resultsContainer = $searchArea.find('.results-container'),
            $searchBox = $searchArea.find('input[type="text"]'),
            $searchBtn = $searchArea.find('input[type="submit"]'),
            $minCharacters = $searchArea.find('input[type="hidden"]'),
            $searchSubmit = $searchArea.find('.button'),
            $searchBoxClosest = $searchBox.closest($searchArea),
            $closeBtn = $searchArea.find('.close');

        // remove value 'search' for tablet/mobile
        function removeSearchBtnValue() {
            if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.TABLET_BREAKPOINT || $searchBtn.parents('#search-takeover').length) {
                $searchBtn.val('');
            } else {
                $searchBtn.val('Search');
            }

            // if value exists enable search button
            if ($searchBox.val() !== '') {
                $searchBtn.attr('disabled', false).parent().removeClass('disabled');
            }
        }

        // focus keyword & select result && submit
        function focusKeyword() {
            var $focusedItem = $resultsContainer.find('.focus'),
                useResult = $focusedItem.length ? $focusedItem.data('result') : $searchBox.val();

            $searchBox.val(useResult);
            $searchBoxClosest.trigger('submit');

            // erase lazy load cookie for next result
            window.aa.helpers.cache.registerCookie.erase('SearchResultsPageOne');
        }

        // disable search button
        function disableButton() {
            $(this).stop().fadeOut(200);
            $searchBox.val('');
            $searchBtn.attr('disabled', true).parent().addClass('disabled');
        }

        $searchSubmit.on({
            keypress: function (e) {
                if (e.keyCode === 13 || e.which === 13) {
                    $searchBoxClosest.trigger('submit');
                }
            }
        });

        $searchBox.on({
            keyup: function () {
                $closeBtn.stop().fadeIn();
                $searchBtn.attr('disabled', false);
                $searchSubmit.removeClass('disabled');
            },
            blur: function () {
                if ($searchBox.val()) {
                    $closeBtn.show();
                    $searchBtn.attr('disabled', false);
                    $searchSubmit.removeClass('disabled');
                } else {
                    $searchBtn.attr('disabled', true);
                    $searchSubmit.addClass('disabled');
                    $closeBtn.fadeOut();
                }
            },
            keypress: function (event) {
                if (event.keyCode === 13) {
                    focusKeyword();
                }
            },
            paste: function (event) {
                // allow backspace in firefox
                if (event.which === 8) {
                    return true;
                }
                return /^[a-zA-Z0-9-',. ]*$/.test(event.originalEvent.clipboardData.getData('text'));
            }
        });

        $closeBtn.on({
            click: disableButton,
            keypress: function (e) {
                if (e.keyCode === 13 || e.which === 13) {
                    disableButton();
                }
            }
        });

        window.aa.helpers.cache.cachedElements.$window.on('resize', function () {
            removeSearchBtnValue();
        });

        removeSearchBtnValue();

        // call autocomplete if results container exists
        if ($resultsContainer.length) {
            // search input autocomplete
            window.aa.helpers.autoComplete({
                $input: $searchBox,
                $loadingElem: $searchBox,
                $resultsContainer: $resultsContainer,
                characterCount: $minCharacters.val(),
                url: '/cms/ajax/api/autocomplete/getautocompleteresults/{value}',
                onSuccess: function (data) {
                    var results = data.Results,
                        markup = '';

                    if (results === 'null' || !results.length) {
                        window.aa.helpers.hideResults($resultsContainer, $searchBox);
                    } else {
                        // build markup to insert
                        markup += '<ul><span class="separator"></span>';

                        for (var i = 0; i < results.length; i += 1) {
                            markup += '<li data-result="' + results[i].Suggestion + '">' + results[i].Suggestion.replace(data.SearchText, '<b>$&</b>') + '</li>';
                        }

                        markup += '</ul>';

                        // insert into results container
                        $resultsContainer[0].innerHTML = markup;

                        // bind events if necessary
                        $resultsContainer.find('li').on('click', function () {
                            $(this).addClass('focus');
                            focusKeyword();
                        });

                        // show container
                        window.aa.helpers.showResults($resultsContainer, $searchBox);

                    }
                },
                onEnter: function () {
                    if ($resultsContainer[0].innerHTML !== '') {
                        focusKeyword();
                    }
                }
            });
        }

    }
 $(".mid-grey-my-account-item").parent().addClass("mid-grey-my-account-item");
    // pagination for search results
    function searchPagination() {

        var $searchResultsListing = $('#search-results-listing'),
            $searchLoading = $searchResultsListing.find('#search-loading'),
            $results = $searchResultsListing.find('.result'),
            $pagination = $('#results-pagination'),
            $pagerBtns = $pagination.find('h5.button'),
            queryString = window.location.search,
            parameters = { q: '', pg: '1' },
            resultsLoadedOnce = false;

        if (queryString !== '') {
            var serialisedQuery = serialise.url(queryString);
            parameters.q = serialisedQuery.q;
            parameters.pg = serialisedQuery.pg || '1';
        }

        // hide loading gif if no results are found
        if ($results.length < RESULTS_LENGTH) {
            $searchLoading.addClass('hidden');
        }

        if (!$results.length) {
            window.aa.helpers.cache.cachedElements.$html.addClass('no-results');
        }

        // get next fifteen results
        function lazyLoadResults() {

            var $resultsListingWrapper = $searchResultsListing.children('.wrapper');

            parameters.pg = 2;

            $.ajax({
                url: 'cms/ajax/fragment/search/searchresultarticles',
                data: parameters,
                type: 'GET',
                dataType: 'text'
            }).done(function (response) {

                // lazy load only if 15 or more results
                if ($results.length >= RESULTS_LENGTH) {
                    resultsLoadedOnce = true;

                    $resultsListingWrapper.append(response); // append results to listing
                    $searchLoading.addClass('hidden'); // hide loading animation once results are loaded
                }

            }).fail(function () {
                resultsLoadedOnce = true;
                $resultsListingWrapper.find('#search-no-results').removeClass('hidden');
            });
        }

        // adjust height of search results page if no results
        function searchResultsHeight() {

            var $searchResultsPage = $searchResultsListing.parent('#search-results'),
                $alternativeSearchResults = $searchResultsPage.find('#alternative-results-option');

            if (!$searchResultsListing.find('.result').length && window.aa.helpers.cache.cachedElements.$body.height() < window.aa.helpers.cache.cachedElements.$window.height()) {
                $alternativeSearchResults.css({ height: $alternativeSearchResults.innerHeight() + window.aa.helpers.cache.cachedElements.$window.height() - window.aa.helpers.cache.cachedElements.$body.height() });
            }
        }

        // next or previous search result pages
        $pagerBtns.on('click', function () {
            var isLeft = $(this).hasClass('left');

            if (parameters.pg === '3') {
                isLeft ? parameters.pg = 1 : parameters.pg++;
            } else {
                isLeft ? parameters.pg-- : parameters.pg++;
            }

            window.aa.helpers.cache.registerCookie.write('SearchResultsPageOne', true);

            window.location.search = serialise.obj(parameters);
        });

        if (parameters.pg === '1') {
            window.aa.helpers.cache.cachedElements.$window.on('scroll', function () {
                if (window.aa.helpers.cache.cachedElements.$window.scrollTop() === window.aa.helpers.cache.cachedElements.$document.height() - window.aa.helpers.cache.cachedElements.$window.height()) {
                    if (resultsLoadedOnce === false && $results.length >= RESULTS_LENGTH) {
                        lazyLoadResults();
                    }
                }
            });

            if (window.aa.helpers.cache.registerCookie.check('SearchResultsPageOne')) {
                lazyLoadResults();
            }
        } else {
            $searchLoading.addClass('hidden');
        }

        searchResultsHeight();

        window.aa.helpers.cache.cachedElements.$window.on({
            resize: function () {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(function () {
                    searchResultsHeight();
                    if ($('#site-footer').length) {
                        stickyFooter();
                    } // resize #main bottom padding on search page
                }, 100); // call on resize end
            }
        });

    }

    // product comparison detail headers
    function productionDetailHeaders() {

        var $detailHeader = $(this).not('.journey-products'),
            $twoColumn = $detailHeader.closest('.two-column'),
            $detailHeaderH2 = $detailHeader.find('h2.alt'),
            $detailBeam = $detailHeader.find('.beam');

        if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.TABLET_BREAKPOINT) {
            $detailBeam.css('background-position', '' + ($detailHeaderH2.width() + 52) + 'px -70px');
        } else if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            $detailBeam.css('background-position', '' + ($detailHeaderH2.width() + 35) / 10 + 'rem -3.8rem');
        }

        // add not-popular class if single product detail
        // does not have the popular tag
        if (!$detailHeader.find('.popular').length) {
            $detailHeader.addClass('not-popular');
        }

        // if both products do not have popular tag add class to column
        // to remove margin from both
        if ($twoColumn.find('.not-popular').length > 1) {
            $twoColumn.addClass('none-recommended');
        }
    }

    // fade text
    function textFadeIn() {

        if (!client.IE9 || window.aa.helpers.cache.cachedElements.isExperienceEditor) {
            return;
        }

        var $fadeIn = $(this),
            $one = $fadeIn.filter('.one'),
            $two = $fadeIn.filter('.two'),
            $three = $fadeIn.filter('.three'),
            $four = $fadeIn.filter('.four'),
            fadeTo = { opacity: '1' },
            delayTime = 300;

        $one.delay(1200).animate(fadeTo, delayTime);
        $two.delay(1400).animate(fadeTo, delayTime);
        $three.delay(1600).animate(fadeTo, delayTime);
        $four.delay(1800).animate(fadeTo, delayTime);
        $fadeIn.delay(delayTime).animate(fadeTo, delayTime);

    }

    // load YouTube API
    function initYouTubeAPI() {

        window.onYouTubePlayerAPIReady = function () {
            window.youTubePlayers = {};

            // cycle through and init players and overlays
            $('.youtube-video').each(function (i) {
                var $video = $(this),
                    $videoEmbed = $video.find('.video-container').children('div');

                // update id of each video iframe, in case same id exists
                $videoEmbed.prop('id', $videoEmbed.prop('id') + i);
                youTubeVideo($video);
            });
        }
    }

    // user interactions for the YouTube video overlay
    function youTubeVideo($el) {
        var $videoModule = $el,
            $videoContainer = $videoModule.find('.video-container'),
            videoId = $videoModule.data('videoid');

        function onPlayerReady() {
            $videoModule.find('.play-media').show().css("z-index", "1");
            $videoModule.find('.play-media').on("click", function () {
                window.youTubePlayers[videoId].playVideo();
            });
        }

        function onPlayerStateChange(event) {

            if (event.data === 0) {
                if (!client.Mobile && !$el.is('.hero-video')) {
                    $videoModule.removeClass('enlarged');
                }
            }
            else if (event.data == YT.PlayerState.PLAYING) {
                if (!client.Mobile && !$el.is('.hero-video')) {
                    $videoModule.addClass('enlarged');
                }
                $videoContainer.animate({ 'opacity': 1 }, 800);
                $videoModule.find('.play-media').hide();
            }
        }

        $('.play-media').on('click', function () {

        })

        window.youTubePlayers[videoId] = new YT.Player($videoContainer.children('div').prop('id'), {
            height: '390',
            width: '640',
            videoId: videoId,
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange,
                'onClick': onPlayerStateChange
            }
        });

        // init youtube lightbox
        if ($('#youtube-lightbox').length) {
            window.aa.helpers.youtubeLightbox();
        }
    }

    // init cinemagraph with hero banner
    function initCinemagraph() {

        var $cinemagraph = $(this),
            $cinemagraphContainer = window.aa.helpers.cache.cachedElements.$body.find('.cinemagraph-container'),
            $heroBanner = $cinemagraphContainer.find('.desktop-tablet-view, .mobile-view'),
            src = $cinemagraph.data('src');

        $heroBanner.addClass('visible');

        if (client.Mobile || client.OldIE || window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.TABLET_LANDSCAPE || !src.length) {
            $cinemagraph.empty().hide();

        } else if (src.length) {
            $heroBanner.removeClass('visible');
            $cinemagraph.html('<video autoplay loop><source src="' + src + '" type="video/mp4" /></video>').show();
        }
    }

    // call tealium view
    function fireTealiumPageView() {
        if (window.utag_cfg_ovrd && window.utag_cfg_ovrd.noview) {
            if (window.utag) {
                utag.view(window.utag_data);
            } else {
                window.utag_cfg_ovrd.noview = false;
            }
        }
    }

    // load in tealium for search page
    function loadTealium() {
        var $searchContainer = $('#search-results');

        if ($searchContainer.length) {
            var searchPage = $searchContainer.find('#results-currentPage').text().trim();

            if (searchPage === '1') {
                utag_data.search_keyword = $searchContainer.find('#alternative-results-option span').text();
                utag_data.search_results = $searchContainer.find('#results-count').text();
            }
        }

        fireTealiumPageView();
    }

    // iframeResizer
    function iframeResizer() {
        $(this).iFrameResize({
            heightCalculationMethod: client.IE ? 'max' : 'lowestElement'
        });
    }

    // set equal heights on related content modules
    function relatedContent() {

        var $moduleContent = $(this).find('.module-content'),
            heights = [];

        $moduleContent.css('height', '');

        function setHeights() {
            $moduleContent.each(function () {
                heights.push($(this).height());
            });

            $moduleContent.height(Math.max.apply(null, heights));
        }

        if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.TABLET_BREAKPOINT) {
            setHeights();
        } else if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && ($moduleContent.closest('.tweet-half-width').length || $moduleContent.parent('.multi-product').length || $moduleContent.closest('.related-results').length)) {
            setHeights();
        }
    }
   

    // bazaar voice initialisation
    function initBazaarVoice() {
        var $container = $('#BVRRContainer');

        function bVcallBack() {
            $BV.configure('global', { productId: $container.data('product-id') });

            $BV.ui('rr', 'show_reviews', {
                doShowContent: function () { }
            });

        }

        if (typeof window.$BV !== 'undefined') {
            bVcallBack();
        } else {
            $.ajax({
                url: $container.data('bv-url'),
                cache: true,
                dataType: 'script',
                success: function () {
                    $($BV.docReady);
                    bVcallBack();
                }
            });
        }
    }

    // emergency alert fixed bar
    function emergencyAlert() {

        var $emergencyAlert = $('#emergency-alert'),
            messageId = $emergencyAlert.data('message-id');

        // adjust bottom padding on body to show bottom of footer
        function bodyPadding() {

            var alertHeight = $emergencyAlert.outerHeight();

            window.aa.helpers.cache.cachedElements.$body.css({ paddingBottom: alertHeight });
        }

        function showAlert() {

            // delay padding to prevent white space at bottom of page
            setTimeout(function () {
                bodyPadding();
            }, 2400);

            $emergencyAlert.removeClass('slide-out-down').addClass('slide-in-up');

            // fallback animation for ie9
            if (client.IE9) {
                $emergencyAlert.delay(240).animate({ bottom: '0' }, 2400);
            }
        }

        function hideAlert() {
            window.aa.helpers.cache.cachedElements.$body.css({ paddingBottom: 0 });

            // delay removal of class for smooth transition
            setTimeout(function () {
                $emergencyAlert.removeClass('slide-in-up');
            }, 2400);

            $emergencyAlert.addClass('slide-out-down');

            // fallback animation for ie9
            if (client.IE9) {
                $emergencyAlert.animate({ bottom: '-100%' }, 2400);
            }
        }

        // no AppInstalled cookie, display banner 
        if (!window.aa.helpers.cache.registerCookie.check('EmergencyAlert')) {
            showAlert();
        } else {
            // check if app ID doesn't exist in the cookie's value
            if ($.inArray(messageId, window.aa.helpers.cache.registerCookie.check('EmergencyAlert').split(',')) === -1) {
                showAlert();
            }
        }

        if (!window.aa.helpers.cache.cachedElements.isExperienceEditor) {
            // click event
            $emergencyAlert.find('.close').on('click', function () {

                var cookieValue = window.aa.helpers.cache.registerCookie.check('EmergencyAlert');

                /* get the cookie value, if it's not null, 
                 * split it into an array, 
                 * otherwise set its value to an empty array */
                if (cookieValue) {
                    cookieValue = cookieValue.split(',');
                } else {
                    cookieValue = [];
                }

                // if non-existent value push it to array 
                if ($.inArray(messageId, cookieValue) === -1) {
                    cookieValue.push(messageId);
                }

                // write the cookie with new value(s)
                window.aa.helpers.cache.registerCookie.write('EmergencyAlert', cookieValue.join(','), 14);

                hideAlert();

            });
        }

        // for mobile devices reveal more text on click
        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            $emergencyAlert.find('h6').on('click', function () {
                $(this).toggleClass('active');
                bodyPadding();
            });
        }
        // adjust padding if height adjusts on resize
        window.aa.helpers.cache.cachedElements.$window.on('resize', function () {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function () {
                if ($emergencyAlert.hasClass('slide-in-up')) { // only adjust padding if emergency alert is visible
                    bodyPadding();
                }
            }, 100); // call on resize end
        });
    }

    // module image swap
    function swapImage() {
        var $module = $(this),
            mobileImage = $module.data('mobile');

        // replace background-image url with data attribute
        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && typeof mobileImage !== 'undefined') {
            $module.css({ 'background-image': 'url("' + mobileImage + '")' });
        }
    }

    // apply min-height based on content within - covers several module types and layouts
    function moduleHeight() {

        var $moduleContainer = $(this),
            $moduleContainerTwoCol = $moduleContainer.parent('.col'),
            $moduleColumnContainer = $moduleContainer.closest('.two-column'),
            $moduleColumnSibling = $moduleContainerTwoCol.siblings('.col'),
            $videoModule = $moduleColumnSibling.find('.youtube-video'),
            newHeight;

        // set min height or reset
        function setMinHeight() {

            var innerHeight = $moduleContainer.find('.inner').innerHeight(),
                heightOrReset = innerHeight == null ? '' : innerHeight;

            $moduleContainer.css({ minHeight: heightOrReset });
            $moduleContainer.find('.text').css({ minHeight: heightOrReset });

        }

        // remove any initial inline min-heights
        $moduleContainer.css({ minHeight: '' });
        $moduleContainer.find('.text').css({ minHeight: '' });

        if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && !window.aa.helpers.cache.cachedElements.isExperienceEditor) {

            // if two col
            if ($moduleContainerTwoCol.length) {

                // get the tallest height from the inner section of each module in the column collection, include video module in collection for that exception
                newHeight = window.aa.helpers.getTallestHeightHelper($moduleColumnContainer.find('.inner').add($videoModule));

                $moduleContainer.css({ minHeight: newHeight }); // set min height to height of tallest in either column
                $moduleContainer.find('.text').css({ minHeight: $moduleColumnSibling.find('.text').innerHeight() });

            } else {
                setMinHeight();
            }
        } else if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT && !window.aa.helpers.cache.cachedElements.isExperienceEditor) {
            setMinHeight();
        }
    }

    // apply class to row if it contains hero image component
    function heroImageRow() {
        $(this).closest('.row').addClass('hero-row');
    }

    // apply class to broken down now component if directly underneath hero image row
    function heroBrokenDown() {

        var $brokenDown = $(this),
            $brokenDownHero = $brokenDown.parents('.row');

        if ($brokenDownHero.prev('.row').find('.hero-image').length) {
            $brokenDownHero.addClass('hero-service');
        }

    }

    // member benefits hero
    function memberBenefitsHero() {

        var $hero = $(this),
            $image = $hero.find('img.responsive-image'),
            $textOverlay = $hero.find('.text-overlay');

        // calculate height based on contents on text overlay
        if ($image.length && $textOverlay.length) {
            $hero.css({ height: ($hero.find('.desktop-tablet-view').is(':visible') ? $image.get(0).naturalHeight : $hero.find('.mobile-view').find('img').get(0).naturalHeight + parseFloat($textOverlay.css('top')) + parseFloat($textOverlay.find('h2 + h2').find('span').css('margin-top')) + $textOverlay.find('.button').innerHeight()) });
        }
    }

    // apply class to wrapper if it contains contact content component
    function contactContent() {
        $(this).not('.filter').closest('.wrapper').addClass('contact-wrapper');
    }

    // apply class to wrapper if it contains rich text component
    function richTextWrapper() {

        var $richText = $(this),
            $richTextWrapper = $richText.closest('.wrapper');

        if (!$richText.closest('.two-column').length) {
            $richTextWrapper.addClass('rich-text-wrapper');
        }

        // remove rich text wrapper if accordion is within
        if ($('.rich-text-wrapper').find('.accordion').length) {
            $richTextWrapper.removeClass('rich-text-wrapper');
        }
        // remove rich text wrapper if schema is within
            if ($('.rich-text-wrapper').find('.SchemaText').length) {
            $richTextWrapper.removeClass('rich-text-wrapper');
                $('.SchemaText').hide();
        }

    }

    // hide/show more links if more than 9 in list
    function moreLinks() {

        var $links = $(this),
            $toggleBtns = $links.find('.more, .less'),
            $greaterThan9Links = $links.find('li:gt(8)');

        if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {

            $greaterThan9Links.hide();

            // show more button if there are more than 9 list items
            if ($links.find('li').length > 9) {
                $toggleBtns.not('.hidden').show();
            } else {
                $toggleBtns.hide();
            }

            $toggleBtns.on('click', function (e) {

                e.preventDefault();

                // toggle view of relevant button
                $toggleBtns.toggleClass('hidden');

                // toggle view of list items
                $greaterThan9Links.stop().fadeToggle(300);

            });
        }
    }

    // smooth scroll to content id on load
    function scrollToContent() {
        var sectionContentId = window.location.hash;
        try { //Start NW-2568
            //Start-NW-2548
            var $sectionContentId = $(sectionContentId.replace(/\//g, ""));
            //End-NW-2548
            var $accordion = $sectionContentId.closest('.accordion-item'),
				accordionHeight = $accordion.find('.accordion-header').outerHeight();

            function scrollToAccordionContentId() {
                window.aa.helpers.cache.cachedElements.$html.add(window.aa.helpers.cache.cachedElements.$body).stop().animate({ scrollTop: $sectionContentId.offset().top - headerHeight / 2 - accordionHeight }, 750);
            }

            if (sectionContentId && $sectionContentId.length) {

                if ($accordion.length) {

                    if ($accordion.hasClass('active')) {
                        scrollToAccordionContentId();

                    } else {

                        $accordion.find('.accordion-header').trigger('click');

                        clearTimeout(timer);
                        timer = setTimeout(function () {
                            scrollToAccordionContentId();
                        },
							250);
                    }

                } else {
                    window.aa.helpers.cache.cachedElements.$html.add(window.aa.helpers.cache.cachedElements.$body).stop().animate({ scrollTop: $sectionContentId.offset().top - headerHeight / 1.5 }, 750);
                }
            }
            //Start NW-2568
        }
        catch (err) {
            console.log(err.message);
        }
        //End NW-2568
    }

    // financial services product selector tabs
    function productSelector() {
        var $module = $(this),
            $tabs = $module.find('.product-tab'),
            $tabsCtaContainer = $module.find('.product-selector-tabs').find('.wrapper'),
            $tabsCta = $module.find('.product-tab-cta');

        function tabsClickEvents() {
            var $target = $(this);

            $tabs.add($tabsCta.find('.tab-arrow')).hide();
            $tabsCta.removeClass('current');

            $('#' + $target.data('tab-id')).fadeIn(150, function () {
                $target.addClass('current');
            });

            // set cta height based on tallest
            $tabsCtaContainer.each(toolkit.equalHeight);
        }

        function setActiveTab() {
            var $firstCtaTab = $tabsCta.eq(0),
                url = window.location.hash,
                $targetCtaTab,
                productName;

            if (url.length) {
                productName = url.split('#')[1];
                $targetCtaTab = $('[data-nav-id="' + productName + '"]');

                if ($targetCtaTab.length) {
                    $targetCtaTab.each(tabsClickEvents);
                } else {
                    $firstCtaTab.each(tabsClickEvents);
                }

                return;
            }

            $firstCtaTab.each(tabsClickEvents);
        }

        // set selection arrow type based on container background colour
        $tabs.each(function () {
            var $tab = $(this),
                $tabCol = $tab.find('.tab-col');

            if ($tab.hasClass('mid-grey-bg-color')) {
                $('[data-tab-id="' + $tab.attr('id') + '"]').addClass('grey-arrow');
            } else {
                $tab.addClass('white-bg-color');
                $('[data-tab-id="' + $tab.attr('id') + '"]').addClass('white-arrow');
            }

            if ($tabCol.length === 1) {
                $tabCol.addClass('single-item');
            }
        });

        // set inner shadow for tab content if cta tabs are visible
        if ($tabsCta.length) {
            $tabs.addClass('inner-shadow-light');

            switch ($tabsCta.length) {
                case 1:
                    $module.addClass('single-cta-grid');
                    break;
                case 2:
                    $module.addClass('two-cta-grid');
                    break;
                case 3:
                    $module.addClass('three-cta-grid');
                    break;
                case 4:
                    $module.addClass('four-cta-grid');
                    break;
            }

            // set active tab on load
            setActiveTab();
        }

        // show tab content if cta tabs are not visible
        if ($module.find('.product-selector-tabs').length === 0 || $module.find('.product-tab-cta').length === 0) {
            $tabs.addClass('tab-visible alternate-styles');

            // alternate content containers left/right
            if ($tabs.length > 1) {
                $tabs.each(function (index) {
                    var $target = $(this),
                        $imageSection = $target.find('.image-area'),
                        $descriptionArea = $target.find('.description-area');

                    $target.addClass('mid-grey-bg-color');

                    if (index % 2 === 0) {
                        $target.removeClass('mid-grey-bg-color').addClass('white-bg-color');

                        if ($imageSection.length && $descriptionArea.length) {
                            $imageSection.detach().insertBefore($descriptionArea);
                        }
                    }
                });
            }
        }

        // set cta height based on tallest
        $tabsCtaContainer.each(toolkit.equalHeight);

        toolkit.resizeTimer.push(function () {
            $tabsCtaContainer.each(toolkit.equalHeight);
        });

        $tabsCta.off('click', tabsClickEvents).on('click', tabsClickEvents);

        window.aa.helpers.cache.cachedElements.$window.on('orientationchange', function () {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function () {
                $tabsCta.css({ height: '' });
                $tabsCtaContainer.each(toolkit.equalHeight);
            }, 200);
        });
    }

    // findancial services loan product detail
    function loanProductDetail() {
        var $module = $(this),
            $aprDescription = $module.find('.apr-description'),
            $rate = $module.find('.rate');

        // show/hide separating pipes based on visible rate information elements in table header
        if (($aprDescription.length && $rate.length === 0) || $aprDescription.length === 0 && $rate.length) {
            $module.addClass('single-rate-separator');
        } else if ($aprDescription.length === 0 && $rate.length === 0) {
            $module.addClass('rate-separator-hidden');
        }

        // check features list items
        $module.find('.feature-list').each(function () {
            var $list = $(this),
                $listItems = $list.find('li');

            if ($listItems.length && $listItems.length < 3) {
                $list.addClass('two-col-group');
            } else if ($listItems.length === 0) {
                $list.closest('.feature-list-group').hide();
            }
        });
    }

// PP Jquery upgrade
//    window.aa.helpers.cache.cachedElements.$document.on({
//        ready: function () {
      window.aa.helpers.cache.cachedElements.$document.ready(
          function() {

            window.aa.helpers.cache.cachedElements.$html.removeClass('no-js');

            var responsive = new Responsive(); // instantiate responsive class

            // responsive images fluidImages is a jQuery member created by Responsive();
            $('.responsive-image').fluidImages({
                container: $('.responsive-image-container'), // decorate containers accordingly
                objectFit: !client.IE, // use object fit if not IE
                useMargins: client.OldIE // use margins if old ie
            });

            $('.accordion').each(window.aa.helpers.accordions);

            $('.search').each(searchResults);

            if ($('#results-pagination').length) {
                searchPagination();
            }

            if ($('#site-footer').length) {
                stickyFooter();
            }

            $('.equal-height').each(window.aa.helpers.panelHeight);

            $('.module.youtube-video, .related-product, .app-promo, .campaign-promo, .contact-content, .related-links, .two-column .exchange-tool, .est-related-links').each(moduleHeight);

            $('.fade-in').each(textFadeIn);

            $('.product-detail').each(productionDetailHeaders);

            if ($('.youtube-video').length) {
                boot.loadScript('https://www.youtube.com/iframe_api', 'cdn', function () {
                    initYouTubeAPI();
                });
            }

            // tealium universal tag data exists
            if (typeof window.utag_data !== 'undefined') {
                loadTealium();
            }

            if ($('#BVRRContainer').length) {
                initBazaarVoice();
            }

            if ($('.iframe-container').length) {
                boot.loadScript('iframeResizer.min.js', 'libs', function () {
                    $('.iframe').each(iframeResizer);
                });
            }

            if ($('#emergency-alert').length) {
                emergencyAlert();
            }

            if ($('#weather').length) {
                boot.loadScript('weather.js', 'global', function () { });
            }

            if ($('#site-wrapper').length) {
                scrollToContent();
            }

            // init cinemagraphs
            $('.cinemagraph').each(initCinemagraph);

            $('.module').each(swapImage);

            $('.hero-image').each(heroImageRow);

            $('.ch-hero-image').each(heroImageRow);

            $('.service').each(heroBrokenDown);

            $('.contact-content').each(contactContent);

            $('.rich-text').each(richTextWrapper);

            $('.module-accordion').each(window.aa.helpers.moduleAccordion);

            $('.related-links').each(moreLinks);

            $('.financial-services-product-selector').each(productSelector);

            $('.loan-product-detail').each(loanProductDetail);

            if ($('#sales-journey-header').length) {

                if (typeof window.aa.salesJourneyApp !== 'undefined') {
                    window.aa.salesJourneyApp.application.init();
                }

            }

            // calculator tools functionality
            if ($('.calculator-tool').length) {
                boot.loadScript('tools.js', 'global', function () { });
                if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $('.calculator-tool').find('.calculation-result').removeClass('table');
                }
            }

            stylishForms.apply();
        //}
    });
    window.aa.helpers.cache.cachedElements.$window.on({
        resize: function () {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function () {
                $('.equal-height').each(window.aa.helpers.panelHeight);
                $('.related-content, .content-article, .multi-product-container, .twitter-container').each(relatedContent);
                $('.module.youtube-video, .related-product, .app-promo, .campaign-promo, .contact-content, .related-links, .two-column .exchange-tool, .est-related-links').each(moduleHeight);
                $('.module').each(swapImage);
                $('.product-detail').each(productionDetailHeaders);
                $('.hero-image.member-benefits').each(memberBenefitsHero);

                if ($('#site-footer').length) {
                    stickyFooter();
                }

                $('.cinemagraph').each(initCinemagraph);

                if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $('.calculator-tool').find('.calculation-result').removeClass('table');
                } else {
                    $('.calculator-tool').find('.calculation-result').addClass('table');
                }

            }, 100); // call on resize end
        },
        load: function () {
            $('.module.youtube-video, .related-product, .app-promo, .campaign-promo, .contact-content, .related-links').each(moduleHeight); // call on load to account for images
            $('.product-comparison, .table-component').each(productComparison);
            $('#search-icon').on('click', function () {
                $('#search-takeover').find('input').first().focus();
            }); // call on load for mobile

            $('.hero-image.member-benefits').each(memberBenefitsHero);

            $('.related-content, .content-article, .multi-product-container, .twitter-container, .related-results').each(relatedContent);
            

        }
    });

// PP Jquery upgrade
//    window.aa.helpers.cache.cachedElements.$document.on({
//        ready: function () {
      window.aa.helpers.cache.cachedElements.$document.ready(
          function() {


            $(document).find('.desktop-btn-view .filter-link,.filter-close-btn .close-link').on('click',function (e) {
                e.preventDefault();
               
                $('.offers-sidebar .offer-filter').slideToggle();/*CD-3143*/
            });
            
           

            $('#offersModal').on('show.bs.modal', function (e) {
                var rewardId = $(e.relatedTarget).data('reward-id');
                $(e.currentTarget).find('#offer-url').attr('src', rewardId);
            });

          
        //}
    });


    //$(window).on('load', function () {
    //    //include condition here
    //    $('#codeNotAvailableModal').modal('show');
    //});
    //$(document).ready(function () {
    //    $('#codeNotAvailableModal').on('hidden.bs.modal', function (e) {
    //      window.location = $('#codeNotAvailableModal').find('.modal-header').find('a').attr('href'); //MEM-1
    //        $(this).parents('.row-with-sidebar').css('z-index', '1');
    //    });
    //    $('#codeNotAvailableModal').on('shown.bs.modal', function (e) {
    //        $(this).parents('.row-with-sidebar').css('z-index', 'inherit');
    //        //END MEM-92
    //    });
        
    //});

    $(window).on('load', function () {
        //include condition here
        $('#codeNotAvailableModal').modal('show');
    });
    $(document).ready(function () {
        $('#codeNotAvailableModal').on('hidden.bs.modal', function (e) {
            window.location = $('#codeNotAvailableModal').find('.modal-header').find('a').attr('href');
            $(this).parents('.row-with-sidebar').css('z-index', '1');
            var url = "\/member-benefits/all";
            window.location = url;
        });
        $('#codeNotAvailableModal').on('shown.bs.modal', function (e) {
            $(this).parents('.row-with-sidebar').css('z-index', 'inherit');
        });
    });
    
    $('.report-breakdown').click(function () {
        //e.preventDefault();
        $(this).fadeOut(300);
        $('.modal-backdrop.fade.in').addClass('dark');
        $('#brokenDownModal').modal({
            backdrop: 'static',
            keyboard: false
        })
    });
    $('#brokenDownModal').on('shown.bs.modal', function (e) {


    });
    $('#brokenDownModal').on('hidden.bs.modal', function (e) {

        $('.report-breakdown').fadeIn(300);
    });

    //best bundle accordion
    var $bundletable = $('.best-bundle-table');
    var $headerClick = $bundletable.find('.best-bundle-content-item-head-title');
    $($headerClick).on('click', function (e) {
        e.preventDefault();

        $(this).parent().next('.best-bundle-content-item-description').slideToggle();
        $(this).parent().parent('.best-bundle-content-item').toggleClass('best-bundle-closed');
        if ($(this).parent().parent().siblings().find('.best-bundle-content-item-description').is(':visible')) {
            $(this).parent().parent().siblings().find('.best-bundle-content-item-description').slideUp().parent('.best-bundle-content-item').addClass('best-bundle-closed');;
            //$(this).parent().parent().addClass('best-bundle-closed');
        }
        else if ($(this).parent().parent().parent().parent().siblings().find('.best-bundle-content-item-description').is(':visible')) {
            $(this).parent().parent().parent().parent().siblings().find('.best-bundle-content-item-description').slideUp().parent('.best-bundle-content-item').addClass('best-bundle-closed');
            //$(this).siblings().addClass('best-bundle-closed');
        }


    });
    //cover table js
    function covetableHeight() {

        var $tableCol = $(this).find('.cover-level-table-col >.cover-level-table-content'),
            heights = [];

        $tableCol.css('height', '');

        function setHeights() {
            $tableCol.each(function () {
                heights.push($(this).height());
            });

            $tableCol.height(Math.max.apply(null, heights));
        }

        if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.TABLET_LANDSCAPE) {
            setHeights();
        }

        else if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.TABLET_LANDSCAPE && ($tableCol.closest('.cover-level-table-wrap').length)) {
            setHeights();

        }
    }
     //BAU-CD-1766
    window.aa.helpers.cache.cachedElements.$window.on({

        resize: function () {
            if ($(".cover-level-table").length) {
                $('.cover-level-table-wrap').each(covetableHeight);//summary boxes height
            }
        },
        load: function () {
            if ($(".cover-level-table").length) {
                $('.cover-level-table-wrap').each(covetableHeight);//summary boxes height
            }
        }
    });

    $('.tab-content:first').show();
    $('.product-type-tabs a').click(function (event) {
       
        event.preventDefault();
        $('.tab-content').hide();
        $(this).addClass('active');
        $(this).parent().siblings().find('a').removeClass('active');
        $('#' + $(this).attr('title')).show();

        if ($(".cover-level-table").length) {
            $('.cover-level-table-wrap').each(covetableHeight);//summary boxes height
        }
       

    });

    //CD-13970

	$(".flex-product-block").each(function () {
		if ($(this).find(".product-image").length) {
			//$(".flex-product-block").find(".product-image").hide();
			$(this).find('.product-brief').addClass('five-col-width');
		}
	});

    if ($(".flex-product-block").length) {
        if ($(".flex-product-block > .product-brief").find(".prod-cta-links:empty")) {
            $(".prod-cta-links").remove();
        }
    }


})(jQ);
</script><script>
/* 
 * ---------------------------------------- *
 * Name: 	Contact Us JavaScripts          *
 * Type: 	JavaScript                      *
 * Version: Not Versioned                   *
 * Author:	Mihai Boceanu | Codehouse       *
 * ---------------------------------------- *
 */

(function ($) {

    var subSectionHeight,
        resizeTimer,
        timer;

    // get active panel height
    function panelsHeight($optionsList, $selector) {

        subSectionHeight = $selector.height() + 10;

        $optionsList.css({ minHeight: subSectionHeight });
    }

    // set contact us options list height based on active panel height
    function contactUsPanelsHeight() {

        var $module = $(this),
            $optionsList = $module.find('.options-list'),
            $panels = $module.find('.panel.active'),
            $infoBlock = $module.find('.info-message-block'),
            $activeSubSection = $module.find('.sub-section.active');

        // show second level panels on larger screens
        if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
            $module.find('.sub-section').find('li').show();
            // hide info block on mobile
        } else {
            $infoBlock.hide();
        }

        // set container height based on highest active panel
        if ($activeSubSection.length && !$panels.hasClass('active')) {
            panelsHeight($optionsList, $activeSubSection);
            $infoBlock.hide();

        } else if ($activeSubSection.length && $panels.hasClass('active')) {

            if ($panels.height() > $activeSubSection.height() && window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                panelsHeight($optionsList, $panels);

            } else if ($panels.height() < $activeSubSection.height() && window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                panelsHeight($optionsList, $activeSubSection);

            }
        }
    }

    function setMinHeight() {

        var $module = $(this);

        $module.find('.inner-content').css({ minHeight: $module.find('.info-message-block .help-text').height() + 50 });
    }

    // init contact us events
    function contactUsEvents() {

        var $module = $(this),
            $optionsList = $module.find('.options-list'),
            $option = $module.find('.option'),
            $subOption = $module.find('.sub-option'),
            $subSections = $module.find('.sub-section'),
            $panels = $module.find('.panel'),
            $infoBlock = $module.find('.info-message-block'),
            $mobileSecondLevelHeader = $module.find('.second-level-title .mobile-list-label'),
            $mobileThirdLevelHeader = $module.find('.third-level-title .mobile-list-label'),
            $selectedPanel;

        function setColumnTitle() {

            var $columnTitle = $(this),
                columnTitlePlaceholderId = $columnTitle.data('placeholder'),
                columnTitleHtml = $columnTitle.html();

            if (columnTitleHtml) {
                $('.' + columnTitlePlaceholderId).html(columnTitleHtml);
            }
        }

        // set text for middle and right column title
        $('.third-level-right-title,.second-level-middle-title').each(setColumnTitle);

        // set module minimum height 
        $('.contact-us').each(setMinHeight);

        // focus on contact us component as soon as page loads
        $module.focus();

        // level one panels event handler
        $option.on('click', function () {

            var $target = $(this),
                $subSection = $target.closest('.content-section').find('.sub-section'),
                $subSectionButton = $subSections.find('button'),
                $primarySectionButton = $target.closest('.content-section').siblings().find('.option');

            $subSections.find('li').show();

            if ($subSection.hasClass('active')) {

                if (client.IE9 && window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $subSections.css({ left: '28%' }).stop().animate({ left: '0' }, 350);
                }

                // accessibility
                $subSectionButton.prop('tabindex', '-1');
                $primarySectionButton.removeAttr('tabindex');

                $subSections.add($option).add($panels).add($subOption).removeClass('active');
                $optionsList.removeClass('sliding open sub-level-open').css({ minHeight: 0 });
                $infoBlock.show();
                // set module minimum height 
                $('.contact-us').each(setMinHeight);

            } else {

                if (client.IE9 && window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $subSection.css({ left: 0 }).stop().animate({ left: '28%' }, 350);
                }

                $subSections.add($option).add($panels).add($subOption).removeClass('active');
                $subSection.add($target).addClass('active');

                $subSectionButton.removeAttr('tabindex');
                $primarySectionButton.prop('tabindex', '-1');

                subSectionHeight = $subSection.height();
                // store selected option
                $selectedPanel = $target;

                $optionsList.addClass('sliding open').css({ minHeight: subSectionHeight });
                $infoBlock.hide();

                clearTimeout(timer);

                timer = setTimeout(function () {
                    $optionsList.removeClass('sliding');
                }, 380);
            }
        });

        //level two panels event handler
        $subOption.on('click', function () {

            var $trigger = $(this),
                $targetPanel = $module.find('#' + $trigger.data('panel-id')),
                $activeSubSection = $module.find('.sub-section.active'),
                $subOptionSiblings = $trigger.closest('li').siblings().find('.sub-option'),
                panelSectionHeight = $activeSubSection.height();

            if ($targetPanel.hasClass('active')) {

                if (client.IE9 > window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $panels.css({ left: '100%' }).stop().animate({ left: 0 }, 350);
                }

                // set tabindexes
                $subOptionSiblings.removeAttr('tabindex');
                $targetPanel.prop('tabindex', '-1');

                $panels.add($subOption).removeClass('active');
                $module.removeClass('panel-open');
                $optionsList.removeClass('sliding-second-level sub-level-open').css({ minHeight: panelSectionHeight });

            } else {

                if (client.IE9 && window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $targetPanel.css({ left: 0 }).stop().animate({ left: '100%' }, 350);

                } else if (window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $subSections.find('li').hide();
                    $targetPanel.parent().show();

                } else if (window.aa.helpers.cache.cachedElements.$window.width() > window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $subSections.find('li').show();
                }

                // set tabindexes
                $panels.add($subOption).removeClass('active');
                $subOptionSiblings.prop('tabindex', '-1');

                $targetPanel.removeAttr('tabindex').add($trigger).addClass('active');
                $module.addClass('panel-open');
                $optionsList.addClass('sliding-second-level sub-level-open');

                panelSectionHeight = $targetPanel.height() + 10;
                subSectionHeight = $activeSubSection.height();

                if (panelSectionHeight > subSectionHeight || window.aa.helpers.cache.cachedElements.$window.width() <= window.aa.helpers.cache.constants.MOBILE_BREAKPOINT) {
                    $optionsList.css({ minHeight: panelSectionHeight });
                }

                else {
                    $optionsList.css('min-height', subSectionHeight);
                }

                clearTimeout(timer);

                timer = setTimeout(function () {
                    $optionsList.removeClass('sliding-second-level');
                }, 380);
            }

        });

        // return to first level selection panel
        $mobileSecondLevelHeader.on('click', function () {

            $subSections.add($option).add($panels).add($subOption).removeClass('active');
            $optionsList.removeClass('open sub-level-open').css({ minHeight: 0 });
        });

        // return to second level selection panel
        $mobileThirdLevelHeader.on('click', function () {
            $subSections.add($option).add($panels).add($subOption).removeClass('active');
            $optionsList.removeClass('open sub-level-open');
            $selectedPanel.trigger('click');
        });
    }

    function phoneCardOpeningHours() {

        var $thisCard = $(this),
            $currentStatus = $thisCard.find('.hours'),
            $openingTime = $thisCard.find('.time'),
            currentStatus = $currentStatus.data('current-status');

        // show/hide opening times if current time exceeded the time frame 
        if (currentStatus === 'Closed now' || currentStatus === 'Closed' || currentStatus === 'Closed today') {
            $openingTime.addClass('closed');

        } else {
            $openingTime.addClass('open');
        }

        $thisCard.find('.hours').on('click', function () {

            var $activePanel = $thisCard.closest('.panel.active'),
                $optionsList = $thisCard.closest('.options-list');

            $(this).fadeOut();
            $thisCard.find('.opening-hours').slideDown(function () {

                var panelSectionHeight = $activePanel.height();

                $optionsList.css({ minHeight: panelSectionHeight });
            });
        });
    }

// PP Jquery upgrade
//    window.aa.helpers.cache.cachedElements.$document.on({
//        ready: function () {
      window.aa.helpers.cache.cachedElements.$document.ready(
          function() {

            $('.contact-us').each(contactUsEvents);

            $('.phone-card').each(phoneCardOpeningHours);
//        }
    });
    window.aa.helpers.cache.cachedElements.$window.on({
        resize: function () {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function () {

                $('.contact-us').each(contactUsPanelsHeight);
                $('.contact-us').each(setMinHeight);

            }, 100); // call on resize end
        }
    });

})(jQ);
</script>
<!-- inline <script src="/Assets/scripts/header.js                                       "></script> -->
<!-- MOVED to hospitality-js <script src="/Assets/scripts/libs/jquery.mCustomScrollbar.concat.min.js      "></script> -->
<!-- inline <script src="/Assets/scripts/hospitality.js                                  "></script> -->
<!-- MOVED to image-gallery-js <script src="/Assets/scripts/hospitality-listing.js"></script> -->
<!-- inline <script src="/Assets/scripts/image-gallery.js                                "></script> -->
<!-- MOVED <script src=" /Assets/scripts/AutoNumeric.js                                 "></script>-->
<!-- inline <script src="/Assets/scripts/script.js                                       "></script>-->
<!-- inline <script src="/Assets/scripts/contact-us.js                                   "></script>-->
<script src="/Assets/scripts/eligibility-popup.js                            "></script>
<script src="/Assets/scripts/member-benefits-offers.js                       "></script>
<script src="/Assets/scripts/libs/owl.carousel.js                            "></script>
<script src="/Assets/scripts/digital-breakdown.js                            "></script>
<script src="/Assets/scripts/contenthub.js                                   "></script>





<!-- END of BUNDLE -->

<script>
document.addEventListener("DOMContentLoaded", () => {
try{
Array.from(document.getElementsByTagName('a')) .filter( (item) => item.href.includes('/breakdown-cover/uk') && !item.href.includes('/breakdown-cover/uk-hmc') ) .forEach((item) => { const newUrl = item.href.replace( '/breakdown-cover/uk', '/breakdown-cover/sales/cover' ); item.setAttribute('href', newUrl); });;
}catch(e){}
});
</script>



    <script>
        var loadDeferredStyles = function () {
            var addStylesNode = document.getElementById("deferred-styles");
            if (addStylesNode != null) {
                var replacement = document.createElement("div");
                replacement.innerHTML = addStylesNode.textContent;
                document.body.appendChild(replacement)
                addStylesNode.parentElement.removeChild(addStylesNode);
            }
        };
        var raf = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
            window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
        if (raf) raf(function () { window.setTimeout(loadDeferredStyles, 0); });
        else window.addEventListener('load', loadDeferredStyles);
    </script>
</body>
</html>
