<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<style>
body{ background:#fff; font-family: microsoft yahei; color:#969696; font-size:14px;}
.online-desc-con { text-align:center; }
.r-tip01 { color: #333; font-size: 18px; display: block; text-align: center; width: 600px; padding: 0 10px; overflow: hidden; text-overflow: ellipsis; margin: 0 auto 15px; }
.r-tip02 { color: #585858; font-size: 14px; display: block; margin-top: 20px; margin-bottom: 20px; }
#notice-jiasule {
  word-wrap: break-word;
  word-break: normal;
  color:#585858;
  border:1px solid #ddd;
  padding:0px 20px 0px 20px
}
img { border: 0; }
.u-ico{ vertical-align: middle; margin-right: 12px;}
.btn{ padding: 8px 22px; border-radius: 3px; border: 0; display: inline-block;vertical-align: middle;text-decoration: none;}
.btn-g{ background-color: #61b25e; color: #fff;}
.report {color: #858585; text-decoration: none;}
.report:hover {text-decoration: underline; color: #0088CC;}
hr{ border-top: 1px dashed #ddd;}
center{ line-height: 48px; color: #919191;}
.b-box {background: #0B6FD6;margin: -8px -8px 0 -8px;height: 32px;}
.b-body {position: relative;left:50%;max-width: 1200px;transform: translateX(-50%);padding-top: 5px;white-space:nowrap;}
.b-ico-box {display: inline-block;margin-right: 4px;}
.b-ico {height: 18px;width: 18px;}
.b-msg-box {display: inline-block;font-size: 14px;color: #fff;width: 96%;white-space:nowrap;overflow:hidden;}
.b-msg {display: inline-block;font-size: 14px;color: #fff;padding-right: 20px;}
#second {font-style: normal;}
.dn {display: none;}
</style>
</head>
<body>
<div class="b-box"><div class="b-body"><div class="b-ico-box"><img class="b-ico" src="/cdn-cgi/image/alt.svg" alt=""></div><div id="msg-box" class="b-msg-box"><a id="flink" class="b-msg" href="#"></a><a id="slink" class="b-msg" href="#"></a></div></div></div>
<div class="online-desc-con" style="width:640px;padding-top:15px;margin:34px auto;" >
    <img id="wafblock" alt="" style="margin: 0 auto 17px auto;" />
    <div id="content_rendered">
        <span class="r-tip01" id="error_403"></span>
        <span class="r-tip01" id="error_403_en"></span>
        <div id='notice-jiasule'>
            <p>当前网址：<span id="url"></span></p>
            <p>客户端特征：<span id="user_agent"></span></p>
            <p>拦截时间：<span id="now"></span>&nbsp;&nbsp;本次事件ID&nbsp;<span id="rule_id"></span></p>
        </div>
        <span class='r-tip02'>
            <img class='u-ico' alt='' src='/cdn-cgi/image/guest.png' />如果您是网站管理员，请登录知道创宇云防御&nbsp;
            <a class='btn btn-g' id='detail-link' href='#' target='_blank'>查看详情</a>
            &nbsp;或者&nbsp;
            <a class='report' id='report-link' href='#' target='_blank'>反馈误报</a>
        </span>
        <!-- <span class='r-tip02 dn' id="second-box"><em id="second"></em>秒后进入帮助页面</span> -->
    </div>
    <hr />
    <center>client: <span id="client_ip"></span>, server: 79b6841, time: <span id="time_error"></span></center>
</div>
<script>
    void(function fuckie6(){if(location.hash && /MSIE 6/.test(navigator.userAgent) && !/jsl_sec/.test(location.href)){location.href = location.href.split('#')[0] + '&jsl_sec' + location.hash}})();
    var data = {"rule_id":"80001","t_msg":"全球领先的IT市场研究和咨询公司IDC发布最新研究报告《中国云Web应用防火墙市场份额，2022：云上云下协同发展，云原生WAF成为必然》知道创宇【创宇盾】产品凭借过硬的技术实力及成熟的市场表现，在中国整体云WAF市场及公有云WAF市场中，均居专业安全厂商第一！","error_403_type":"","error_403_en":"Knownsec CloudWAF: Your request has been blocked due to suspected hacking","t_link":"https:\/\/mp.weixin.qq.com\/s\/o0ZGlxEQ1786abnXygyTqQ","error_403":"","client_ip":"64.222.201.246","time_error":"20\/Nov\/2023:09:27:07 +0800"};
    var from = encodeURIComponent(document.referrer.substr(0, 1024));
    var rule_id = parseInt(data['rule_id']) || '';
    var client_ip = data['client_ip'];
    var ref = encodeURIComponent(document.URL.substr(0, 1024));
    document.getElementById("wafblock").src = '/cdn-cgi/image/' + (data['error_403_type'] || 'hacker') + '.png';
    document.getElementById('error_403').innerText = data['error_403'] || '创宇盾提示您：当前访问疑似黑客攻击，已被网站管理员设置为拦截';
    document.getElementById('error_403_en').innerText = data['error_403_en'];
    document.getElementById('url').innerText = document.URL.replace(/\</g,"%3C").replace(/\>/g,"%3E");
    document.getElementById('user_agent').innerText = navigator.userAgent;
    document.getElementById('now').innerText = new Date(new Date() - -8 * 3600000).toISOString().substr(0, 19).replace('T', ' ');
    document.getElementById('rule_id').innerText = rule_id;
    document.getElementById('client_ip').innerText = client_ip;
    document.getElementById('time_error').innerText = data['time_error'];
    document.getElementById('detail-link').href = 'http://help.yunaq.com/feedback.html?from=' + from + '&rule_id=' + rule_id + '&client_ip=' + client_ip + '&referrer=' + ref + '#pus';
    document.getElementById('report-link').href = 'http://help.yunaq.com/feedback.html?from=' + from + '&rule_id=' + rule_id + '&client_ip=' + client_ip + '&referrer=' + ref + '#hus';
    // if (data['error_403_type'] === 'pac' || data['error_403_type'] === 'frequency_high') {
    //     var sbox = document.getElementById('second-box');
    //     sbox.classList.remove('dn');
    //     var second = 2;
    //     var ele = document.getElementById('second');
    //     ele.innerText = second;
    //     var link_url;
    //     if (data['error_403_type'] === 'pac') {
    //         link_url = "https://help.yunaq.com/pac.html";
    //     } else if (data['error_403_type'] === 'frequency_high') {
    //         link_url = "https://help.yunaq.com/limit_rate.html";
    //     }
    //     var eid = setInterval(function() {
    //         second--;
    //         ele.innerText = second;
    //         if (second == 0) {
    //             clearInterval(eid);
    //             sbox.outerHTML = "";
    //             window.location.href = link_url;
    //         }
    //     }, 1000);
    //     document.getElementById('detail-link').addEventListener("click", function() {
    //         clearInterval(eid);
    //         sbox.outerHTML = "";
    //     });
    //     document.getElementById('report-link').addEventListener("click", function() {
    //         clearInterval(eid);
    //         sbox.outerHTML = "";
    //     });
    // }
    function getOffsetLimit(msgW, boxW, pad) {var limit = init = 0;if (msgW+pad>boxW){limit = msgW+pad;if (msgW + pad - boxW > 20){init = pad}}else{limit = (msgW+pad)*2;init = -boxW}return {limit: limit, init: init}};
    var fst = document.getElementById('flink');
    var last = document.getElementById('slink');
    fst.innerText = last.innerText = data['t_msg'];
    fst.href = last.href = data['t_link'];
    var msgW = fst.getBoundingClientRect().width;
    var msgBox = document.getElementById('msg-box');
    var boxW = msgBox.getBoundingClientRect().width;
    var run = getOffsetLimit(msgW, boxW, 20);
    var ofst = 0;
    function runner() {ofst = ofst >= run.limit ? run.init : (ofst + 2);fst.style.transform = 'translateX('+(-ofst)+'px)';last.style.transform = 'translateX('+(-ofst)+'px)';};
    setInterval(runner, 100);
</script>
</body>
</html>

